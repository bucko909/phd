\documentclass[a4paper,11pt,oneside]{book}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{color}
\usepackage{epsfig}

\newtheorem{defn}{Definition}[section]
\newtheorem{lemma}[defn]{Lemma}
\newtheorem{proposition}[defn]{Proposition}
\newtheorem{theorem}[defn]{Theorem}
\newtheorem{example}[defn]{Example}
\newtheorem{notation}[defn]{Notation}
\newtheorem{definition}[defn]{Definition}
\newtheorem{algorithm}[defn]{Algorithm}
\newtheorem{remark}[defn]{Remark}
\newtheorem{corollary}[defn]{Corollary}

\newcommand{\slex}{\pi}
\newcommand{\path}[2]{\vec{#1#2}}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\ceiling}[1]{\left\lceil #1 \right\rceil}
\newcommand{\ceil}[1]{\left\lceil #1 \right\rceil}
\newcommand{\myside}[2]{[#1#2]}
\newcommand{\mytriangle}[3]{#1\hat{#2}#3}

\newcommand{\lcm}{\mathrm{lcm}}

\setlength{\unitlength}{20mm}
\newcommand{\geoword}[6]{
	\put(#1,#2){\vector(#3,#4){#5}}
	\put(#1,#2){\line(#3,#4){#6}}
}

\begin{document}

\title{Some Results on Hyperbolic Groups}

\author{David Buckley}

\maketitle

\chapter{Introduction}

Gromov's word-hyperbolic groups are particular class of finitely generated groups inside which many problems can be solved computationally. They are characterised by properties of their Cayley graphs with respect to their generating set.

\section{Preliminaries}

The definitions, notation and results given in this section will be used throughout the whole thesis.

\subsection{Hyperbolicity}

There are a number of equivalent definitions of word-hyperbolicity. The definition we will be using is that of having thin triangles in the Cayley graph. Let us first describe some simple notation.

There are a few important concepts to be applied to paths in metric spaces.

\begin{definition}
Let $\alpha : [0, l] \to \Gamma$ be some path in a metric space. We say $\alpha$ is a \textbf{geodesic} if $l = d(\alpha(0), \alpha(l))$.

A metric space is \textbf{geodesic} if there exists a geodesic between any two points in the space.

We say $\alpha$ is a \textbf{$(\lambda, \epsilon)$-quasigeodesic} if $l \le \lambda d(\alpha(0), \alpha(l)) + \epsilon$.

Finally, $\alpha$ is an \textbf{$L$-local geodesic} (or \textbf{$L$-local $(\lambda, \epsilon)$-quasigeodesic}) if every subpath of $\alpha$ of length less than or equal to $L$ is a geodesic (resp. $(\lambda, \epsilon)$-quasigeodesic).

If $\alpha : D \to \Gamma$ where $D$ is either $\mathbb{R}$ or $\mathbb{R_{\ge0}}$ is an infinite path, it is said to have any of the above properties if all finite subpaths have them. For instance, an infinite geodesic is an infinite path with all finite subpaths being geodesics.
\end{definition}

Suppose $\Gamma$ is some geodesic metric space. Given points $x, y, z \in \Gamma$ we pick geodesics connecting each point and refer to them as $\myside{x}{y}$, $\myside{y}{z}$ and $\myside{x}{z}$. We refer to the geodesic triangle connecting the points as $\mytriangle{x}{y}{z}$. It is of course possible for there to be several geodesics connecting some of the given points, but we will always pick only one in order to avoid ambiguity. Once they have been picked, we can for any $p \in \myside{x}{y}$ unambiguously use $\myside{x}{p}$ to refer to the segment of $\myside{x}{y}$ which connects $x$ to $p$.

\begin{definition}
Suppose we are given the triangle $\mytriangle{x}{y}{z}$ in some geodesic metric space $\Gamma$. We define the \textbf{meeting points} $c_x$, $c_y$ and $c_z$ on $\myside{y}{z}$, $\myside{x}{z}$ and $\myside{x}{y}$ respectively so that $d(x, c_z) = d(x, c_y) = \frac{d(x, y) + d(x, z) - d(y, z)}{2}$ and similar for the other two.

Suppose $p$ is on $\myside{x}{c_z}$ (by relabelling, we see this can be any point on the triangle). There exists a \textbf{corresponding point} $q$ on $\myside{x}{c_y}$ such that $d(x, p) = d(x, q)$, and by identifying each of these points we form a metric tripod (ie. a point with three geodesics extending from it). We say $\mytriangle{x}{y}{z}$ is \textbf{$\delta$-thin} if $d(p, q) \le \delta$ for all such corresponding points $p$ and $q$.

We say a group $G$ with presentation $<\!\!X|R\!\!>$ is \textbf{$\delta$-hyperbolic} if all triangles in its Cayley graph are $\delta$-thin.
\end{definition}

In a construction involving many triangles sharing common sides, we will use the phrase $x$ $n$-corresponds to $y$ if there is a sequence $x = z_0, z_1, z_2, \ldots z_n = y$ of points such that $z_i$ corresponds (via a previously constructed triangle) to $z_{i+1}$ for all $i$. More generally, we will say that points chain-correspond if there exists an $n \in \mathbb{N}$ such that they $n$-correspond.

Vertices in the Cayley graph will be equated with elements of the group (and therefore with words representing paths to them), so for example $p = qw$ denotes the endpoint of the path labelled $w$, starting at the vertex $p$. On the other hand, if it is properly understood, the path $w$ may be written $\myside{p}{q}$.

Suppose $G$ is a finitely generated group. We will use the notation $=_G$ to represent equality of elements of $G$, and simply $=$ to represent equality of words. When we wish to represent equality of words allowing cancellation (ie. under the free group), we will write $=_F$. Supposing $w$ is some word, we will write $|w|$ for the length of $w$, and if $w$ is a word in the generators of $G$, we write $|w|_G = d(1, w)$ for the length of a minimal length representative of $w$.

Later on, we will often use the concept of a midpoint of a geodesic path. We define this now.

\begin{definition}
Suppose $x$ and $y$ are vertices in some graph $\Gamma$, and $\myside{x}{y}$ is some geodesic connecting them. Let $p$ be some vertex on $\myside{x}{y}$ such that $|d(p, x) - d(p, y)| \le 1$. Then we say $p$ is a \textbf{midpoint} of $\myside{x}{y}$.
\end{definition}

Note that if the distance between two vertices is even, there will be one midpoint; if it is odd there will be two.

\begin{definition}
Suppose $A$ is an inverse-closed alphaber and $w$ is some word $A$, so $w = a_1 a_2 \ldots a_k$ with each $a_i$ in $A$. We let $w(i) := a_1 a_2 \ldots a_i$ for $0 \le i \le |w|$, and extend this definition so that if $i \in \mathbb{N}$ and $n = \floor{i}{|w|}$ then $w^\infty(i) = w^{n}w(i - n|w|)$, and if $-i \in \mathbb{N}$, $w(i) = (w^{-1})^\infty(-i)$.

If $A$ is the generating set of some group, we can regard $w^\infty$ as a two-way infinite path passing through the identity by extending the map $\mathbb{Z} \to \Gamma : z \mapsto w^\infty(z)$ to map from $\mathbb{R}$.

If $f = \floor{\frac{|w|}{2}}$ and $c = \ceil{\frac{|w|}{2}}$, we define $w_L := w(f)$ and $w_R := (w^{-1}(c))^{-1}$, then let $w_C := w^{w_L} =_F w_Rw_L$.
\end{definition}

Note that if $w$ labels a geodesic path in $\Gamma$ then $w_L$ labels a path to a midpoint and $w = w_Lw_R$ always. As an example, let $w = abcde$. Then $w^\infty(11) = abcdeabcdea$, $w^\infty(-3) = w^{-1}(3) = e^{-1}d^{-1}c^{-1}$, $w_L = w(2) = ab$, $w_R = (w^{-1})(3))^{-1} = cde$ and $w_C = cdeab$.

We can now define short-lex straight.

\begin{defn}
Given a group $G$ with ordered inverse-closed generating set A, word $w$ is \textbf{short-lex straight} if, for all $i \in \mathbb{N}$, $w^{\infty(i)}$ is its own short-lex least representative.
\end{defn}

Supposing $g, h \in G$, we will denote conjugation of $g$ by $h$ using superscripts, so that $g^h = h^{-1}gh$.

\chapter{Hyperbolic Groups are $13$-hyperbolic}

It has long been known that the constant of hyperbolicity of a group is dependent on its generating set. Of course, for a given group, there will be a generating set which minimises this constant (for example, a free group is $0$-hyperbolic with respect to any generating set which comprises a free basis). The purpose of this chapter is to demonstrate that there is an upper bound for this minimal value. By doing so, it is clear that any classification of hyperbolic groups by this minimum value of $\delta$ is unlikely to be very interesting.

The bounds given here are likely not to be the smallest due to the naive way in which they are derived, however it is the existence of such a bound that is interesting.

\section{Preliminaries}

We begin by generalising the concept of thinness of a geodesic triangle to a general not necessaily geodesic triangle. Clearly there is no upper bound on the thinness constant for such general triangles in an infinite graph (one can pick two points arbitrarily far away and force them to correspond), but we aim to show it for a particular class of quasigeodesics.

\begin{definition}
Suppose $A$, $B$ and $C$ are points in a space $X$, and that $\gamma_{AB} : [0, l_{AB}] \to X$ is some path from $A$ to $B$, with $\gamma_{BC}$ and $\gamma_{AC}$ defined similarly. Then we say that $\gamma_{AB}$, $\gamma_{BC}$ and $\gamma_{AC}$ are the sides of a \textbf{triangle} $\gamma$ in $X$. If $x$ and $y$ are two points on the same side $\gamma_{AB}$, then define $d_\gamma(x, y) = \inf\{|i - j| : i \in \gamma_{AB}^{-1}(x), j \in \gamma_{AB}^{-1}(y)\}$, the distance between the points travelling along the path $\gamma_{AB}$.

Now define the \textbf{meeting point} $M_{AB} \in \gamma_{AB}$ so that $d_\gamma(A, M_{AB}) = \frac{l_{AB} + l_{AC} - l_{BC}}{2} = d_A$, and define $M_{BC}$ and $M_{AC}$ similarly. For any $x \in \gamma_{AB}$ such that $d_\gamma(A, x) \le d_A$ we say $x$ \textbf{corresponds} to the point $y \in \gamma_{AC}$ such that $d_\gamma(A, y) = d_\gamma(A, x)$ (again, extend this to the rest of the triangle in the obvious way). We say that $\gamma$ is $\delta$-thin if, for any two corresponding points $x$ and $y$, we have $d(x, y) \le \delta$.
\end{definition}

This definition corresponds to the traditional definition of thinness in geodesic triangles when all sides are geodesic paths. We will additionally use the phrase ``vertex thinness constant'' to refer to maximum distance between corresponding \textbf{vertices} of a geodesic triangle whose corners are vertices in a Cayley graph. This constant is of much more interest with respect to the group than the metric space thinness constant.

\section{Thinness of Quasigeodesic Triangles}

We first show that if we are working in a geodesic metric space in which all geodesic triangles are $\delta$-thin and we are given a triangle whose sides are all $(1, k)$-quasigeodesics, then the triangle is $\Delta$-thin for some $\Delta$ depending only on $k$ and $\delta$.

It is well known that in hyperbolic spaces, quasigeodesics lie close to geodesics; let us briefly investigate the case of $(1, k)$-quasigeodesics in particular.

\begin{lemma}
\label{lemma:qgeo}
Suppose $\Gamma$ is a graph with vertex thinness constant $\delta$. Suppose $\gamma$ is a $(1,k)$-quasigeodesic in $\Gamma$ joining the vertices $x$ and $y$, and that $\alpha$ is a geodesic joining $x$ and $y$.

Then for every vertex $p$ on $\gamma$, there exists a vertex $q$ on $\alpha$ such that $d(p, q) \le \frac{k+1}{2} + \delta$ and $d(x, q) \le d_\gamma(x, p) \le d(x, q) + \frac{3k+1}{2}$.
\end{lemma}

\begin{figure}
\begin{center}
\input 1k_close_geo.pstex_t
\caption{$(1,k)$-quasigeodesics lie close to geodesics}
\label{figure:1,k_close}
\end{center}
\end{figure}

\begin{proof}
We can construct a geodesic triangle with sides $\alpha$ and any two geodesics joining $x$ to $p$ and $p$ to $y$, as in Figure \ref{figure:1,k_close}. The meeting point $c$ must be of distance at most $\frac{k}{2}$ from $p$, since:

\begin{eqnarray*}
d(p, c) &  =  & \frac{d(p, x) + d(p, y) - d(x, y)}{2} \\
        & \le & \frac{d_\gamma(p, x) + d_\gamma(p, y) - d(x, y)}{2} \\
        &  =  & \frac{d_\gamma(x, y) - d(x,y)}{2} \\
        & \le & \frac{k}{2}
\end{eqnarray*}

If $c$ lies on a vertex, let $q = c$, and if $c$ lies on an edge, let $q$ be the vertex on this edge that is closest to $x$. Then $d(p, q) \le \frac{k}{2} + \frac{1}{2} + \delta$,  and $d(x, q) \le d(x, p) \le d_\gamma(x,p) \le d(x, p) + k \le d(x, q) + \frac{3k+1}{2}$ as required.
\end{proof}

When the paths $\gamma$ and $\alpha$ are understood, we will refer to $q$ in Lemma \ref{lemma:qgeo} as the \textbf{partner} of $p$.

\begin{lemma}
\label{lemma:qtri}
Suppose $\Gamma$ is a Cayley graph with vertex thinness constant $\delta$. Let $k$ be a positive integer, let $X$, $Y$ and $Z$ be vertices in $\Gamma$ and let $\gamma_{XY}$, $\gamma_{YZ}$ and $\gamma_{XZ}$ be $(1, k)$-quasigeodesics joining $X$ to $Y$, $Y$ to $Z$ and $X$ to $Z$ respectively to form a triangle $\gamma$.

Then corresponding vertices on $\gamma$ are at most $3k+3\delta + 1$ apart.
\end{lemma}

\begin{figure}
\begin{center}
\input 1k_tri2.pstex_t
\caption{$(1,k)$-quasigeodesic triangles are thin}
\label{figure:1k_tri}
\end{center}
\end{figure}

\begin{proof}
Suppose that $\alpha_{XY}$, $\alpha_{YZ}$ and $\alpha_{XZ}$ are geodesics connecting $X$, $Y$ and $Z$ forming a geodesic triangle $\alpha$. Let $M_{XY}$, $M_{YZ}$ and $M_{XZ}$ be the meeting points on $\gamma$ and let $M_{XY}'$, $M_{YZ}'$ and $M_{XZ}'$ be the meeting points on $\alpha$. See Figure \ref{figure:1k_tri}.

Let $p$ and $q$ be corresponding vertices on $\gamma_{XY}$ and $\gamma_{XZ}$ respectively. Let $p'$ and $q'$ be their respective partners, as in Lemma \ref{lemma:qgeo}.

Suppose $d(X, p') \le d(X, M_{XY}')$, and let $p''$ be the point on $\alpha_{XZ}$ corresponding to $p'$. By Lemma \ref{lemma:qgeo}, $d(p, p')$ and $d(q, q')$ are less than or equal to $\delta + \frac{k+1}{2}$, and $d(p, p'') \le \delta$ by the hypothesis. Using the second part of Lemma \ref{lemma:qgeo} it is clear also that $d(q', p'') \le \frac{3k+1}{2}$. Therefore by simple application of the triangle inequality, we have

\begin{eqnarray*}
d(p, q) & \le & d(p, p') + d(p', p'') + d(p'', q') + d(q', q) \\
        & \le & (\frac{k+1}{2} + \delta) + \delta + \frac{3k+1}{2} + (\frac{k+1}{2} + \delta) \\
        &  =  & \frac{5k+3}{2} + 3\delta \le 3k + 3\delta + 1
\end{eqnarray*}

It remains to consider the case where both $d(X, p')$ and $d(X, q')$ are larger than $d(X, M_{XZ}')$. Note that $d_\gamma(X, p) = d_\gamma(X, q) \le d_\gamma(X, M_{XZ})$. Then

\begin{eqnarray*}
d(X, M_{XY}') &  <  & d(X, p') \le d_\gamma(X, p) \\
              & \le & d_\gamma(X, M_{XY}) \\
              &  =  & \frac{d_\gamma(X, Y) + d_\gamma(X, Z) - d_\gamma(Y, Z)}{2} \\
              & \le & \frac{d(X, Y) + d(X, Z) + 2k - d(Y, Z)}{2} \\
              &  =  & d(X, M_{XY}') + k
\end{eqnarray*}

so $d(p', M_{XY}') \le k$, and $d(p, M_{XY}') \le d(p, p') + d(p', M_{XY}') \le \frac{k+1}{2} + \delta + k = \frac{3k+1}{2} + \delta$. A symmetrical argument shows that $d(q, M_{XZ}') \le \frac{3k+1}{2} + \delta$ also, so we have

\begin{eqnarray*}
d(p, q) & \le & d(p, c_X) + d(c_X, c_Y) + d(c_Y, q) \\
        & \le & (\frac{3k+1}{2} + \delta) + \delta + (\frac{3k+1}{2} + \delta) \\
        &  =  & 3k + 3\delta + 1
\end{eqnarray*}

All corresponding vertices on $\gamma$ are now within $3k + 3\delta + 1$ of each other as required.
\end{proof}

\section{The Effect of Corners not on Vertices}

We will now investigate the result of allowing corners of a geodesic triangle to reside on an edge rather than a vertex.

\begin{lemma}
\label{lemma:corner_loop}
Suppose that $X$, $Y$ and $Z$ are points in Cayley graph with vertex thinness constant $\delta$, and that $\alpha_{XY}$, $\alpha_{YZ}$ and $\alpha_{XZ}$ are geodesics connecting $X$ to $Y$, $Y$ to $Z$ and $X$ to $Z$ respectively to form a geodesic triangle $\alpha$. Suppose further that there is a path $\gamma$ along the sides of $\alpha$ which forms a loop at some point $V$ and contains only one corner.

If $X$ lies on $\gamma$, let $\b{X} = V$, else let $\b{X} = X$. Define $\b{Y}$ and $\b{Z}$ in the same way, and define a new geodesic triangle $\beta$ with corners $\b{X}$, $\b{Y}$ and $\b{Z}$ and pick the sides to be the subpaths of $\alpha_{XY}$, $\alpha_{YZ}$ and $\alpha_{XZ}$ which do not intersect $\gamma$.

If $\beta$ is $\delta_1$-thin, then $\alpha$ is $\max\{1, \delta+1, \delta_1\}$-thin.
\end{lemma}

\begin{figure}
\begin{center}
\input resolve_nonvertex.pstex_t
\caption{Moving non-vertex corners on loops onto vertices}
\label{figure:resolve_loop}
\end{center}
\end{figure}

\begin{proof}
Note before anything else that we may as well assume $V$ lies on a vertex, since if it doesn't, it must lie on an edge and at least one vertex on that edge will be on $\alpha$, and so a candidate for $V$.

Since the sides are geodesic, at least one corner must lie on $\gamma$. First suppose that this corner is $X$ and no other corner lies on $\gamma$.

Observe that $\beta$ is constructed by simply removing the paths from $X$ to $V$ (which must be the same length or the sides were not geodesic), as illustrated on the left in Figure \ref{figure:resolve_loop}. There can be no meeting points on $\alpha$ between $X$ and $V$, since if we suppose $m$ is a meeting point on a side connecting to $X$, we find

\begin{eqnarray*}
d(X, m) &  =  & \frac{d(X, Y) + d(X, Z) - d(Y, Z)}{2} \\
        &  =  & \frac{(d(X, V) + d(V, Y)) + (d(X, V) + d(V, Z)) - d(Y, Z)}{2} \\
		& \ge & d(X, V),
\end{eqnarray*} by using the triangle inequality on the side lengths. The meeting points on the sides of $\beta$ therefore coincide exactly with the meeting points on the sides of $\alpha$, hence corresponding points in $\alpha$ that do not lie on $\gamma$ also correspond in $\beta$ and so lie at most $\delta_1$ apart.

If $X$ lies on a vertex, let $X' = X'' = X$, else let $X'$ and $X''$ be the vertices at the ends of the edge containing $X$ (in this case, since the sides of the triangle were geodesics, $X$ must lie exactly between the two). Now $\gamma$ can be viewed as a geodesic triangle with corners $V$, $X'$ and $X''$ and corresponding points on $\alpha$ either correspond in $\gamma$ (so are within $\delta+1$ of each other, since they may be up to $\frac{1}{2}$ from a vertex), or are within $1$ of $X$ and so at worst $1$ apart.
\end{proof}

Note that the case on the right of Figure \ref{figure:resolve_loop} (with any number of the triangle's corners lying on the path between $X'$ and $X''$) can be dealt with by the above lemma, since we can use the path going from $X'$ to $X''$ and back again as the required loop. 

\begin{lemma}
\label{lemma:corner_straight}
Suppose that $X$, $Y$ and $Y$ are points in a Cayley graph and that $\alpha_{XY}$, $\alpha_{YZ}$ and $\alpha_{XZ}$ are geodesics connecting $X$ to $Y$, $Y$ to $Z$ and $X$ to $Z$ respectively to form a geodesic triangle $\alpha$. Suppose further that all points along the sides of $\alpha$ are visited exactly once. If the vertex thinness constant of the space is $\delta$ then $\alpha$ is $2\delta+5$-thin.
\end{lemma}

\begin{figure}
\begin{center}
\input resolve_straight.pstex_t
\caption{Moving non-vertex corners not on loops onto vertices}
\label{figure:resolve_straight}
\end{center}
\end{figure}

\begin{proof}
If $X$ is a vertex, let $X_Y = X_Z = X$; if it lies on an edge $e$ then let $X_Y$ be the vertex on $e$ which lies on $\alpha_{XY}$ and $X_Z$ be other vertex on $e$. Define $Y_X$ etc. in a similar way. Suppose (without loss of generality, for we can just swap the labels of $Y$ and $Z$) that $d(X, X_Y) + d(Y, Y_X) + d(Z, Z_X) \le \frac{3}{2}$.

We will consider corresponding points closer to $X$ than the meeting points. Let $\beta_{XY}$ be the subpath of $\alpha_{XY}$ which connects $X_Y$ and $Y_X$.

Label the case where $d(X_Y, Z_X) = d(X_Z, Z_X) + 1$ case 1, and let $\beta_{XZ}$ be the subpath of $\alpha_{XY}$ which connects $X_Y$ to $X$ followed by the subpath of $\alpha_{XZ}$ connecting $X$ to $Z_X$. Otherwise, we are in case 2, and $d(X_Y, Z_X) = d(X_Z, Z_X)$, and we let $\beta_{XZ}$ be any geodesic connecting $X_Y$ to $Z_X$. Let $\beta_{YZ}$ be any geodesic connecting $Y_X$ to $Z_X$, so we have formed a new geodesic triangle $\beta$ whose corners all lie on vertices, as in Figure \ref{figure:resolve_straight}. Since the vertex thinness constant is $\delta$, $\beta$ is clearly $\delta + 1$-thin.

Let $M_{XY}$ etc. be the meeting points on $\alpha$ and let $M_{XY}'$ etc. be the meeting points on $\beta$.

Now suppose that we are given points $a$ on $\alpha_{XZ}$ and $b$ on $\alpha_{XY}$ which correspond in $\alpha$. If we are in case 1 let $a' = a$, otherwise let $a'$ be the point on $\beta_{XZ}$ which corresponds to $a$.

There are now 3 cases. In case A, $a'$ occurs between $X_Y$ and $M_{XZ}'$, $a'$ corresponds in $\beta$ to a point $a''$ on $\beta_{XY}$. By observing lengths of sides, we can easily see that in case 1

\begin{eqnarray*}
d(X_Y, a'') & = & d(X_Y, a') \\
            & = & d(X, a') + d(X, X_Y) \\
			& = & d(X, b) + d(X, X_Y) \\
			& = & d(X_Y, b) + 2d(X, X_Y)
\end{eqnarray*}

so $d(a'', b) \le 2d(X, X_Y)$. In case 2

\begin{eqnarray*}
d(X_Y, a'') & = & d(X_Y, a') \\
            & = & d(X_Z, a) \\
			& = & d(X, a) - d(X, X_Z) \\
			& = & d(X, b) - d(X, X_Z) \\
			& = & d(X_Y, b) + d(X, X_Y) - d(X, X_Z)
\end{eqnarray*}

so $d(a'', b) = |d(X, X_Y) - d(X, X_Z)|$. Combining cases, we find $d(a, b) \le \max\{\delta + 3, 2\delta + 3\} = 2\delta + 3$. In case B, $b$ lies between $X_Y$ and $M_{XY}'$, and we can use a similar argument to get the same bound on $d(a, b)$.

Finally, in case C, both $a'$ and $b$ are further from $X_Y$ than their respective meeting points on $\beta$. Observe that by the triangle inequality, $d(X, Y) \le d(X, X_Y) + d(X_Y, Y_X) + d(Y_X, Y)$ etc., so

\begin{eqnarray*}
d(X_Y, M_{XY}) &  =  & d(X, M_{XY}) - d(X, X_Y) \\
               &  =  & \frac{d(X, Y) + d(X, Z) - d(Y, Z)}{2} - d(X, X_Y) \\
               & \le & \frac{d(X_Y, Y_X) + d(X, X_Y) + d(Y, Y_X)}{2} \\
			   &     & + \frac{d(X_Y, Z_X) + d(Z, Z_X) + d(X, X_Y)}{2} \\
			   &     & - \frac{d(Y_X, Z_X) - d(Y, Y_X) - d(Z, Z_X)}{2} - d(X, X_Y) \\
			   &  =  & \frac{d(X_Y, Y_X) + d(X_Y, Z_X) - d(Y_X, Z_X)}{2} + d(Y, Y_X) + d(Z, Z_X) \\
			   &  =  & d(X_Y, M_{XY}') + d(Y, Y_X) + d(Z, Z_X)
\end{eqnarray*}

% TODO What if too short?
If we are in case 1, it is now clear that $d(a, M_{XZ})$ and $d(b, M_{XY})$ are both less than $d(Y, Y_X) + d(Z, Z_X)$, so $d(a, b) \le \delta + 1 + 2d(Y, Y_X) + 2d(Z, Z_X) \le \delta + 4$ by the statement at the start of the proof. If we are in case 2, let $p$ be the point on $\beta_{XZ}$ which corresponds to $M_{XZ}$, and note that

\begin{eqnarray*}
d(X_Y, p) &  =  & d(X_Z, M_{XZ}) \\
          &  =  & d(X, M_{XZ}) - d(X, X_Z) \\
		  &  =  & d(X, M_{XY}) - d(X, X_Z) \\
		  & \le & d(X_Y, M_{XY}') + d(X, X_Y) - d(X, X_Z) + d(Y, Y_X) + d(Z, Z_X)
\end{eqnarray*}

Now $d(a', M_{XZ}') \le d(X, X_Y) - d(X, X_Z) + d(Y, Y_X) + d(Z, Z_X)$ and $d(b, M_{XY}') \le d(Y, Y_X) + d(Z, Z_X)$, so $d(a, b) \le 2\delta + 5$ as in case 1.
\end{proof}

Combining these two results, we find:

\begin{proposition}
\label{proposition:vertex_geodesic}
If the vertex thinness constant for a Cayley graph is $\delta$ then all geodesic triangles in the graph are $2\delta + 5$-thin.
\end{proposition}

\begin{proof}
Given a geodesic triangle $\alpha$, use the construction in Lemma \ref{lemma:corner_loop} to ensure produce a new triangle $\alpha'$ in which all points on the perimiter of the triangle are passed through only once (if a point is passed through twice, there is clearly a loop, and we can cut it off using the lemma). This triangle is $2\delta + 5$-thin by Lemma \ref{lemma:corner_straight}, so the $\alpha$ is, too.
\end{proof}

\section{A Change of Generating Set}

In this section, we will suppose we are given some presentation $G = <\!\!X|R\!\!>$, and that the Cayley graph $\Gamma$ of this presentation has vertex thinness constant $\delta$. Pick some $k \in \mathbb{N}$, and let $Y = \{ g\in G : 1 \le |g|_X \le k \}$. Our aim will be to find a bound on the thinness of triangles in the Cayley graph $\Gamma'$ under the new generating set $Y$.

We will start by introducing a new generator $\$$ into $X$ so that $\$ =_G 1$. The introduction of this new generator can clearly never remove a path from the Cayley graph and it is clear that no existing path can be shortened by using $\$$, so all shortest paths between existing points remain shortest. The new Cayley graph will have some geodesic triangles not present in the old one (those whose corners lie on edges labelled by $\$$), but this will not affect the vertex thinness constant, since we require that corners lie on vertices. Note that since $\$$ is not a shortest representative of itself, the distance between two points in the old Cayley graph is preserved in the new Cayley graph.

Let $A = X \cup X^{-1}$. For each element $a \in Y$, pick any word $w \in A^*$  of length $k$ such that $w$ and $a$ represent the same element of $G$. The existance of such a word is guaranteed by the presence of the generator $\$$: if the shortest word does not have a length of $k$, pad it by adding $\$$ anywhere in the word until it does. Extend this to a map of words $f : Y^* \to A^*$ (ignoring any cancellation).

If $w$ is a word in either generating set, let $|w|$ be its length, and for a group element $g$, let $|g|_X = d_\Gamma(1, g)$ and $|g|_Y = d_{\Gamma'}(1, g)$ (we will sometimes identify $w$ to the endpoint of the path starting at $1$ and labelled by $w$ in the relevant graph, so that $|w|_X$ or $|w|_Y$ is the length of a geodesic joining these points).

\begin{lemma}
\label{lemma:qiso}
If $w \in Y^*$ is a geodesic word in the new generating set, then $|f(w)| \le |f(w)|_X + k - 1$. In particular, $f(w)$ is a $(1, k - 1)$-quasigeodesic.
\end{lemma}

\begin{proof}
Clearly $|f(w)|_X \le |f(w)| = k|w|$ since $f(w)$ is a concatenation of $|w|$ words of length $k$. If $|f(w)|_X \le k(|w| - 1)$ then $f(w)$ can be represented by $n = |w| - 1$ words $w_i'$ of length at most $k$, each of which correspond to some $y_i \in Y$, hence $w =_G y_1 \ldots y_n$ and since $n < |w|$, $w$ was not a geodesic.

Thus $k|w| \ge |f(w)|_X > k(|w| - 1)$, or since this is an integer equation, we can rearrange it to $|f(w)|_X \le k|w| \le |f(w)|_X + k - 1$. But it is trivial to see now that $f(w)$ is a $(1, k-1)$-geodesic, so we are done.
\end{proof}

\begin{theorem}
With the hypothesis given at the start of this section, $\Gamma'$ has a vertex thinness constant of $\frac{4k - 3 + 3\delta}{k}$.
\end{theorem}

\begin{proof}
Let $A'$, $B'$ and $C'$ be vertices in $\Gamma'$, and let $A$, $B$ and $C$ be the vertices in $\Gamma$ which correspond to the same group elements. Pick geodesics connecting $A'$, $B'$ and $C'$ in $\Gamma'$ to form a geodesic triangle $\alpha$, and note that any vertex along these geodesics corresponds to a vertex in $\Gamma$. If $w'$ was the label on a side of $\alpha$, then $f(w')$ labels a path which passes through each of these points, and is a $(1, k-1)$-quasigeodesic by Lemma \ref{lemma:qiso}. Let $\gamma$ be the triangle in $\Gamma$ labelled by these paths.

By Lemma \ref{lemma:qtri}, $\gamma$ is $3k - 2 + 3\delta$-thin. Since corresponding vertices on $\alpha$ are guaranteed to map to corresponding points on $\gamma$ (this is ensured by the introduction of $\$$: if $d_\alpha(A, x) = n$ then $d_{\gamma}(A, x) = kn$), corresponding vertices on $\alpha$ are within $\frac{4k - 3 + 3\delta}{k}$ of each other by Lemma \ref{lemma:qiso}, and we are done.
\end{proof}

Now it is clear that every hyperbolic group has a generating set with a Cayley graph whose vertex thinness constant is $3$: if $G = <\!\!X|R\!\!>$ is a presentation with vertex thinness constant $\delta > 3$, then noting that the vertex thinness constant can always be assumed to be an integer, performing the above construction with $k = 3\delta - 2$ gives a presentation whose Cayley graph $\Gamma'$ has a vertex thinness constant of $4$. By Proposition \ref{proposition:vertex_geodesic}, all geodesic triangles in the Cayley graph $\Gamma'$ must be $13$-thin.

\chapter{Conjugacy Problem}

\section{Introduction}

In \cite{quadratic}, Bridson and Howie demonstrate a solution of the conjugacy problem for lists of elements in a hyperbolic group -- in fact, they prove that the problem is solvable in quadratic time for a torsion free group (using the notation of the abstract, their bound on running time is $O(n\mu^2)$).

The aim here is to both improve the bound on running time and to go some way towards fixing the rather limp conclusion in part 2 of Theorem B in their paper, in which their algorithm simply terminates when the lists contain entirely elements of finite order without giving any results on the conjugacy.

The ideas used here closely relate to the ideas in \cite{linear}, in which Epstein and Holt show that the conjugacy problem for single elements in a hyperbolic group can be solved in linear time if one assumes a RAM model of computing. They do so by showing that infinite order elements tend to be well-behaved when raised to large powers, and finite order elements can be conjugated to elements of short length, whose conjugacy can be precomputed. In fact, we use a number of results from that paper which relate to these facts in order to establish the result here.

Of course, as in the aforementioned paper, we are assuming a RAM model of computing -- that is, we are assuming the basic operations such as addition and multiplication of integers takes place in constant time, which is reasonable when one assumes that one is not dealing with integers greater than some large upper bound, say $2^{31}$ -- that is, those integers which would fit within a standard 32-bit word. For the purposes of this algorithm, we can make some appropriate assumption, like that our input consists of lists of length less than $2^{31}$, whose total element length is also less than $2^{31}$. We will also assume that every word $w$ in each of the input lists has $|w|_G > 1$ (this is sensible, since words of length $0$ must be the identity, which is clearly conjugate only to itself, so if we receive such an element, we can either trivially reject the input lists as not being conjugate, or simply remove the elements from the input without affecting conjugacy).

We will presume for the duration of this chapter that the ambient finitely generated group $G$ has been picked along with a finite presentation, and that this group is $\delta$-hyperbolic. We will also assume that an ordering on the generators has been picked, so that the notion of a short-lex least representative word for each element exists.

The technicalities behind the proof in the case where one element has infinite order are largely covered by showing that any infinite order element can be raised to some (bounded) power and then conjugated by some other element (of bounded length) to produce a straight element (that is, $|g^n|_G = |n||g|_G$ for any $n \in \mathbb{Z}$), then noting that the length of any element when conjugated by large powers of some straight element is very predictable. That is, either the length of the resulting elements $a^{g^n}$ will increase as a linear function of $n$, or every conjugate will be equal to $ah$ for some $h$ of bounded length.

We use a number of results from \cite{linear}. Firstly, Section 3.1 there which allows us to reduce words to a conjugate of either a quasigeodesic or a short word (paraphrased along with Section 3.2 which allows us to find short-lex straight powers in Proposition \ref{prop:short_conj} here), and secondly the remainder of the procedure described there (Sections 3.3 and 3.4) which allows the conjugacy problem for single elements to be solved by finding the centraliser of some positive power of the elements (this part is paraphrased in Proposition \ref{prop:find_centraliser}).

The above centraliser is exhibited as a cyclic group $<\!\!c\!\!>$ and a bounded set of coset representatives. For each representative $s$, we compute approximations of the expected lengths of $a_i^{c^n}$ and $b_i^{h^{-1}s^{-1}c^n}$ for large $n$, where $h$ is an element such that $a_1^h = b_1$, as found in \cite{linear}. 

By comparing these approximations we can find, for each representative, a range of possible powers of the cyclic generator such that the two lists would be conjugate if and only if one of these powers yielded a conjugating element $c^nsh$, and check only these powers. The number of possible powers is bounded by a constant which depends only on the presentation, hence the whole algorithm will run in linear time.

Unfortunately, since we can only obtain this form of the centraliser for infinite order elements, we once again run up against problems when we consider lists of torsion elements. It is, however, possible to show the following:

\begin{theorem}
There is an algorithm, which given any list $A = (a_1, a_2, \ldots)$ of elements of $G$ and $n \in \mathbb{N}$, will either find a $c \in G$ for which $|(a_i a_{i+1} \ldots a_n)^c| \le (12L + 4\delta + 2)3^{n-i}$ for any $1 \le i \le n$, or find an infinite order element $g := a_i a_{i+1} \ldots a_j$ ($i \le j \le n$). Further, the algorithm will run in time $O(n^2\mu)$, where $\mu$ is the total length of the first $n$ elements in the list.
\end{theorem}

If, after applying this theorem we do not find an element of infinite order, we can replace our lists $A$ and $B$ with $(a_1 \ldots a_n, a_2 \ldots a_n, \ldots, a_n)^{c_A}$ and $(b_1 \ldots b_n, b_2 \ldots b_n$, $\ldots, b_n)^{c_B}$ respectively, and all elements in the new lists will have bounded length. Thus it is possible to simply precompute conjugacy of lists of ``short'' elements and to check our input against this. (\cite{quadratic} also gives an exponential time algorithm for solving conjugacy of lists of elements, which can be used here.) The disadvantage of this approach is that as the list grows longer, so does the amount of pre-computation required (in a worse-than-exponential fashion). This is why we have to specify a maximum list length $n$ in order to get a linear time algorithm for lists of length shorter than $n$.

Finally, a brief discussion of the centraliser problem for lists will be given.

\subsection{Some Constants}

There are a number of constants which will be used throughout this chapter. These are:

\begin{itemize}
\item $L := 34\delta + 2$
\item $V$, the number of vertices $p \in \Gamma$ such that $d(1, p) \le 2\delta$
\item $Q$, the number of vertices $p \in \Gamma$ such that $d(1, p) \le 4\delta$
\item $M := 26000\delta^5L^3V^4$
\end{itemize}

\section{Preliminaries}

\begin{lemma}
\label{lemma:triangle}
Suppose $\mytriangle{x}{y}{z}$ is a geodesic triangle with meeting points $c_x$, $c_y$, $c_z$ on sides opposite $x$, $y$, and $z$ respectively, and that $p$ is a midpoint on $\myside{x}{y}$. Then:

\[
d(p, z) \le \frac{2\max\{d(x, z), d(y, z)\} - d(x, y) + 1}{2} + \delta
\]

\begin{figure}
\begin{center}
\begin{picture}(7,2)(-0.2,-0.05)
\put(0,0){\line(1,0){6}}
\put(0,0){\line(2,1){2}}
\put(2,1){\line(4,-1){4}}

\put(0,0){\circle*{0.05}} % x
\put(-0.2,-0.1){\makebox(1,1)[bl]{$y$}}
\put(6,0){\circle*{0.05}} % y
\put(6.1,-0.1){\makebox(1,1)[bl]{$x$}}
\put(2,1){\circle*{0.05}} % z
\put(1.8,1.05){\makebox(0.4,1)[b]{$z$}}

\put(2.5,0.875){\circle*{0.05}} % c_x
\put(2.5,0.925){\makebox(0.3,1)[b]{$c_y$}}
\put(1.5,0.75){\circle*{0.05}} % c_y
\put(1.3,0.8){\makebox(0.3,1)[b]{$c_x$}}
\put(2.1,0){\circle*{0.05}} % c_z
\put(1.8,0.05){\makebox(0.4,1)[b]{$c_z$}}
\put(3,0.){\circle*{0.05}} % p
\put(2.8,0.05){\makebox(0.4,1)[b]{$p$}}
\end{picture}
\caption{A Triangle in Hyperbolic Space}
\label{figure:hyp_tri}
\end{center}
\end{figure}
\end{lemma}

\begin{proof}
Assume that $d(x, z) \ge d(y, z)$, as in Figure \ref{figure:hyp_tri}. Then clearly:

\begin{eqnarray*}
d(c_z, p) & =   & d(y, p) - d(y, c_z) \\
          & \le & \frac{d(x, y) + 1}{2} - \frac{d(x, z) + d(x, y) - d(y, z)}{2} \\
          & =   & \frac{d(y, z) - d(x, z) + 1}{2}
\end{eqnarray*}

If we assume the other side is longer, we can exchange $x$ and $y$ in the above
to get a similar equation, hence:

\[ d(c_z, p) \le \left| \frac{d(x, z) - d(y, z)}{2} \right| + \frac{1}{2} \]

We know $d(c_z,c_x) \le \delta$ and
$d(c_x,z) = \frac{d(x, z) + d(y, z) - d(x, y)}{2}$, so
combining the three, we find:

\begin{eqnarray*}
d(p, z) & \le & d(p, c_z) + d(c_z, c_x) + d(c_x, z) \\
        & \le & \left| \frac{d(x, z) - d(y, z)}{2} \right| + \frac{1}{2} + \frac{d(x, z) + d(y, z) - d(x, y)}{2} + \delta \\
        &  =  & \frac{\max\{d(x, z), d(y, z)\} - d(x, y) + 1}{2} + \delta
\end{eqnarray*}

Which is the required result.
\end{proof}

The following result is due to Shapiro, and a proof is given in \cite{linear}.

\begin{lemma}
\label{lemma:short_lex}
Suppose $w$ is a word in the generators of $G$. Then reduction of $w$ to its short-lex least representative can be done in time linear in $|w|$.
\end{lemma}

We will denote use of this lemma (ie. the act of finding short-lex reduced words) by $\slex$ operating on both elements, words and lists of elements or words in the obvious way. Of course, we will also use it implicitly, since it implies that operations like finding the length of an element, or deciding equality of two elements can be done in time linear in the length of the input words.

Also in \cite{linear} (Section 3.1), it is shown that, for $L = 34\delta + 1$ (a constant that will be used throughout this paper):

Note that between them, these propositions show that if $w$ is some word in the generators of $G$, we have that $|w_C|_G > 2L$ implies $w$ represents an infinite order element of $G$.

\begin{lemma}
\label{lemma:replace}
Suppose $n \in \mathbb{N}$, and $a_1, \ldots, a_n, b_1, \ldots, b_n \in G$. Then $(a_1, \ldots, a_n)$ is conjugate in $G$ to $(b_1, \ldots, b_n)$ if and only if $(a_1a_2, a_2, \ldots, a_n)$ is conjugate in $G$ to $(b_1b_2, b_2, \ldots, b_n)$.
\end{lemma}

Clearly one can extend this to show that we can multiply any elements in the list together, provided we do the same in both lists.

In \cite{linear} (Section 3.1), it's proved that the conjugacy problem for single elements is linear in the total element length. As a step in this proof it is shown that:

\begin{proposition}
\label{prop:short_conj}
Let $w$ be some short-lex least word. Let $u$ be the short-lex least representative of $w_C$. If $u$ has length strictly greater than $2L$, then all positive powers of $u$ label $L$-local $(1, 2\delta)$-quasigeodesics.
\end{proposition}

And in Section 3.2 of the same, we have:

\begin{proposition}
\label{prop:long_conj_slex}
Suppose $w$ is some short-lex least word such that all positive powers of $w$ label $L$-local $(1, 2\delta)$-quasigeodesics and $|w| > 2L + 1$. Then there exists some integer $0 < k \le Q^2$ and some word $a$ whose length is less than $4\delta$ such that $\slex((w^k)^a)$ is short-lex straight.

Moreover, $k$ and $a$ can be computed in time linear in $|w|$.
\end{proposition}
Finally, for the remainder of the paper, let $V$ be the volume of a $2\delta$-ball in $\Gamma$ (that is, the number of geodesic words whose length is less than or equal to $2\delta$).

We can now move onto results.

\section{Infinite Order Elements}

In this section, we suppose that we are given lists $A = (a_1, \ldots, a_m)$ and $B = (b_1, \ldots, b_m)$, and that $a_1$ is of infinite order.

Our first task is to attempt to get a handle on the centraliser of $a_1$. We can do this for short-lex straight elements using part of the method for solving the conjugacy problem for individual infinite order elements outlined in \cite{linear}, which is summarised here:

\begin{proposition}
\label{prop:find_centraliser} For any short-lex straight element $w$, set $c^l = w$ with $l \in \mathbb{N}$ maximal. Then there exists a set $S \subset G$ with $|S| \le V$ whose elements are of length at most $|c| + 2\delta$, such that every element of the centraliser of $w$ can be expressed in the form $c^ns$ for some $s \in S$ and $n \in \mathbb{Z}$.

Moreover, $S$ and $c$ can be computed in time linear in $|w|$.
\end{proposition}

As in Proposition \ref{prop:short_conj}, in order to find short-lex straight elements which are conjugates of some power of an input word $w$, it is useful to be able to guarantee that the length of $w_C$ is strictly greater than $2L$. In fact, we can do this for any infinite order word:

\begin{proposition}
\label{prop:make_long}
Let $M := 26000\delta^5L^3V^4$. Let $w$ be any infinite order geodesic word in the generators of $G$ with $|w| \le 2L$. Then $|(\slex(w^M))_C| > 2L$.
\end{proposition}

\begin{proof}
Note that by \cite{notes}, we know the following (the explicit values are taken from the proofs):

\begin{itemize}
\item (Proposition 3.2) For any infinite order geodesic word $w$, the two way infinite path in $\gamma$ defined by $w^\infty$ is a $(\lambda, \epsilon)$-quasigeodesic, where $\lambda = |w|V$ and $\epsilon = 2|w|^2V^2 + 2|w|V$.
\item (Theorem 2.19) That $e(0) = \delta$, $e(l) = 2^{\frac{l}{\delta} - 2}$ for $l > 0$ is a divergence function for any $\delta$-hyperbolic space (ie. given geodesics $\gamma = [xy]$ and $\gamma' = [xz]$, $r, R \in \mathbb{N}$ such that $r + R < \min(|\gamma|, |\gamma'|)$ and $d(\gamma(R), \gamma'(R)) > e(0)$, if $\alpha$ is a path from $\gamma(R + r)$ to $\gamma'(R + r)$ lying outside the ball of radius $R + r$ around $x$, then $|\alpha| > e(r)$.)
\item (Proposition 3.3) In a $\delta$-hyperbolic space with divergence function $e$, given a $(\lambda,\epsilon)$-quasigeodesic $\alpha$ between $x$ and $y$, and a geodesic $\gamma$ starting and ending at the same points as $\alpha$, every point on $\gamma$ is within a distance $D$ of a point on $\alpha$, for any $D$ that satisfies $e(\frac{D - e(0)}{2}) \ge 4D + 6\lambda D + \epsilon$.
\end{itemize}

Now, consider the $(\lambda, \epsilon)$-quasigeodesic $\gamma$ given in the first result and pick $D$ from the third result appropriately, and define the points $x := 1$, $y := w^n$ and $z := w^{2n}$ for some $n$. Let $[xy]$ and $[yz]$ be the short-lex geodesics. Let $p$ be a midpoint of $[xy]$ and $q$ the corresponding midpoint of $[yz]$ (that is, $q = y\myside{x}{p}$). See figure \ref{figure:make_long}.

\begin{figure}
\begin{center}
\input fig3_make_long.pstex_t
\caption{Cutting across a long quasigeodesic}
\label{figure:make_long}
\end{center}
\end{figure}

Then there exists a point $p'$ on $\gamma$ within $D$ of $p$, we can pick the point $q' = y\myside{x}{p'}$ so that $q'$ is clearly within $D$ of $q$. Then:

\begin{eqnarray*}
d(p,q) & \ge & d(p',q') - 2D \\
       & \ge & \frac{d_\gamma(p', q')}{\lambda} - \epsilon - 2D \\
       &  =  & \frac{|w|n}{\lambda} - \epsilon - 2D
\end{eqnarray*}

Since we need $d(p, q) > 2L$, it is sufficient to ensure $\frac{|w|n}{\lambda} - \epsilon - 2D > 2L$. So taking $n > \lambda(2L + 2D + \epsilon)$, it is clear that $d(p, q) = |(\slex(w^N))_C| > 2L$. We can find $\lambda$ and $\epsilon$ from the first result, and after much manipulation and approximation, we find that it is sufficient to take $D = 6144\delta^5L^2V^4$, hence $\lambda(2L + 2D + \epsilon) \le (2LV)(13000\delta^5L^2V^4) = 26000\delta^5L^3V^5 = M$, and $n > M$ implies that $|(\slex(w^N))_C| > 2L$ as required.
\end{proof}

\begin{remark}
The value of $M$ given above is of course by no means optimal - for each particular case, it is likely that a much lower bound can be obtained by solving the equations programmatically. However, the above bound illustrates that there is a definite computable value.
\end{remark}

Combining this result with the previous one, we obtain a more useful proposition:

\begin{proposition}
\label{prop:find_straight_centraliser}
There exists a constant $P \in \mathbb{N}$ depending only on the group and presentation such that for any infinite order geodesic word $w$, there exists a set $S \subset G$ with $|S| \le V$ whose elements are of length at most $P|w|$, a short-lex straight element $c \in G$ whose length is at most $P|w|$ and an element $p$ of length at most $P|w|$ such that every element of the centraliser of $w$ can be expressed in the form $pc^ns$ for some $s \in S$ and $n \in \mathbb{Z}$.

Moreover, $S$, $p$ and $c$ can be computed in time linear in $|w|$.
\end{proposition}

\begin{proof}
Firstly, suppose that $|w_C|_G \le 2L$. Then, by Proposition \ref{prop:make_long} applied to $w_C$, $|(\slex((w_C)^M))_C| > 2L$. In this case, let $q' := w_L$ and $m_1 := M$. On the other hand, if $|w_C|_G > 2L$ let $q' := 1$ and $m_1 := 1$. Then either way, letting $w'' := \slex((w^{q'})^{m_1})$, we have $|w''_C|_G > 2L$. Hence, by proposition \ref{prop:short_conj}, there is a power $m_2' \le Q$, and a word $a$ of length less than or equal to $4\delta$ such that $w' := \slex(((w''_C)^{m_2'})^a)$ is short-lex straight. Let $q := q'w''_La$, and $m_2 := m_1 m_2'$, so that $w' = \slex((w^q)^{m_2})$. Clearly, $|q| \le (MQ + 1)|w| + 4\delta$ and $m_2 \le MQ$.

Now let us apply Proposition \ref{prop:find_centraliser} to $w'$ to give us a $c$ which is short-lex straight, along with a set $S'$.

Now, suppose $g$ is some element of the centraliser of $w$. Then $w'^{q^{-1}gq} =_G w'$, hence $q^{-1}gq$ is in the centraliser of $w'$ and thus $q^{-1}gq =_G c^ns'$ for some $s' \in S'$ and some integer $n$. Let us set $p := q$ and $S := \{ s'q^{-1} : s' \in S' \}$, then clearly every element of the centraliser of $w$ can be expressed in the form $qc^ns'q^{-1} = pc^ns$ for some $s' \in S'$, $s \in S$ and $n \in \mathbb{Z}$ as required.

Clearly, the elements of $S$ have a length of at most $(MQ + 1)|w| + 4\delta + |w|$, which in particular is less than $(MQ + 4\delta + 2)|w|$. Similarly, $|c| \le (MQ + 4\delta)|w|$, so it is sufficient to set $P := (MQ + 4\delta + 2)$. Also, the set $S$ has the same number of elements as $S'$, so clearly $|S| \le V$. Clearly, we can obtain $S$ and $c$ in time linear in $|w|$, so the proposition is proved.
\end{proof}

Here is a quick lemma which shows that ``thin'' sections of a geodesic quadrilateral behave in a very specific way:

\begin{lemma}
\label{lemma:thin_section}
Suppose that the points $C$, $D$, $E$ and $F$ satisfy $d(C, D) = d(E, F)$. Define a geodesic quadrilateral as in Figure \ref{figure:thin_section}, and divide this quadrilateral into two triangles using a geodesic representing $\path{C}{E}$. Let $p_1$ be the meeting point of the triangle $\mytriangle{C}{D}{E}$ lying on $u := \path{C}{D}$, and let $p_2$ be the meeting point of the triangle $\triangle{C}{E}{F}$ lying on $v := \path{F}{E}$. Let $K := |\path{C}{D}| - |\path{C}{E}|$. Then for any $i \in \mathbb{Z}$ with $d(F, p_2) \le i \le d(C, p_1)$, we have $\path{u(i)}{v(i)} =_G h(v(i + K))^{-1}v(i)$ for some word $h$ with $|h| \le 2\delta$.
\end{lemma}

\begin{proof}
This is elementary: For any $i$ in the given range, let $w(i)$ be the point on $\path{C}{E}$ corresponding to $u(i)$, and $x(i)$ the point on $v$ corresponding to $w(i)$ as in Figure \ref{figure:quad_zoom}. Pick some specific $j$ in the range. It is clear that for any $i$, $d(u(i), u(j)) = d(x(i), x(j))$, hence we find that $d(x(i), v(i)) = d(x(j), v(j))$. Now we have:

\begin{eqnarray*}
d(x(j), v(j)) & = & |d(E, v(j)) - d(E, x(j))| \\
              & = & |d(D, u(j)) - d(E, w(j))| \\
              & = & |d(D, u(j)) - d(C, E) + d(C, w(j))| \\
              & = & |d(D, u(j)) - d(C, E) + d(C, u(j))| \\
              & = & |d(C, D) - d(C, E)| \\
              & = & |K|
\end{eqnarray*}

It should be clear that if $x(j)$ is closer to $E$ than $v(j)$, the same is true for $x(i)$ and $v(i)$ for all $i$, hence we can follow the path from $u(i)$ to $w(i)$ to $x(i)$ (of length at most $2\delta$, hence giving us $h$), then the path from $x(i)$ to $v(i)$ (which is $v(i + K))^{-1}v(i)$) to get the result.

\begin{figure}
\begin{center}
\input fig10_quad.pstex_t
\caption{The thin section of a geodesic quadrilateral}
\label{figure:thin_section}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
\input fig11_quad_zoom.pstex_t
\caption{A part of figure \ref{figure:thin_section}}
\label{figure:quad_zoom}
\end{center}
\end{figure}

\end{proof}

We now prove the following useful proposition:

\begin{proposition}
\label{prop:shape}
Suppose that $G$ is a $\delta$-hyperbolic group, that $g$ is a straight word and that $a$ is any geodesic word in the generators of $G$. Let $N := V + \ceiling{\frac{3|a| + 7\delta}{2|g|}} + 2$. Then:

\begin{itemize}
\item If $|a^{g^N}| > |a| + 4\delta$, then letting $K_1 := |a^{g^N}| - |g|N$ and, $K_2 := |a^{g^{-N}}| - |g|N$, for all $i > N$, we have

\[ \left||a^{g^i}| - K_1 - 2i|g|\right| \le 3\delta \]

and

\[ \left||a^{g^{-i}}| - K_2 - 2i|g|\right| \le 3\delta \]

\item Otherwise, letting $K := 2|g|N - |g^Nag^N|$, we have for any $i \in \mathbb{Z}$, there exists a word $h$ of length less than or equal to $2\delta$ such that:

\[ a^{g^i} =_G hg^\infty(-K) \]
\end{itemize}
\end{proposition}

\begin{proof}
First, suppose that the length of $a^{g^i}$ ($i \in \mathbb{Z}$) is bounded above by some constant $R$. Our aim in this case is to show that the second case of the proposition applies. Consider the paths $\alpha := g^\infty$, and $\beta := ag^\infty$ (ie. the path following $g$ through each $1^{ag^i}$). Let $k > \ceiling{\frac{R}{|g|}}$, and let $C := g^{-k}$, $D := g^k$, $E := ag^k$ and $F := ag^{-k}$. Define a geodesic quadrilateral between these points, with $\path{C}{D}$ and $\path{F}{E}$ being segments of $\alpha$ and $\beta$.

Lemma \ref{lemma:thin_section} can clearly be applied, so that letting $K' := 2|g|k - |g^kag^k| = d(C, D) - d(C, E)$, we find that for any $i \in \mathbb{Z}$ such that $|i| < k - \ceiling{\frac{R}{|g|}}$ (since $d(p_1, D) \le R$, and $d(p_2, F) \le R$, this means that $d(F, p_2) \le |g|i \le d(C, p_1)$, as required by the lemma), if we take $p := g^i$, $p' := ag^i$ and $p'' := ag^\infty{|g|i + K'}$, we have:

\[ a^{g^i} =_G \path{p}{p'} =_G h\path{p''}{p'} =_G hg^\infty(-K') \]

Where $h$ is some word such that $|h| \le 2\delta$. Therefore, we obey the equation in the second case of the proposition for any $i$ in this bounded range. In particular, by taking $k$ to be large, it is clear that there must be at most $V$ distinct conjugates of the form $a^{g^i}$ for $i \in \mathbb{Z}$. Also note if $a =_G h'g^\infty(-K')$, we have $a^{g^i} =_G hg^\infty(-K') =_G hh'^{-1}h'g^\infty(-K') = hh'^{-1}a$ - hence $|a^{g^i}| \le |a| + 4\delta$, and if the length of conjugates is bounded, $|a| + 4\delta$ will act as a bound. We will thus assume that $R = |a| + 4\delta$.

\begin{figure}
\begin{center}
\input fig1_bdd_inf.pstex_t
\caption{The geodesics $\alpha$ and $\beta$ lie close.}
\label{figure:bdd_inf}
\end{center}
\end{figure}

Let $k := N$ as in the statement of this proposition. Since the meeting point, $p_1$, must be within $R$ of $g^k$ and, $p_2$ within $R$ of $ag^{-k}$, it is clear that there must be at least $2N - \ceiling{\frac{2R}{|g|}} > V$ distinct $i \in \mathbb{Z}$ such that $|i| \le k - \ceiling{\frac{R}{|g|}}$. The $a^{g^i}$ cannot all be distinct for this range of $i$, since we know that there are only $V$ possible distinct values, so there must be at least one repeated conjugate, say $a^{g^i} =_G a^{g^{i+l}}$ so that $a^{g^j} =_G a^{g^{j+tl}}$ for any $i, t \in \mathbb{Z}$. (Of course, this is the same as saying that $g^l \in C_G(a)$.) In particular, every possible $a^{g^j}$ for $j \in \mathbb{Z}$ must be equal in $G$ to some $a^{g^t}$ where $|t| \le k - \ceiling{\frac{|a| + 4\delta}{|g|}}$ - and hence is equal in $G$ to $h(g^\infty(-K))^{-1}$ for some word $h$ with $|h| \le 2\delta$ as required by the statement. Thus if the length of conjugates is bounded, we must be in the second case.

Now suppose that the length of conjugates $a^{g^i}$ for $i \in \mathbb{Z}$ is not bounded above. We will first show that this is equivalent to $|a^{g^N}| > |a| + 4\delta$ (thus demonstrating that the cases as given in the theorem statement indeed correspond to the cases where the length of conjugates are unbounded and bounded respectively).

Let us consider the geodesic quadrilateral with corners $C := 1$, $D := g^N$, $E := ag^N$ and $F := a$, as in Figure \ref{figure:unbd_end} and the obvious geodesics connecting them (pick any geodesic to connect $D$ and $E$). Now let us split this quadrilateral into two triangles using a geodesic connecting $C$ and $E$ (note this is equal in $G$ to $ag^N$). Let $p_1$ be the meeting point between $1$ and $g^N$, let $p_2$ be the meeting point between $a$ and $ag^N$ (see Figure \ref{figure:unbd_end} for a diagram of this arrangement), and let $k_1$ and $k_2$ be their respective distances from $1$ and $a$ (so $k_1 = d(C, p_1) = \frac{|g|N + |ag^N| - |a^{g^N}|}{2}$ and $k_2 = d(F, p_2) = \frac{|g|N + |a| - |ag^N|}{2}$).

%\begin{figure}
%\begin{center}
%\input fig4_unbd_start.pstex_t
%\caption{The start of the unbounded case}
%\label{figure:unbd_start}
%\end{center}
%\end{figure}

The key observation here is that by following the path illustrated in Figure \ref{figure:unbd_end}, we see that $|a^{g^N}| - 2|g|(N - i) - 3\delta \le |a^{g^i}| \le |a^{g^N}| - 2|g|(N - i) + 3\delta$ for any $i \in \mathbb{Z}$ such that $|g|N \ge |g|i \ge \max \{ k_1, k_2 \}$. Hence, in particular, if we let $k := \ceiling{\frac{\max\{k_1, k_2\}}{|g|}}$ (ie. the first $k$ such that $|g|k$ lies after both meeting points), we have $|a^{g^N}| \ge |a^{g^k}| + 2|g|(N-k) - 3\delta \ge 2|g|(N-k) - 3\delta$. If we show that $k < N - \frac{|a| + 7\delta}{2|g|} < V + \frac{3|a|}{2|g|} + 2$, we have $|a^{g^N}| > |a| + 4\delta$ as required.

First suppose that $k_1 \le |a|$ (note $k_2 \le |a|$ is always true). Then it's clear that $k \le \ceiling{\frac{|a|}{|g|}} < V + \frac{3|a|}{2|g|} + 2$.

\begin{figure}
\begin{center}
\input fig5_unbd_end.pstex_t
\caption{Linear growth after the meeting point}
\label{figure:unbd_end}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
\input fig7_unbd_behaved.pstex_t
\caption{The midsection of the unbounded case, case 2}
\label{figure:unbd_behaved}
\end{center}
\end{figure}

So let's consider $|a| \le k_1$. Once again, we can apply Lemma \ref{lemma:thin_section} and we find that once again there exists some word $w$ such that the conjugates lying between the meeting points (that is, the $a^{g^i}$ where $k' \le i < k$ with $k' := \ceiling{\frac{k_2}{|g|}}$, the power of the first conjugate after the meeting point $p_2$) have the form $hw$ with $|h| \le 2\delta$. In particular we have at most $V$ distinct elements $a^{g^i}$ with $k' \le i < k$. If we ever get a repeated element, say $a^{g^i} = a^{g^j}$, then $g^{i-j} \in C_G(a)$ and we are in the bounded case, so we must have $k - k' \le V$. Now since $k' \le \ceiling{\frac{|a|}{|g|}}$, we must have $k < V + \ceiling{\frac{3|a|}{2|g|}} + 1 \le V + \frac{3|a|}{2|g|} + 2$, which is what we required above. Thus we have established that $|a^{g^N}| > |a| + 4\delta$ if and only if the set of conjugates $\{ a^{g^j} : j \in \mathbb{Z}\}$ is infinite.

Now we prove that all higher powers, $g^i$ for $i \ge N$, will result in conjugates whose length is within $3\delta$ of $|a^{g^N}| + 2(i - N)|g|$. This can easily be seen by following the path marked on figure \ref{figure:unbd_grow}. (We have, as before, $|a^{g^i}| - |g|(i - N) - 3\delta \le |a^{g^N}| \le |a^{g^i}| - |g|(i - N) + 3\delta$.)

\begin{figure}
\begin{center}
\input fig8_unbd_grow.pstex_t
\caption{After the first section}
\label{figure:unbd_grow}
\end{center}
\end{figure}

Clearly, then, we are in the first case in the theorem and it is trivial to compute the constants: $K_1 = |ag^N| - |g|N$, $K_2 = |ag^{-N}| - |g|N$ (to see this, simply replace $g$ with $g^{-1}$ - which is clearly also a straight word) - and we have proved the theorem.
\end{proof}

Now we can approach the problem of solving the conjugacy of the two lists.

Recall that we have two lists $A = (a_1, \ldots, a_m)$ and $B = (b_1, \ldots, b_m)$, and that $a_1$ is of infinite order. Recall also that we have both an element $h \in G$ such that $a_1^h = b_1$ (we can get this using the method in \cite{linear}) and from Proposition \ref{prop:find_straight_centraliser}, elements $c, p \in G$ such that $c$ is straight along with a set $S$ of size bounded by $V$ so that every element in the centraliser of $a_1$ can be expressed in the form $pc^ns$ for some $n \in \mathbb{Z}$ and $s \in S$.

Any element that conjugates $A$ to $B$ must conjugate $a_1$ to $b_1$, and hence is of the form $pc^nsh$. Hence, we need only search for elements of this form. For simplicity, let us replace $B$ with $\slex(B^{h^{-1}})$ and $A$ with $\slex(A^p)$. Since the size of $S$ is bounded by $V$, depends only on the group and presentation, we can iterate through its elements in constant time.

Now, suppose we are given some element $s \in S$. We will proceed through $i \in \{1, \ldots, m\}$ to find a bounded range of possible $g \in G$ which could be considered as candidates for conjugating elements. That is, for each $i \in \{1, \ldots, m\}$, we need to find a range of $k \in \mathbb{Z}$ which contains any $k$ such that $a_i^{c^ks} = b_i$. By iterating over every $s \in S$, we aim to either eliminate or check every possible element of the centraliser. Let us apply Proposition \ref{prop:shape} with $a = a_i$ and $g = c$, and with $a = b_i^{s^{-1}}$ and $g = c$. Note that one only needs to apply Proposition \ref{prop:shape} once for each $a_i$.

Clearly if the two elements result in different cases in the proposition then no $k$ can exist such that $a_i^{c^ks} = b_i$, since if it did, for any $l \in \mathbb{Z}$ we have $a_i^{c^{k+l}} = b_i^{s^{-1}c^l}$, and for large $l$, we would get a contradiction on the length of this element. Thus, we can move onto the next element of $S$.

If both elements are in the first case, let $K_{1a} := K_1(a_i, c)$ and $K_{1b} := K_1(b_i^{s^{-1}}, c)$ with $K_{2a}$ and $K_{2b}$ defined similarly. Comparing lengths of elements, we find that if we assume that there exists some $k \in \mathbb{Z}$ such that $a_i^{c^ks} =_G b_i$, then for all $l \in \mathbb{N}$, $a_i^{c^{k+l}} = b_i^{s^{-1}c^l}$, and we have:

\begin{eqnarray*}
& & \left|K_{1a} + 2(k + l)|c| - K_{1b} - 2l|c|\right| \\
& = & \left|K_{1a} + 2k|c| - K_{1b}\right| \\
& \le & 6\delta
\end{eqnarray*}

Hence we have:

\[ \left|k - \frac{K_{1b} + K_{1a}}{2|c|}\right| \le \frac{6\delta}{2|c|} \]

Applying the same reasoning to the other side gives:

\[ \left|k - \frac{K_{2a} + K_{2b}}{2|c|}\right| \le \frac{6\delta}{2|c|} \]

So we can restrict $k$ to within the intersection of each of these clearly bounded ranges, and we need to check at most $6\delta$ elements $a_i^{c^ks}$ for equality to $b_i$ in order to find any $k$ which exists. This can be done in time $O(m\mu)$ (since the lengths of said elements must be linear in the input length).

Now suppose both elements lie in the second case. This does not immediately allow us to eliminate any elements, however we can use the bounds for the previous case unless all elements in the list have this property. Suppose that they do indeed all have this property. We know that conjugates will repeat after at most $V$ powers, and we can, for each $i$, in time $O(\mu)$, work out exactly how long the repeating sequence is by simply evaluating each conjugate $a_i^{c^k}$ until one of them is equal to simply $a_i$. While we are doing this, we can also make a list $M_i$ of each $k$ such that $a_i^{c^ks} = b_i$. Let $l_i$ be the length of the repeating sequence for $a_i$ for each $i$, then we simply need to find a number between $0$ and $\lcm\{l_1, \ldots, l_m\} \le V!$ which, for each $i$, is in $M_i + n_i\mathbb{Z}$. This can be solved in time linear in $m$ by simply checking every number $0 \le j \le \lcm\{l_1, \ldots, l_m\}$ to see if it satisfies $j \in M_i + l_i\mathbb{Z}$ for all $1 \le i \le m$.

Thus in all cases, we can, in time $O(m\mu)$ as required, solve the conjugacy problem for lists containing at least one infinite order element.

\section{Conjugacy of Lists Consisting Only of Finite Order Elements}

Suppose $A = (a_1, a_2, \ldots, a_n)$ and $B = (b_1, \ldots, b_n)$ with $a_i$ and $b_i$ finite order geodesic words in the generators of $G$ for all $i$.

We will describe an algorithm to determine whether $A^g = B$ for some $g \in G$ which will reduce to the case where the $|a_i|$ and $|b_i|$ all have length less than or equal to some fixed bound $K_{i,n}$. We can then determine conjugacy simply by precomputing conjugacy of all such lists of ``short'' elements and looking up the particular problem. Suppose $A = (a_1, a_2, \ldots)$ is a list of geodesic words in $G$ and $n \in \mathbb{N}$. Then consider the following algorithm:

\begin{algorithm}
\label{algorithm:shorten_list}
\begin{enumerate}
\item Let $c \leftarrow 1, k \leftarrow 1$.
\item \label{step:is_other_long} If $|(\slex((a_j \ldots a_k)^c)_C| > 2L$ for any $1 \le j \le k$, let $g \leftarrow a_j \ldots a_k$, stop and return $g$.
\item \label{step:extend_c} Let $c \leftarrow c(\slex(a_k^c))_L$.
\item \label{step:short_end} Let $k \leftarrow k + 1$.
\item \label{step:short_loop} If $k = n + 1$, then stop and return $c$, else go to step \ref{step:is_other_long}.
\end{enumerate}
\end{algorithm}

\begin{proposition}
\label{prop:shorten_list}
The above algorithm will either find a $c \in G$ for which $|(a_i a_{i+1} \ldots a_n)^c| \le (12L + 4\delta + 2)3^{n-i}$ for any $1 \le i \le n$, or find an infinite order element $g = a_i a_{i+1} \ldots a_j$ ($i \le j \le n$). Further, the algorithm will run in time $O(n^2\mu)$, where $\mu$ is the total length of the first $n$ elements in the list.
\end{proposition}

\begin{proof}
First let us suppose $n = 1$. It should be clear that the algorithm will produce either a $g$ (which must be infinite order by Proposition \ref{prop:short_conj}) or a $c$ as required, and run in linear time. Let $K_{1,1} = 2L$. Define $\mu_k$ to be the total length of the first $k$ words in $A$, plus $k$ (that is, $\mu_k := \sum_{i=1}^k |a_i|$). Note that since $|a_i|_G > 0$, we have $\mu_k \ge k$.

Let us briefly consider the change in length of $c$ at step \ref{step:extend_c}. Using Lemma \ref{lemma:triangle} we can see that if we consider the triangle with corners $C := 1$, $D := a_k^c$ and $E := c^{-1}$ as illustrated in Figure \ref{figure:extend_c} ($p = (\slex(a_k^c))_L$ is the midpoint of $\path{C}{D} = \slex(a_k^c)$ closest to $C$), we must have $d(E, p) \le \frac{2\max\{|c|, |a_kc|\} - |c^{-1}a_kc| + 1}{2} + \delta \le |a_k| + |c| + \delta + \frac{1}{2}$. Hence $|c(\slex(a_k^c))_L| \le k(\delta + \frac{1}{2}) + \sum_{i=1}^k |a_i| = \mu_k + k(\delta - \frac{1}{2})$, so at step \ref{step:is_other_long}, $|c| \in O(\mu_k)$.

\begin{figure}
\begin{center}
\input fig9_minitri.pstex_t
\caption{Extending $c$.}
\label{figure:extend_c}
\end{center}
\end{figure}

Now suppose that $k \in \mathbb{N}$ such that $k > 1$, and we have constants $K_{i,k-1}$ such that at step \ref{step:short_loop} in the algorithm, we have $|(a_i \ldots a_{k-1})^c| \le K_{i,k-1}$ for any $1 \le i \le k - 1$. We will show there exist constants $K_{i,k}$ ($1 \le i \le k$) such that upon reaching step \ref{step:short_end} we have, in time $O(k\mu_k)$ either found an element $c \in G$ for which $|(a_i \ldots a_k)^c| \le K_{i,k}$ for any $1 \le i \le k$ or found an infinite order element $g := a_i \ldots a_k$ (for some $1 \le i \le k$). (Note that the hypothesis of this paragraph is definitely true for $k = 2$, since we will have $|a_1^c| = |(a_1)_C| \le 2L$.)

First, for simplicity of notation, convert $A$ to the list $A' = (a_1', a_2', \ldots, a_k')$ with $a_i' := \slex((a_i \ldots a_{k-1})^c)$ for $1 \le i \le k - 1$, and $a_k' := \slex(a_k^c)$. Let $g := (a_k')_L$.

Now we use Proposition \ref{prop:short_conj} and let $a_i'' := (\slex(a_i' a_k'))_C$ for each $1 \le i \le k - 1$ and $a_k'' := (a_k')_C$. If for any $i$, $a_i''$ has length strictly greater than $2L$ then clearly $a_i'$ is of infinite order by Proposition \ref{prop:short_conj}, so we are done (as in step \ref{step:is_other_long}), otherwise we continue as in the algorithm. The operation of checking the length of each $a_i''$ can clearly be done in time $O(k\mu_k)$, since the elements $a_i'$ are of length at most $\mu_k + 2|c| \in O(\mu_k)$.

Now define the points $C := 1$ and $D := a_k'$. Let $p$ be a midpoint of $\path{C}{D}$. Consider Figure \ref{figure:fin_order} for any $i < k$.

\begin{figure}
\begin{center}
\input fig9_fin_order.pstex_t
\caption{The conjugates of the $a_i'$ are all short.}
\label{figure:fin_order}
\end{center}
\end{figure}

%\begin{picture}(7,3)(0,-1.5)
%% Middle line
%\geoword{ 0   }{ 0   }{ 1   }{ 0   }{ 0.5 }{ 1   }
%\geoword{ 1   }{ 0   }{ 1   }{ 0   }{ 2.5 }{ 5   }
%
%% Stuff on bottom
%\geoword{ 1   }{ 0   }{ 2   }{-1   }{ 1   }{ 2   }
%\geoword{ 3   }{-1   }{ 1   }{ 0   }{ 0.5 }{ 1   }
%\geoword{ 6   }{ 0   }{-2   }{-1   }{ 1   }{ 2   }
%
%% Stuff on top
%\geoword{ 0   }{ 0   }{ 2   }{ 1   }{ 1.25}{ 2.5 }
%\geoword{ 2.5 }{ 1.25}{ 1   }{ 0   }{ 0.5 }{ 1   }
%\geoword{ 6   }{ 0   }{-2   }{ 1   }{ 1.25}{ 2.5 }
%
%% Points
%\put(0,0){\circle*{0.05}}
%\put(1,0){\circle*{0.05}}
%\put(3.5,0){\circle*{0.05}}
%\put(6,0){\circle*{0.05}}
%\put(3,-1){\circle*{0.05}}
%\put(4,-1){\circle*{0.05}}
%\put(2.5,1.25){\circle*{0.05}}
%\put(3.5,1.25){\circle*{0.05}}
%
%% Labels
%\put(2.5,1.3){\makebox(1,1)[b]{$a_i''$}}
%\put(3,1.3){\makebox(1,1)[b]{$p''$}}
%\put(3,-0.95){\makebox(1,1)[b]{$a_k''$}}
%\put(3.5,-0.95){\makebox(1,1)[b]{$p'$}}
%\put(1,0.05){\makebox(5,1)[b]{$a_k$}}
%\put(0,-0.2){\makebox(1,1)[b]{$a_i$}}
%\put(1,-0.2){\makebox(5,1)[b]{$p$}}
%\put(1.0,0.73){\makebox(0.5,1)[b]{$c$}}
%\put(4.5,0.73){\makebox(0.5,1)[b]{$c$}}
%\put(1.8,-0.75){\makebox(0.5,1)[b]{$g$}}
%\put(4.8,-0.75){\makebox(0.5,1)[b]{$g$}}
%\end{picture}

Using Lemma \ref{lemma:triangle}, it should be clear using the triangle with corners $C$, $D$ and $p'$, (hence sides $a_k'$, $g$ and $g a_k''$) along with the fact that $2|g| \le |a_k'|$ that:

\begin{eqnarray*}
d(p, p') & \le & \frac{2(|g| + |a_k''|) - |a_k'| + 1}{2} + \delta \\
         & \le & |a_k''| + \delta + \frac{1}{2} \\
         & \le & 2L + \delta + \frac{1}{2}
\end{eqnarray*}

Similarly, with the triangle with corners $C$, $D$ and $p''$ (hence sides $a_k'$, $g_2 := (a_i' a_k')_L$ and $a_i'^{-1} g_2 a_i''$) and using $2|g_2| \le |a_k'| + |a_i'|$ we know:

\begin{eqnarray*}
d(p, p'') & \le & \frac{2(|g_2| + |a_i''| + |a_i'|) - |a_k'| + 1}{2} + \delta \\
          & \le & |a_i''| + \frac{3}{2}|a_i'|+ \delta + \frac{1}{2} \\
          & \le & 2L + \delta + \frac{1 + 3K_{i,k-1}}{2}
\end{eqnarray*}

So:

\[ d(p'', p') \le 4L + 2\delta + 1 + \frac{3}{2}K_{i,k-1} \]

Now it's clear that we have $(a_i \ldots a_k)^{cg} = (a_i'a_k')^g = ((a_i'a_k')^{g_2})^{g_2^{-1} g} = a_i''^{g_2^{-1} g}$. This has short lex length less than or equal to:

\begin{eqnarray*}
&     & 2|g_2^{-1}g| + |a_i''| \\
&  =  & 2d(p'', p') + |a_i''| \\
& \le & 2(4L + 2\delta + 1 + \frac{3}{2}K_{i,k-1}) + |a_i''| \\
& \le & 10L + 4\delta + 2 + 3K_{i,k-1}
\end{eqnarray*}

Since exactly the same argument works for any $i \le k - 1$, defining this as $K_{i,k}$ and letting $K_{k,k} := 2L$, we have the required constants.

Therefore, since step \ref{step:extend_c} clearly takes time $O(\mu_k)$, the $k = i$ loop is completed in time $O(i\mu_i)$, and we take time $O(i^2\mu_i)$ to reach step \ref{step:short_end} with $k = i$. Hence the algorithm terminates in time $O(n^2\mu_n)$.

We can easily get a bound on the constants $K_{i,k}$ as in the proposition statement using some simple combinatorics and noting that $K_{i,i} = 2L$ for any $i$:

\begin{eqnarray*}
K_{i,n}
& = & 10L + 4\delta + 2 + 3K_{i,k-1} \\
& = & \sum_{j=0}^{n - i - 1} 3^j(10L + 4\delta + 2) + 3^{k-i-1} . 2L \\
& = & (10L + 4\delta + 2)(3^{k-i} - 1) + 3^{k-i-1} . 2L \\
& \le & (12L + 4\delta + 2)3^{k-i}
\end{eqnarray*}
\end{proof}

By Lemma \ref{lemma:replace}, the conjugacy problem remains unchanged between studying the lists $(a_1, \ldots, a_n)$ and $(b_1, \ldots, b_n)$, and the lists $(a_1 \ldots a_n, a_2 \ldots a_n, \ldots, a_n)$ and $(b_1 \ldots b_n, b_2 \ldots b_n, \ldots, b_n)$. Hence by precomputing the conjugacy problem between all short lists (in the sense that the $k$th element has length less than or equal to $(12L + 4\delta + 2)3^{n-k}$), we can solve the conjugacy problem for lists by applying the above result and then either using the algorithm which requires one infinite order element, or our precomputed results for short lists.

Of course, the input lists may be arbitrarily long. However, the following result is given in \cite{quadratic}:

\begin{proposition}
\label{proposition:small_cent}
Let $[a_1, \ldots, a_m]$ be a list of $m$ pairwise distinct, nontrivial elements of finite order in $G$. Suppose that $x \in G$ satisfies \[ |x|_G \ge (2k + 5)^{4\delta+2}(\mu + 2\delta) \] where $\mu = \max\{|a_1|_G, |a_1^x|_G, \ldots, |a_m|_G, |a_m^x|_G\}$ and $k$ is the number of generators of $G$. Then \[ m \le (2k)^{8\delta} \].
\end{proposition}

The following is a simple corollary:

\begin{corollary}
The centraliser of a list of strictly more than $Q^2$ pairwise distinct finite order elements is finite.
\end{corollary}

\begin{proof}
Suppose $[a_1, \ldots, a_m]$ is such a list. If $x$ is in the centraliser, $a_i^x = a_i$ for all $1 \le i \le m$, so in Proposition \ref{proposition:small_cent} we have that $\mu$ is just the maximum length of the $a_i$. But then $|x|_G$ is bounded above, so in particular there can only be a finite number of such $x$, and the centraliser is finite.
\end{proof}

In particular, this implies that the centraliser of a list of $(2k)^{8\delta}$ distinct finite order elements is finite. Finite subgroups of $\delta$-hyperbolic groups can be conjugated into balls of size $2\delta$, hence the number of elements in such a group is bounded by a constant depending only on the group. Thus we can use a method similar to lists of infinite order elements to finish off the solution.

Here is a complete description of the algorithm, given the input of two lists $A$ and $B$ of words in the generators of $G$, assuming both lists have $m$ elements, and conjugacy between all lists of words $(a_1, \ldots, a_n)$ for which $|a_i| \le (12L + 4\delta + 2)3^{n-i}$ ($n = (2k)^{8\delta}$) has been computed using the exponential algorithm given in \cite{quadratic}, and their centralisers using the algorithm in \cite{rational}. Note that if $m < n$ in Step \ref{step:precomputed}, we can extend the lists $A$ and $B$ to length $n$ without increasing $\mu$ by simply adding several copies of the identity element onto the ends of both lists.

\begin{enumerate}
\item Reduce all words in both lists to geodesics using $\slex$.
\item Apply Algorithm \ref{algorithm:shorten_list} to $A$ to get a conjugating element $c$ or infinite order element $g$ (note that we need only apply this to the first $n$ elements).
\item If the above step gave an infinite order element $g = a_i \ldots a_j$, then replace $A$ with $[a_i \ldots a_j, a_1, \ldots, a_{i-1}, a_{i+1}, \ldots, a_m]$ and similar for $B$, then go to \ref{step:inf}. Note that if all the elements are short there may still be an infinite order element.
\item Apply Algorithm \ref{algorithm:shorten_list} to $B$ to get a conjugating element $c'$ or infinite order element $g$ (note that again, we only need shorten the first $n$ elements).
\item If the above step gave an infinite order element $g = b_i \ldots b_j$, then replace $A$ with $[b_i \ldots b_j, b_1, \ldots, b_{i-1}, b_{i+1}, \ldots, b_m]$ and similar for $B$ (ie. the lists should now be swapped), then go to \ref{step:inf}.
\item Otherwise, replace $A$ with $[a_1 \ldots a_m, a_2 \ldots a_m, \ldots, a_m]^c$ and replace $B$ with $[b_1 \ldots b_m, b_2 \ldots b_m, \ldots, b_m]^{c'}$.
\item \label{step:precomputed} Now test conjugacy of the first $n$ elements of $A$ and $B$ using the precomputed list. If a conjugating element is not found, the lists cannot be conjugate, so we can stop. If there is a conjugating element $g$, and $m \le n$, return $cgc'^{-1}$ and stop.
\item Let $C$ be the precomputed centraliser of $A$. For each element $z \in C$, check if $A^{zg} = B$. If it does, return $czgc'{-1}$ and stop. If no $z$ works, the lists are not conjugate, so we can stop.
\item \label{step:inf} Test conjugacy of $a_1$ and $b_1$ using the method in \cite{linear} to find a conjugating element $h$. If this does not exist, the lists are not conjugate, so stop.
\item Use Proposition \ref{prop:find_straight_centraliser} to express some superset of the centraliser of $a_1$ using a set $S$, a straight word $c$ and some element $p$.
\item Apply Proposition \ref{prop:shape} to $a_i^p$ and $c$ for each $1 \le i \le m$.
\item For each $s \in S$, apply Proposition \ref{prop:shape} to $b_i^{h^{-1}s^{-1}}$ and $c$.
\item If any $i$ results in different cases for $b_i^{h^{-1}s^{-1}}$ and $a_i^p$, move onto the next $s$.
\item If any $i$ results in case $1$ for both $b_i^{h^{-1}s^{-1}}$ and $a_i^p$, use the bounds as given after Proposition \ref{prop:shape} to test a bounded range of conjugates for equality.
\item Otherwise, test the conjugacy using the bounded length search, as outlined after Proposition \ref{prop:shape}.
\item If any of the previous two steps result in a conjugating element $pc^ksh$, return it and stop. If there is no conjugating element found for any $s$, the lists are not conjugate, so stop.
\end{enumerate}

Clearly this algorithm runs in time $O(m^2\mu)$. If we know $a_1$ is of infinite order, we can start at step \ref{step:inf} to get an algorithm that runs in time $O(m\mu)$ and does not require any precomputation dependent on $n$.

\section{Computation of Centralisers}

Because of the potentially exhaustive nature of the algorithm above, it already provides enough information to give generators for the centraliser of any input list whose first element is of infinite order: If one sets $A = B$, the algorithm will find conjugating elements only when that element is in the centraliser of $A$.

On the other hand, since the generators of centralisers of lists are certainly computable by the algorithm discussed in \cite{rational}, we can add to the precomputation stage the centralisers of all lists of short elements as before.

Here is a complete description of the centraliser algorithm with input list $A$, assuming $A$ has $m \le Q^2$ elements, and the precomputation outlined in the previous section has been performed: 

\begin{enumerate}
\item Reduce all words in $A$ to geodesics using $\slex$.
\item Apply Algorithm \ref{algorithm:shorten_list} to $A$ to get a conjugating element $c$ or inifinite order element $g$.
\item If the above step gave an infinite order element $g = a_i \ldots a_j$, then replace $A$ with $[a_i \ldots a_j, a_1, \ldots, a_{i-1}, a_{i+1}, \ldots, a_m]$ and go to \ref{step:inf2}.
\item Otherwise, replace $A$ with $[a_1 \ldots a_m, a_2 \ldots a_m, \ldots, a_m]^c$ and let $C$ be the precomputed centraliser of $A$. If $m \le Q^2$, return $C$. Else, return the set of elements of $c \in C$ for which $A^c = A$. In either case, we can stop.
\item \label{step:inf2} Use Proposition \ref{prop:find_straight_centraliser} to express some superset of the centraliser of $a_1$ using a set $S$, a straight word $c$ and some element $p$.
\item Apply Proposition \ref{prop:shape} to $a_i^p$ and $c$ for each $1 \le i \le m$.
\item For each $s \in S$, apply Proposition \ref{prop:shape} to $a_i^{s^{-1}}$ and $c$.
\item If any $i$ results in different cases for $a_i^{s^{-1}}$ and $a_i^p$, move onto the next $s$.
\item \label{step:cent_bdd} If any $i$ results in case $1$ for both $a_i^{s^{-1}}$ and $a_i^p$, use the bounds as given after Proposition \ref{prop:shape} to test a bounded range of conjugating elements. Add any element found to be in the centraliser to $C$.
\item \label{step:cent_unbdd} Otherwise, check if $a_i^p$ in the bounded length search, as outlined after Proposition \ref{prop:shape}. Add $pc^ks$ to $C$ whenever $a_i^{pc^ks} = a_i$ for all $1 \le i \le m$. Also, if this case ever occurs, add $pc^{\lcm\{l_1, \dots, l_m\}}p^{-1}$ to $C$.
\item Once all elements of $S$ have been tested, return $C$ and stop.
\end{enumerate}

$C$ must now be a complete generating set for the centraliser of $A$. To see this, suppose $g \in C_G(A)$. Then $g = pc^ks$ for some $k \in \mathbb{Z}$ and $s \in S$. If $s$ would result in case 1 for any $a_i$, it would have been added to $C$ in step \ref{step:cent_bdd}. Otherwise, let $L := \lcm\{l_1, \ldots, l_m\}$, and let $k = sL + r$ for some $s, r \in \mathbb{Z}$ such that $0 \le r < L$. Then $pc^Lp^{-1}$ is in $C$, as is $pc^rs$ since both are added in step \ref{step:cent_unbdd} - hence $g$ is a multiple of elements of $C$.

Again, if one knows $a_1$ is of infinite order, one can start from \ref{step:inf2}; the algorithm will run in time $O(m\mu)$ and requires no precomputation dependent on $n$. If not, the running time will be in $O(m^2\mu)$.

\chapter{Quasiconvex Subgroups}

\section{Introduction}

This note is largely based on work by Foord in his PhD thesis. In it, some interesting properties of coset Cayley graphs are discussed, relating to the properties as one moves further from the group in question. In fact, the constructions take place inside something more general than Cayley graphs; we will use the term ``Cayley-like'' here:

\begin{definition}
Suppose $\Gamma$ is a labelled directed graph labelled by words in some set $X$, and given the path metric. Then $\Gamma$ is \textbf{Cayley-like} if, for each vertex $p \in \Gamma$ and each $x \in X$, there are edges $e$ and $e'$ labelled by $x$, so that $e$ starts at $p$ and $e'$ terminates at $p$.
\end{definition}

We construct the coset Cayley graph by taking the vertex set to be $\{ Hg : g \in G \}$ (ie. the set of right cosets of $H$), and place a directed edge with label $x \in X$ from each $Hg$ to $Hgx$. Clearly this is Cayley-like, as are ordinary Cayley graphs.

We can define a concept of isomorphism in these graphs:

\begin{definition}
\label{def:isomorphic}
Suppose $\Gamma_1'$ and $\Gamma_2'$ are subgraphs of Cayley-like graphs $\Gamma_1$ and $\Gamma_2$ respectively that both have the same alphabet, and that $p \in \Gamma_1'$ and $q \in \Gamma_2'$ are vertices. We construct a partial map $\tau_{p,q} : \Gamma_1' \to \Gamma_2'$ as follows:

Given a word $w$ in the alphabet of $\Gamma_1$, let $\tau'(w)$ be the vertex in $\Gamma_2$ reached by following the path starting from $q$ and labelled by $w$. Given $x \in \Gamma_1'$, if we have $\tau'(w) = \tau'(u) \in \Gamma_2'$ for all words $w$ and $u$ labelling paths from $p$ to $x$ which lie entirely inside $\Gamma_1'$, let $\tau_{p,q}(x) = \tau'(w)$. If $\tau_{p,q}(x)$ is defined for all vertices in $\Gamma_1'$ and we can perform the same construction when exchanging $\Gamma_1'$ and $\Gamma_2'$, we say $\Gamma_1'$ and $\Gamma_2'$ are isomorphic about $p$ and $q$.

For a vertex $p \in \Gamma_1$ we define the ball $k$-ball about $p$ in $\Gamma_1$, or $B^{\Gamma_1}_k(p)$, to be the subgraph of $\Gamma_1$ containing all points $v$ such that $d(v, p) \le k + \frac{1}{2}$. That is, the set which contains all vertices within $k$ of $p$, all edges connecting two vertices in the set and additionally half of any edge connecting a vertex in the set to one outside. We will omit the superscript if the graph is clear (which is generally the case). If $q$ is a vertex in $\Gamma_2$, we say the balls $B^{\Gamma_1}_k(p)$ and $B^{\Gamma_2}_k(q)$ are isomorphic if they are isomorphic about $p$ and $q$.
\end{definition}

If a word labels a geodesic path starting at some $p$ in a Cayley-like graph $\Gamma$, we say it is a $\Gamma$-geodesic word at $p$. If it labels a geodesic regardless of starting point, we simply say that it is a $\Gamma$-geodesic word. 

With Cayley graphs there is a natural base point of the identity element, and with coset Cayley graphs the natural base point is the subgroup in question. This allows us to make the following definitions:

\begin{definition}
Suppose that $\Gamma$ is a Cayley-like graph with base point $b$. Then for non-negative $k \in \mathbb{Z}$ we say:

$\Gamma$ has \textbf{IB($k$)} if there exists some $K$ such that if $p, q \in \Gamma$ are vertices with $d(b, p) \ge K$ and $d(b, q) \ge K$ then $B_k(p)$ and $B_k(q)$ are isomorphic.

Suppose $G$ is some finitely generated group with the same alphabet as $\Gamma$ and Cayley graph $\Gamma_G$. Then $\Gamma$ has \textbf{GIB($k$)} if there exists some $K$ such that if $p \in \Gamma$ is a vertex with $d(b, p) \ge K$, then $B^\Gamma_k(p)$ and $B^{\Gamma_G}_k(1)$ are isomorphic.
\end{definition}

These properties can be regarded to be some indication that the space made up by the coset Cayley graph is ``mostly homogeneous.'' Where the presentation is understood, we will refer to a subgroup of a hyperbolic group as having IB($k$) or GIB($k$) if its associated coset Cayley graph does.

In his thesis, Foord proves that a quasiconvex subgroup $H$ of a hyperbolic group $G$ has GIB($k$) for all non-negative $k \in \mathbb{Z}$ (Foord refers to this as GIB($\infty$)) if and only if the index $|C_G(h) : C_G(h) \cap H|$ is finite for any $h \in H$. In particular, this is true of any torsion free quasiconvex subgroup. However, no bounds on the constants involved are given, and the notions are only explored as far as is required to show some growth properties. It is the aim of this note to further expand this work.

We will suppose throughout this chapter that the ambient group and presentation $G = <\!\!X|R\!\!>$ has been picked, and its Cayley graph $\Gamma$ is $\delta$-hyperbolic.

General subgroups of hyperbolic groups are not necessarily well behaved, or even finitely presented. For this reason, we restrict our attention to a particular class of subgroups.

\begin{defn}
A subgroup $H$ of $G$ is $\epsilon$-quasiconvex if, for each $w \in H$ labelling a geodesic in $\Gamma$, and for each $0 \le i \le |w|$ there exists an $h \in H$ and a word $a$ with $|a| \le \epsilon$ such that $w(i) =_G ha$.
\end{defn}

We will suppose that some subgroup $H$ with coset Cayley graph $\Gamma'$ has been picked, and that $H$ is $\epsilon$-quasiconvex.

\section{A Tighter Bound on the Thinness of Triangles}

In this section, we make only the assumptions as noted in the introduction, that $\Gamma$ and $\Gamma'$ are the Cayley and coset Cayley graphs of $G$ and $H$ in $G$ respectively, and that $H$ is $\epsilon$-quasiconvex. It is our aim to show that there is a bound, linear in $\epsilon$, on the thinness of triangles residing in $\Gamma'$.

\begin{lemma}
\label{lemma:conj_quadrilateral}
Suppose that $u$ is a $\Gamma$-geodesic word, that $w$ is a $\Gamma'$-geodesic  word at $H$ and that $u$ labels a loop at $Hw$. Then there exists a $\Gamma$-geodesic word $v \in H$ such that $wvw^{-1} =_G u$ and either

\begin{itemize}
\item $|v| \le |u| - 2|w| + 6\delta + 4\epsilon$, $|v| \le |u| + 3\delta + 2\epsilon$ and $2|w| \le |u| + 3\delta + 2\epsilon$ or
\item $|v| \le 3\delta + 2\epsilon$ and $|u| \le 2\delta$ or
\item $|v| \le 3\delta + 2\epsilon$ and letting $i = \floor{\frac{|u|}{2}} - \delta$, there is a word $u'$ with $|u'| \le 5\delta + 1$ such that $u =_G w(-i)u'(w(-i))^{-1}$
\end{itemize}

Moreover, if $2|w| > |u| + 3\delta + 2\epsilon$, so that in particular we are not in the first case, then the quadrilateral in $\Gamma$ constructed using the above words and split into two triangles (in either of the two possible ways) will have the meeting point on the side labelled $u$ within $\delta$ of the midpoint of that side.
\end{lemma}

\begin{proof}
If $u$ labels a loop at $Hw$, then $Hwu = Hw$, so the path $wuw^{-1}$ must label a loop at $H$ and we have $wuw^{-1} \in H$. Let $v$ be any $\Gamma$-geodesic for $wuw^{-1}$ and form a geodesic quadrilateral in $\Gamma$ with sides $v$, $w_1$ (labelled $w$ and connecting the points $v$ and $vw$), $u$ and $w_2$ (labelled $w$ and connecting the points $1$ and $w$) and corners $A := 1$, $B := v$, $C := vw$ and $D := w$. Pick some geodesic $t$ connecting $A$ to $C$, and we have divided the quadrilateral into 2 geodesic triangles.

Suppose that $y$ is on $w_1$ and corresponds to some point $y'$ on $v$. There exists some $h \in H$ such that $d(y', h) \le \epsilon$, so we must have $d(v, y) = d(y, H) \le \delta + \epsilon$ since $w$ is a $\Gamma'$-geodesic at $H$. Therefore the meeting point on $w_1$ must lie at most $\delta + \epsilon$ from $B$. Similarly, if $y$ is on $w_2$ and correpsonds to some point on $v$, the distance from $y$ to $A$ must be less than or equal to $2\delta + \epsilon$.

For the first case, suppose some point on $u$ $2$-corresponds to a point on $v$. Then all points on $w_1$ must chain-correspond to points not on $w_2$ and vice-versa, so if $n$ and $m$ are the distances from $A$ and $B$ to the meeting points on $w_2$ and $w_1$ respectively we find

\begin{eqnarray*}
|v| & = & (|u| - (|w| - n) - (|w| - m)) + n + m \\
    & = & |u| - 2|w| + 2n + 2m.
\end{eqnarray*}

We know that $2|w| \ge n + m \le 3\delta + 2\epsilon$, so we can derive $|v| \le |u| - 2|w| + 6\delta + 4\epsilon$ and $|v| \le |u| + 3\delta + 2\epsilon$. Similarly, $|v| \ge n + m$ so we obtain 

\begin{eqnarray*}
2|w| & = & |u| - |v| + 2n + 2m \\
     & \le & |u| + 3\delta + \epsilon.
\end{eqnarray*}

All inequalities for the first case have now been shown to be satistied.

Now suppose that at most one point on $v$ chain-corresponds to a point on $u$. Clearly all points on $v$ must now chain-correspond to points on $w_1$ or $w_2$ so we have $|v| \le 2\epsilon + 3\delta$ as required by the second two cases.

Suppose that $|u| > 2\delta$. Note that there is at least one point $p$ on $w_1$ corresponds to a point $p'$ on $t$ which corresponds to a point $q$ on $w_2$. For any such points, we must have $d(B, p) - 2\delta \le d(A, q) \le d(B, p) + 2\delta$, otherwise we can find a path from $A$ to $p$ or from $h$ to $q$ which is shorter than the path following $w$. This contradicts the fact that $w$ labels a geodesic in $\Gamma'$. We can use the sets of corresponding points to show that

% Note that |t| \ge |w| - does this offer an improvement?

\begin{eqnarray*}
||t| - |w|| &  =  & |d(A, q) - |w| + |t| - d(A, q)| \\
            &  =  & |d(A, q) - |w| + d(C, p')| \\
            &  =  & |d(A, q) - |w| + d(C, p)| \\
            &  =  & |d(A, q) - d(B, p)| \\
            & \le & 2\delta
\end{eqnarray*} so $|t| \le |w| + 2\delta$. Now we find that the meeting point $m$ on $u$ must have

\begin{eqnarray*}
d(D, m) &  =  & \frac{|u| + |t| - |w|}{2} \\
        & \le & \frac{|u|}{2} + \delta
\end{eqnarray*} and similarly $d(C, m) \le \frac{|u|}{2} + \delta$.

Let $a$ on $w_1$ and $b$ on $w_2$ be the vertices at distance $i = \floor{\frac{|u|}{2}} - \delta$ from $C$ and $D$ respectively, so that they chain-correspond to points on $u$ at most $2\delta + 1$ apart. We can see now that $d(a, b) \le 5\delta + 1$ and letting $u'$ be a word labelling a path between $a$ and $b$, we have $u_G = w(-i)u'w^{-1}(i)$ as required.

For the last part, note that if $|u| \le 2\delta$ then the result is clear since all points on $u$ are within $\delta$ of its midpoint. If not, and we have divided the quadrilateral as suggested above, we are done. If the triangle is divided in the other way, we can repeat the above construction with $u^{-1}$ and $v^{-1}$ (thus swapping $A$ and $D$ with $B$ and $C$) to complete the proof.
\end{proof}

Foord proves that the coset Cayley graph of a $\epsilon$-quasiconvex subgroup of a hyperbolic group is hyperbolic, and that the slim triangles constant is at worst exponential in $\epsilon$. We demonstrate here that one can reduce this bound to linear. The result is stated in terms of having slim triangles (which implies having thin triangles), but of course it's possible to improve the bound on the thin triangles constant by direct, but more involved, proof.

\begin{proposition}
All geodesic triangles in $\Gamma'$ whose corners lie on vertices are $10\delta+\epsilon$-slim.

If such a triangle in $\Gamma'$ has side lengths adding up to $n \in \mathbb{N}$, and at least two corners are at distance greater than $\frac{n}{2} + 3\delta + \epsilon$ from $H$, then the triangle is $6\delta$-slim.
\end{proposition}

\begin{figure}
\begin{center}
\input coset_thin_general2.pstex_t
\caption{Dividing up the hexagon}
\label{figure:coset_thin_general}
\end{center}
\end{figure}

\begin{proof}
Suppose we are given a geodesic triangle in $\Gamma'$ with corners $A'$, $B'$ and $C'$ all lying on vertices and side labels $a$ from $A'$ to $B'$, $b$ from $B'$ to $C'$ and $c$ from $C'$ to $A'$. Suppose that we are given some point $Hp'$ on the side labelled by $a$ (for points elsewhere on the triangle, we can just relabel appropriately). Our aim is to find a bound on the minimum distance between $p'$ and and some point on the other two sides.

Pick a geodesic path from $H$ to $A'$, and let $w$ be its label. It's clear that $Hwabcw^{-1} = H$, hence we can pick some $h \in H$ so that $wabcw^{-1} =_G h$. Let $d$ be a geodesic path from $1$ to $h$ in $\Gamma$. Then, since any geodesic word based at a point in $\Gamma'$ is a geodesic in $\Gamma$ based at any point, we have a geodesic hexagon in $\Gamma$.

Label the corners of this hexagon by $A := w$, $B := wa$, $C := wab$, $D := wabc =_G h^{-1}w$, $E := h^{-1}$, and $F := 1$. We will refer to the sides by their labels, with $w_1$ referring to the side connecting $E$ to $D$ and $w_2$ referring to the remaining side labelled $w$. Divide the hexagon into 4 triangles by picking geodesic paths with labels $e$ from $E$ to $A$, $f$ from $A$ to $D$ and $g$ from $D$ to $B$.

Having constructed this triangle, we let $p$ be the point on the side labelled $a$ such that $Hp = Hp'$ (that is, it lies at the same distance along its respective side in $\Gamma$ as $x'$ did in $\Gamma'$).

We now branch into a number of cases, based on which side of the hexagon $p$ chain-corresponds to. We can first eliminate the side $w_1$ as follows:

Let $m_{fE}$ be the meeting point on $f$ resulting from the triangle connecting $A$, $D$ and $E$, and let $m_{fB}$ be the other meeting point. Note that \[ |e| = |hw|_\Gamma \ge d(H, Hhw) = d(H, Hw) = |w|, \] and similarly \[ |g| = d(D, B) = d(wabc, wa) \ge d(Hwabc, Hwa) = d(Hw, Hwa) = |a|. \]

Now we have

\begin{eqnarray*}
d(A, m_{fE}) &  =  & \frac{d(A, D) + d(A, E) - d(D, E)}{2} \\
             & \ge & \frac{d(A, D)}{2}
\end{eqnarray*} and

\begin{eqnarray*}
d(A, m_{fB}) &  =  & \frac{d(A, D) + d(A, B) - d(B, D)}{2} \\
             & \le & \frac{d(A, D)}{2},
\end{eqnarray*} so if $x$ $2$-corresponds to a point on $w_1$ it also $3$-corresponds to a point on either $d$ or $w_2$.

We then need only consider the cases where $p$ chain-corresponds to a point on the remaining 4 sides. When treating these cases, we note that each case occurs only for one continuous section of points on $a$. As we run from the corner $B$ to $A$, we get to cases 1, 2, 3, 4 and 5 (assuming any points exist in each) in order.

Case 1: Suppose $p$ $2$-corresponds to a point on $b$ or $c$ as in the left of Figure \ref{figure:coset_thin_case_1}. Then clearly $p'$ is within $2\delta$ of a point on $b'$ or $c'$ as required.

Case 2: Suppose $p$ $3$-corresponds to some point $q$ on $d$ as in the right of \ref{figure:coset_thin_case_1}. Then $d(Hp', H) = d(Hp, H) \le 3\delta + \epsilon$, since $d$ is a $\Gamma'$-geodesic word at $H$, which is $\epsilon$-quasiconvex. We will treat this case further later.

\begin{figure}
\begin{center}
\input coset_thin_case_1.pstex_t
\caption{Cases 1 and 2}
\label{figure:coset_thin_case_12}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
\input coset_thin_case_345.pstex_t
\caption{Cases 3, 4 and 5}
\label{figure:coset_thin_case_345}
\end{center}
\end{figure}

It remains to cover those $p$ which $3$-correspond to some point $q$ on $w_2$ as in the top left of Figure \ref{figure:coset_thin_case_345}. We find that since $Hhw = Hw$ there is some point $r$ on $w_1$ such that, when $q$ and $r$ are viewed as group elements, we have $Hq = Hr$. Since $w$ labels a geodesic in $\Gamma'$, we have $d(F, q) = d(E, r)$. We branch into further cases depending on which side $r$ chain-corresponds to (note that it cannot chain-correspond to a point on $a$, since by previous arguments points on $a$ cannot chain-correspond to points on $w_1$).

Case 3: Suppose $r$ $2$-corresponds to a point on $d$ as in the top right of Figure \ref{figure:coset_thin_case_345}. Then similarly to Case 2, we find $d(Hp', H) \le 5\delta + \epsilon$.

Case 4: Suppose $r$ $2$-corresponds to a point $s$ on $w_2$ as in the bottom left of Figure \ref{figure:coset_thin_case_345}. Let $m_e$ be the meeting point on $e$ made by the triangle with corners $A$, $D$ and $E$. Because $w$ is a $\Gamma'$-geodesic word at $H$, $d(q, s) = d(Hq, Hs) \le d(Hq, Hr) + d(Hr, Hs) \le 0 + 2\delta$, and we have $d(A, q) \le d(A, m_e) \le d(A, s) \le d(A, q) + 2\delta$. There is then a $2\delta$ long segment of $w_2$ in which $q$ can reside, so the distance between any two points $p$ lying in this case is at most $2\delta$. We treat this case, along with Cases 2 and 3 after Case 5.

Case 5: Suppose $r$ $3$-corresponds to a point $s$ on $b$ or $c$ as in the bottom right of Figure \ref{figure:coset_thin_case_345}. Then $Hs$ lies on a different side of the triangle to $Hp'$, and $d(Hp', Hs) \le 6\delta$ which is within the state bound.

The maximum distance between two points $p$ lying in Cases 2, 3 or 4 is $2(5\delta + \epsilon) + 2\delta = 12\delta + 2\epsilon$, so if $p$ lies in one of these cases, it is within $8\delta + \epsilon$ of a point $t$ in Case 1 (so that $Ht$ lies within $2\delta$ of some point on another side of the triangle), or within $4\delta + \epsilon$ of a point $t$ in Case 5 (so that $Ht$ is within $6\delta$ of some point on another side of the triangle). In either case, $Hp'$ lies within $10\delta + \epsilon$ of a point on $b$ or $c$, and we are done.

For the second part of the statement, note that we can always relabel our corners to ensure that $|w| > \frac{n}{2} + 3\delta + \epsilon$ since the side containing $x'$ is connected to two out of the three corners. In particular, the final part of Lemma \ref{lemma:conj_quadrilateral} will apply, so points on $w_i$ chain-corresponding to points on $f$ must lie within $\frac{|f|}{2} + \delta \le \frac{n}{2} + \delta $ of their respective ends of $f$.

In fact, since we saw in the lemma that the meeting points on $w_1$ and $w_2$ must be within $2\delta + \epsilon$ and $\delta + \epsilon$ of $E$ and $F$ respectively, we find all points on $f$ must be intermediate points from points on $a$ in Case 5 (or an analogue with $p$ on $b$ or $c$). Since Cases 2, 3 and 4 all require intermediate points on $f$, there can be no point on $a$ which is not in either Case 1 or Case 5. Thus the triangle is $6\delta$-slim.
\end{proof}

It's a simple technical task to show that this in turn implies that all geodesic triangles are $20\delta + 2\epsilon$-slim, and it is known (for instance, by \cite{6author}) that if triangles in a metric space are $\Delta$-slim, they are $6\Delta$-thin, so triangles in $\Gamma'$ are $60\delta + 6\epsilon$-thin, and triangles which lie a relatively large distance from $H$ are simply $36\delta$-thin.

This is the first hint that there is some ball about $H$ where much of the interesting behaviour occurs.

\section{A Linear Bound on the GIB($k$) Constant for Torsion Free Subgroups}

For torsion free subgroups, Foord demonstrates the GIB($k$) property for any $k$ for a specific class of subgroups, however he gives no bound on the value of the constant associated to it. It is the aim of this section to demonstrate that for torsion-free subgroups, such a bound exists and is in $O(k\epsilon)$. The argument specific to torsion free subgroups is again largely based on the argument given in Foord's thesis, with some observations on the specific class of groups giving us the eventual bound.

We first note the following result from Foord's thesis for which only a sketch proof is provided here:

\begin{proposition}
\label{prop:loop_in_ball}
Suppose $x$ and $y$ are vertices in some Cayley-like graph $\Gamma$. If for some non-negative integer $k$ the balls $B_k(x)$ and $B_k(y)$ are not isomorphic, then there is some word $w$ of length at most $2k+1$ which labels a loop based at the centre of one ball but a path which is not a loop based at the centre of the other.
\end{proposition}

\begin{proof}
If the balls are not isomorphic, then the construction in Definition \ref{def:isomorphic} must not be possible. One can break down the possibilities into cases and construct a word as required in each case. For example, suppose the construction given does not give an injective function. Find two points in $B_k(x)$ which are mapped to the same points in $B_k(y)$. Pick shortest words $u$ and $v$ labelling paths to these points, and $uv^{-1}$ is a word of length at most $2k$ which labels a loop at $x$ but not at $y$.
\end{proof}

\begin{proposition}
\label{prop:small_ib_implies_ib}
If $H$ has IB($\frac{5}{2}\delta$) with constant $K$ then it has IB($k$) for $k \ge \frac{5}{2}\delta$ with constant $\max\{K + k - \delta + 1, \epsilon + \frac{3\delta + 2k + 1}{2}\}$.

If $H$ has GIB($\frac{5}{2}\delta$) with constant $K'$ then it has GIB($k$) for $k \ge \frac{5}{2}\delta$ with constant $\max\{K' + k - \delta + 1, \epsilon + \frac{3\delta + 2k + 1}{2}\}$.
\end{proposition}

\begin{proof}
Suppose $H$ has IB($\frac{5}{2}\delta$). Suppose that $w$ and $w'$ are $\Gamma'$-geodesics words at $H$ with both words being longer than $\epsilon + \frac{3\delta + 2k + 1}{2}$, and suppose that the $k$-balls around these two points are not isomorphic.

By Proposition \ref{prop:loop_in_ball}, there is a loop of length at most $2k+1$ based at the centre of one of the balls whose label does not label a loop about the centre of the other. Suppose that this loop is present at $Hw$, and has label $u$. We can suppose that $u$ is a $\Gamma$-geodesic word, since if it isn't, we can replace it with a word which labels a geodesic between $1$ and $u$, and find that the new word has the same properties.

We have explicitly chosen the lengths of $w$ and $w'$ so that we do not lie in the first case in Lemma \ref{lemma:conj_quadrilateral}. Suppose, then, that $|u| \le 2\delta$, as in the second case of the lemma. The paths starting at $Hw$ and $Hw'$ and labelled $u$ must lie inside $B_{2\delta}(Hw)$ and $B_{2\delta}(Hw')$ respectively. Since $u$ labels a loop in one and not the other, the balls are not isomorphic so $|w| \le K$ or $|w'| \le K$, but $K \le K + k - \delta + 1$, so we are done.

The remaining case of Lemma \ref{lemma:conj_quarilateral} says that for $i = \floor{\frac{|u|}{2}} - \delta$, $u =_G w(-i)u'w^{-1}(i)$ with $|u'| \le 5\delta$. Since all group relators label loops in $\Gamma'$, $u'$ labels a loop based at $Hw(|w| - i)$ inside $B_{\frac{5}{2}\delta}(Hw(|w| - i))$ but does not label a loop based at $Hw'w(-i)$. At least one of these points must now lie within $K$ of $H$, so either $|w| = d(H, Hw(|w| - i)) + i \le K + i$ or $|w'| \le d(H, Hw'w(-i)) + i \le K + i$. Since $i \le k + 1 - \delta$, we have shown that $\Gamma'$ has IB($k$) with the required constant.

For the GIB case, the same method applies, but we can use $1$ in $\Gamma$ in place of $Hw'$.
\end{proof}

In order to find a bound on GIB($k$), we now only need to exhibit a constant for GIB($\frac{5}{2}\delta$). We do this below, after stating some results which help us get to that goal; some notation and constants are introduced in the statements which will be used from this point on. First, the following is rephrased from Proposition 2.3 in \cite{bridson_howie} (the original result is in terms of the slimness constant, which is in particular less than the thinness constant):

\begin{proposition}
\label{prop:bound_on_conjugator}
Suppose $a$ and $b$ are words which are conjugate in $G$. Let $Q$ be the number of vertices in the $4\delta$ ball in $\Gamma$. Then there exists a word $x$ such that $x^{-1}ax =_G b$, and \[ |x| \le |a| + |b| + Q + 4\delta \]
\end{proposition}

Finally, also paraphrased from \cite{holt}:

\begin{proposition}
\label{prop:sls_cent_form}
Suppose that $z$ is a short-lex straight word, and $c$ is in its centraliser in $G$. Then there exists $n \in \mathbb{Z}$, a prefix $z_1$ of $z$ and a word $y$ with $|y| \le 2\delta$ such that $c =_G z^nz_1y$.
\end{proposition}

Now we can move onto our result.

\begin{proposition}
If $H$ is any $\epsilon$-quasiconvex torsion-free subgroup of $G$, then $H$ has GIB($\frac{5}{2}\delta$) with constant $(M + MQ^2)(5\delta + 1) + 22\delta + Q + 2\epsilon$.
\end{proposition}

\begin{proof}
Suppose that $w$ is the label of a geodesic path starting at $H$, that $w$ is strictly longer than $\epsilon + 4\delta$, and that $B_{\frac{5}{2}\delta}(Hw)$ is not isomorphic to $B_{\frac{5}{2}\delta}(1)$ (in $\Gamma$).

As in the proof of Proposition \ref{prop:small_ib_implies_ib}, using Proposition \ref{prop:loop_in_ball} we find a word $u$ of length at most $5\delta + 1$ which labels a geodesic in $\Gamma$ but labels a loop at $Hg$ in $\Gamma'$. Application of Lemma \ref{lemma:conj_quadrilateral} gives us a $\Gamma$-geodesic word $v$ which represents an element of $H$, so that $wuw^{-1} =_G v$ and $|v| \le 3\delta + 2\epsilon$.

By Proposition \ref{prop:bound_on_conjugator}, there is a word $w'$ such that $w'uw'^{-1} = v$ and \begin{eqnarray*}
|w'| & \le & |u| + |v| + Q + 4\delta \\
     & \le & 3\delta + 2\epsilon + 5\delta + 1 + Q + 4\delta \\
     &  =  & Q + 12\delta + 2\epsilon + 1.
\end{eqnarray*}

Then $wuw^{-1} =_G wuw'^{-1}$, so we can let $c =_G w'^{-1}w \in C_G(u)$.

Let $u''$ be the short-lex least representative of $u$. If $|(u'')_C| \le 2L$, let $m = M$, else let $m = 1$. Let $u'$ be the short-lex least representative of $u^m$. By Proposition \ref{prop:high_power_long_conj} we have $|(u')_C| > 2L$, so by Proposition \ref{prop:short_conj} we have some $z$, $a$ and $k$ with $|a| \le 4\delta$ and $0 < k \le Q^2$ such that $z =_G ((u')_C^k)^a =_G (u'^k)^{(u')_La}$ and $z$ is short-lex straight.

Clearly since $c \in C_G(u)$ we have $c \in C_G(u^{mk})$, so there exists a $c' \in C_G(z)$ such that $c' =_G c^{(u')_La}$. By Proposition \ref{prop:sls_cent_form}, $c' =_G z^nz_1b$ for some $n \in \mathbb{N}$, $z_1$ a prefix of $z$ and $b$ a word of length at most $2\delta$, so we see \begin{eqnarray*}
c & =_G & (z^nz_1b)^{a^{-1}(u')_L^{-1}} \\
  & =_G & (z^{a^{-1}(u')_L^{-1}})^{kmn}(z_1b)^{a^{-1}(u')_L^{-1}} \\
  & =_G & u^{kmn}(u')_Laz_1ba^{-1}(u')_L^{-1}.
\end{eqnarray*} Note that $|z_1| \le |z|$, and since $z$ is straight it must be a shortest conjugate of $u^{mk}$. In particular, $|z_1| \le mk|u|$.

Since the leading word of this form of $u$ and we know $Hw'u = Hw'$, we have \begin{eqnarray*}
d(Hw'c, Hw') &  =  & d(Hw', Hw'u^{kmn}(u')_Laz_1ba^{-1}(u')_L^{-1}) \\
           &  =  & d(Hw', Hw'(u')_Laz_1ba^{-1}(u')_L^{-1}) \\
           & \le & 2|(u')_L| + 2|a| + |z_1| + |b| \\
           & \le & M|u| + 8\delta + MQ^2|u| + 2\delta \\
           &  =  & (M + MQ^2)(5\delta + 1) + 10\delta.
\end{eqnarray*}

Now since $w =_G w'c$, it is just a case of applying the triangle equality to show that \begin{eqnarray*}
d(H, Hw) &  =  & d(H, Hw'c) \\
         & \le & d(H, Hw') + d(Hw', Hw'c) \\
         & \le & (M + MQ^2)(5\delta + 1) + 22\delta + Q + 2\epsilon.
\end{eqnarray*}
\end{proof}

It is interesting to note that the factor of $\epsilon$ above does not depend on $\delta$ (although the leading constant does rather heavily).

\section{A Stronger Sense of Local Homogeneity}

In this section, we will give some results which show that not just balls but geodesics in $\Gamma'$ behave in a homogeneous way when they are relatively distant from $H$, assuming IB($\frac{5}{2}\delta$).

\begin{proposition}
Suppose $\Gamma$ is a Cayley-like graph with base point $b$ such that all geodesic triangles in $\Gamma$ are $\Delta$-thin. Suppose that $\Gamma$ has IB($\Delta+1$) with constant $K$, that $w$ labels a geodesic that lies entirely outside of $B_K(b)$, and that $\gamma$ is any other path labelled by $w$ and lying entirely outside of $B_K(b)$. Then $\gamma$ is a geodesic.
\end{proposition}

\begin{proof}
Suppose the conclusion is false, and suppose the geodesic that $w$ labels starts from $p$ and $\gamma$ starts from $q$. Let $w = w_1aw_2$, where $w_1$ is the longest subword which does label a geodesic starting at $q$, and $a$ is a word of length 1. Let $w_1'$ be a the label of a geodesic such that $qw_1' = qw_1a$, so that we must have $|w_1'| \le |w_1|$.

Then we have a geodesic triangle with corners $q$, $qw_1$ and $qw_1'$ and the obvious sides connecting them. Let $n := |w_1|$, and for $0 \le i < n$, let $p_i := qw(i)$ and $q_i := qw_1'(i)$. Let $p_n := qw_1$ and $q_n := qw_1'$. This is illustrated in Figure \ref{figure:geodesic_outside_GIB}.

\begin{figure}
\begin{center}
\input geodesic_outside_GIB.pstex_t
\caption{Geodesic triangle constructed outside of $B_{K-1}(b)$}
\label{figure:geodesic_outside_GIB}
\end{center}
\end{figure}

Now, since the triangle above is $\Delta$-thin, we can pick, for each $i$, a word $h_i$ joining $p_i$ and $q_i$ so that $|h_i| \le \Delta$. Now we find that for $0 \le i < n$, each quadrilateral with corners $p_i$, $p_{i+1}$, $q_i$, $q_{i+1}$ lies within $\Delta+1$ of $p_i$, hence it is contained inside the $\Delta+1$-ball around $qw(i)$, which is isomorphic to the $\Delta+1$-ball around $pw(i)$ (since this point is at a distance of at least $K$ from $H$).

Using a simple induction, we have $pw_1a = pw_1'$. But this is a clear contradiction, since $|w_1a| > |w_1'|$, and $w_1a$ labels a geodesic path starting at $p$. Hence no such $w_1'$ existed, and $w$ labels a geodesic starting at $q$.
\end{proof}

By substituting the point $1$ in the group Cayley graph for $q$ in the above argument, we derive the following similar result:

\begin{proposition}
\label{prop:geodesic_outside}
Suppose all triangles in $\Gamma'$ are $\Delta$-thin, and $H$ has GIB($\Delta+1$) with constant $K$ and that $w$ is a shortest word representing some group element. Then any path in $\Gamma'$ labelled by $w$ which lies outside of $B_{K-1}(H)$ is a geodesic.
\end{proposition}

We see the emergence of one ``bad'' ball, centred at $H$ in the coset Cayley graph. By the previous two sections, note that for torsion-free subgroups, $K \le K'\epsilon$, where $K'$ depends only on the group. % TODO which K, quote results showing this

It's an established result that in hyperbolic spaces, quasigeodesic paths lie close to geodesic paths, so that if $\Gamma$-geodesic words label $\Gamma'$-geodesics whenever they lie outside a certain radius, the same must be true of quasigeodesics. We show this explicitly for $L$-local $(1, k)$-quasigeodesics, using Proposition 2.3 in \cite{holt}:

\begin{proposition}
\label{prop:happy_local_qgeo}
Let $w$ be an $L$-local $(1, 2\delta)$-quasigeodesic in $\Gamma$. Let $u$ be a geodesic connecting the endpoints of $w$. Then each point on $w$ is within $4\delta$ of some vertex on $u$ and each point on $u$ is within $4\delta$ of some vertex on $w$. Furthermore, if $|w| > L$, then $|u| \ge \frac{7}{17}|w|$.
\end{proposition}

\begin{lemma}
\label{lemma:qgeodesic_outside}
Suppose $H$ has GIB($\Delta+1$) with constant $K$. If $u$ is a word which labels a $(1, k)$-quasigeodesic path in $\Gamma$ and labels a path $\gamma$ in $\Gamma'$ which lies outside of $B_{K+\frac{k}{2}+\delta-1}(H)$, then $\gamma$ is a $(1, k)$-quasigeodesic.
\end{lemma}

\begin{proof}
Let $\alpha$ be a $(1, k)$-quasigeodesic in $\Gamma$ labelled by $w$. By \cite{me} (constant hyperbolicity), $\alpha$ lies within $\frac{k}{2} + \delta$ of a geodesic $\alpha'$ with label $u'$ say.

Suppose $\gamma$ starts at $Hw$, and let $\gamma'$ be the path in $\Gamma'$ starting from $Hw$ and labelled by $u'$. Since any loop in $\Gamma$ is present at all points in $\Gamma'$, we find that $\gamma$ lies within $\frac{k}{2} + \delta$ of $\gamma'$. But then since $\gamma$ lies outside of $B_{K+\frac{k}{2}+\delta-1}(H)$, the path $\gamma'$ must lie outside of $B_{K-1}(H)$, so is a geodesic by Propositon \ref{prop:geodesic_outside}. But then $d_\gamma(Hg, Hgw) = |w| \le |w'| + k = d(Hg, Hgw') + k$, so $\gamma$ is a $(1, k)$-quasigeodesic as required.
\end{proof}

\begin{lemma}
\label{lemma:local_qgeodesic_outside}
If $u$ is a word with $|u| \ge L$ which labels an $L$-local $(1, 2\delta)$-quasigeodesic path in $\Gamma$ and labels a path $\gamma$ in $\Gamma'$ which lies outside of $B_{K+4\delta-1}(H)$, then $\gamma$ is an $L$-local $(1, 2\delta)$-quasigeodesic and a $(\frac{17}{7}, 0)$-quasigeodesic.
\end{lemma}

\begin{proof}
Firstly, each subpath of $\gamma$ of length at most $L$ is clearly a $(1, 2\delta)$-quasigeodesic, by Lemma \ref{lemma:qgeodesic_outside}, so it's clear that $\gamma$ is an $L$-local $(1, 2\delta)$-quasigeodesic.

Let $\alpha$ be an $L$-local $(1, 2\delta)$-quasigeodesic in $\Gamma$ labelled by $u$. By Proposition \ref{prop:happy_local_qgeo}, $\alpha$ is a $(\frac{17}{7}, 0)$-quasigeodesic, and if we pick $\alpha'$ (with label $u'$) to be any geodesic connecting its endpoints, all points on $\alpha$ lie within $4\delta$ of $\alpha$ and vice versa.

Suppose $\gamma$ starts at $Hw$, and let $\gamma'$ be the path with label $u'$ starting from $Hw$. Just as in Lemma \ref{lemma:qgeodesic_outside}, the above distance properties remain true between $\gamma$ and $\gamma'$.

This implies that $\gamma'$ lies entirely outside of $B_{K-1}(H)$, so is a geodesic, and thus $\gamma$ must be a $(\frac{17}{7}, 0)$-quasigeodesic.
\end{proof}

We can now prove the following statement:

\begin{corollary}
If $H$ has GIB($\frac{5}{2}\delta$), there is an algorithm which, given a word $w$ in the generators of $G$, can decide if there exists an $a \in G$ such that $a^{-1}wa \in H$ in time linear in $|w|$ (assuming a fixed subgroup and presentation).
\end{corollary}

\begin{proof}
Suppose $K$ is the constant associated to the GIB($\Delta+1$) property. Let $u$ be the short-lex least representative of $w$, so that by \ref{prop:short_conj}, either $|u_C| \le 2L$ or positive powers of $u_C$ (in particular $u_C^3$) label $L$-local $(1, 2\delta)$-quasigeodesics in $\Gamma$.

We first treat the case where $|u_C| > 2L$. If $u_C$ labels a loop $\gamma$ at $Hb$, then by Lemma \ref{lemma:local_qgeodesic_outside} if all of $\gamma$ lies outside of $B_{K + 4\delta - 1}(H)$ we have $d(Hb, Hbu_C^2) \ge \frac{7}{17}|u_C| > 0$. This clearly contradicts our assumption that $u_C$ labels a loop at $Hb$, so at some point, $\gamma$ must pass through $B_{k+4\delta-1}(H)$. Extend $\gamma$ using initial and terminal subwords of $u_C$ to a path $\gamma'$ whose endpoints lie inside this ball. Clearly the label of this path is a subword of $u_C^3$, so it still labels an $L$-local $(1, 2\delta)$-quasigeodesic in $\Gamma$.

Now let $\alpha$ be some segment of $\gamma$ which lies outside of $B_{k+4\delta-1}(H)$ except for its endpoints (so $\alpha$ is of locally maximal length.) If the length of $\alpha$ is greater than $L$, it labels a $(\frac{17}{7}, 0)$-quasigeodesic and so, since its endpoints lie at distance at most $2K + 8\delta - 2$ apart, must be of length at most $\frac{17}{7}(2K + 8\delta - 2)$. In particular, letting $N = (1 + \frac{17}{7})(K + 4\delta - 1)$, $\alpha$ lies inside of $B_N(H)$, so the same is true of all of $\gamma$.

Now, if $u_C$ conjugates into $H$, it labels a path inside $B_N(H)$. We can check for this by, for each point in this ball, simply following the path $u_C$. If $u_C$ labels a loop at $Hb$ then $Hb = Hbu_Ru_L = Hbu_L^{-1}uu_L$ and $h = bu_L^{-1}gu_Lb^{-1}$ for some $h \in H$, so we can return $u_Lb^{-1}$ as a conjugating element. If $u_C$ does not label a loop at any point, it does not conjugate into $H$, so neither does $g$. Each check can be done in time linear in $|g|_G$ and the number of checks is dependent only on the subgroup and presentation, so we have proved the statement for this case.

If $|u_C| \le 2L$ then if $u_C$ labels a loop based at $Hb$ in the coset Cayley graph, we must have $d(H, Hb) < K'$ (where $K'$ is the constant associated to GIB($2L$)). We need simply check, for every word $b$ such that $|b| < K'$ if $u_C$ labels a loop at $Hb$ and deal with the results as before. Clearly we are checking a number of points dependent only on the subgroup and presentation, and each check takes time dependent only on the subgroup and presentation, so we can complete this check in constant time, and we are done.
\end{proof}

% TODO diagram somewhere?

We can also easily show:

\begin{corollary}
If $H$ has GIB($\Delta + 1$) with constant $K$, $g, a \in G$ and $g^n \in a^{-1}Ha$, then $g^m \in a^{-1}Ha$ for some $m \le M|B_{(1 + \frac{17}{7})(K + 4\delta - 1)}(H)| + |B_{2\delta}(1)|$.
\end{corollary}

\begin{proof}
Let $w$ be the short-lex least word representing $g$. If $|w_C| > 2L$ then $w_C^i$ labels an $L$-local $(1, 2\delta)$-quasigeodesic in $\Gamma$ for any $i$. Then since $w^n$ labels a loop based at $Ha$, we find $w_C^n$ must form a loop around $Haw_L$. This loop must pass into the $K + 4\delta - 1$-ball as in the previous proof, and so we again find it must lie entirely within $B_{(1 + \frac{17}{7})(K + 4\delta - 1)}(H)$.

If $Haw_L(w_C)^i = Haw_L(w_C)^j$ for some integers such that $j > i$, we find $Hag^i = Hag^j$ and so $Ha = Hag^{j - i}$. But there can be at most $|B_{(1 + \frac{17}{7})(K + 4\delta - 1)}(H)|$ distinct values for $Haw_L(w_C)^j$, hence we are done.

Suppose then that $|w_C| \le 2L$. Then either $g$ was of finite order (in which case there is a bound of $|B_{2\delta}(1)|$ on its order), or it is of infinite order in which case by Proposition \ref{prop:high_power_long_conj}, if $u$ is the short-lex least representative of $w_C^M$, $|(u)_C| > 2L$ and we can use the above on $u$.
\end{proof}

Here it is interesting to note that the constant above is independent of $a$, thus depends only on the minimum value of the GIB constant over all subgroups conjugate to $H$.

\end{document}

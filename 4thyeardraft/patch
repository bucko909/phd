Index: 4thyeardraft.latex
===================================================================
--- 4thyeardraft.latex	(revision 51)
+++ 4thyeardraft.latex	(working copy)
@@ -7,6 +7,7 @@
 \usepackage{epsfig}
 \usepackage{algpseudocode}
 \usepackage{cite}
+\usepackage{txfonts}
 
 \newtheorem{defn}{Definition}[section]
 \newtheorem{lemma}[defn]{Lemma}
@@ -25,7 +26,7 @@
 \newcommand{\Cay}{\mathrm{Cay}}
 \newcommand{\path}[2]{[#1,#2]}
 \newcommand{\edge}[1]{#1}
-\newcommand{\vertex}[1]{\widehat{#1}}
+\newcommand{\vertex}[1]{\hat{#1}}
 \newcommand{\wordpath}[2]{\ensuremath{#1\overset{#2}{\rightarrow}}}
 \newcommand{\canonicalball}[2]{\ensuremath{\hat{B}_{#1}(#2)}}
 \newcommand{\canc}[2]{\Delta(#1,#2)}
@@ -43,7 +44,7 @@
 }
 
 \usepackage{setspace}
-\onehalfspacing
+\doublespacing
 
 \begin{document}
 
@@ -55,7 +56,7 @@
 
 \chapter{Introduction}
 
-The concept of a word-hyperbolic group was explored by Gromov \cite{gromov1987hyperbolic} where he brought much previous work in the area together using some definitions involving groups with left-invariant hyperbolic metrics, the word-hyperbolic case of which will be given later. He shows among other things that in some sense ``most'' finite presentations define word-hyperbolic groups and that certain types of small cancellation group are word-hyperbolic.
+The concept of a word-hyperbolic group was explored by Gromov in \cite{gromov1987hyperbolic} where he brought much previous work in the area together using some definitions involving groups with left-invariant hyperbolic metrics, the word-hyperbolic case of which will be given later. He shows among other things that in some sense ``most'' finite presentations define word-hyperbolic groups and that certain types of small cancellation group are word-hyperbolic.
 
 It turns out that word-hyperbolic groups admit simple solutions to the first two problems outlined by Dehn in \cite{dehn1911unendliche} for finitely presented groups $G = <\!X | R\!>$:
 
@@ -65,7 +66,7 @@
 
 In fact, there is a solution to a problem which generalises both of these in the torsion-free word-hyperbolic case, that of deciding whether a system of equations over elements in such a group admits a solution. This result is due to Sela in \cite{Z.Sela02232009}, although more general statements have since been proved.
 
-An efficient solution to the word problem due to Shapiro is given in Section \ref{section:hyperbolicity}, and a solution to the conjugacy problem is the topic of Chapter \ref{chapter:conjugacy}.
+An efficient solution to the word problem due to Shapiro is stated in Section \ref{section:hyperbolicity}, and a solution to the conjugacy problem is the topic of Chapter \ref{chapter:conjugacy}.
 
 The third problem proposed by Dehn, the \textbf{isomorphism problem} of determining whether two such groups are isomorphic has also been shown to be solvable at least for torsion free word-hyperbolic groups. Sela first showed in \cite{sela1995isomorphism} that this is solvable for torsion free word-hyperbolic groups with no essential small action on a real-tree and he has an unpublished proof for arbitrary torsion-free hyperbolic groups; Dahmani and Groves proved in \cite{dahmani2008isomorphism} that the problem is solvable in the more general class of torsion free relatively hyperbolic groups with abelian parabolics (a class which in particular includes torsion free word-hyperbolic groups).
 
@@ -73,14 +74,16 @@
 
 The reader may notice that torsion in word-hyperbolic groups appears to lead to complications which are often hard to work with. The isomorphism problem for arbitrary word-hyperbolic groups remains open at the time of writing, and torsion plays a part in complicating some of the proofs given in this thesis.
 
-In Chapter \ref{chapter:conjugacy} we present a solution to the conjugacy problem for finite \textit{lists} of elements of an arbitrary hyperbolic group which will run in time linear in total input word length. This is an improvement upon a quadratic time algorithm for lists which contain an infinite order element given in \cite{bridson2005conjugacy} - and an exponential time algorithm for lists of torsion elements outlined in the same paper. Our solution will in fact produce a complete description of the set of \textit{all} conjugating elements, and in particular the centraliser of a given list of elements.
+In Chapter \ref{chapter:conjugacy} we present a solution to the conjugacy problem for finite \textit{lists} of elements of an arbitrary hyperbolic group which will run in time $O(m\mu)$ where the lists have $m$ words and the words have length at most $\mu$. This is an improvement upon a quadratic time algorithm for lists which contain an infinite order element given in \cite{bridson2005conjugacy} - and an exponential time algorithm for lists of torsion elements outlined in the same paper. Our solution will in fact produce a complete description of the set of \textit{all} conjugating elements, and in particular the centraliser of a given list of elements.
 
 In Chapter \ref{chapter:qc_conj} we show that given a quasiconvex subgroup $H$ of a hyperbolic group, there is an algorithm which checks whether an input word represents a conjugate of an element of $H$, and again, this algorithm will run in linear time if both the group and the subgroup are held constant. We also show that it is possible, again in linear time, to test if two double cosets $HuK$ and $HvK$ are equal for quasiconvex subgroups $H$ and $K$, provided $H$ and $K$ are held constant.
 
-Chapter \ref{chapter:qc_coset} gives some properties of coset Cayley graphs of subgroups of hyperbolic groups, specifically giving some bounds on hyperbolicity and the distance from the base point before which they become ``eventually homogeneous'' in the torsion free case, going on to show some simple properties of  Finally, in Chapter \ref{chapter:minimal} we present a proof that there is a upper bound on the \textit{minimum} constant of hyperbolicity of a word-hyperbolic group over all finite generating sets of said group.
+Chapter \ref{chapter:qc_coset} gives some properties of certain coset Cayley graphs of subgroups of hyperbolic groups, specifically giving some bounds on hyperbolicity and the distance from the base point before which they become ``eventually homogeneous'' in the torsion free case, going on to show some simple facts about words which label geodesics distant from the base point.
 
-The rest of this chapter outlines the definitions which will apply during the rest of this thesis.
+Finally, in Chapter \ref{chapter:minimal} we present a proof that there is a upper bound on the \textit{minimum} constant of hyperbolicity of a word-hyperbolic group over all finite generating sets of said group.
 
+The rest of this chapter outlines the definitions which will apply during the rest of the thesis.
+
 \section{Metric Spaces and Paths}
 
 We assume the reader has at least a basic understanding of metric spaces.
@@ -90,9 +93,9 @@
 
 A \textbf{path} $\alpha$ in $\Gamma$ is a natural (ie. arc length) parametrization $\alpha : [0, l] \to \Gamma$ of a rectifiable curve in $\Gamma$. We will write $x \in \alpha$ to denote that $x$ lies in the \textit{image} of $\alpha$. If $\alpha$ maps from $[0, l]$, define the length of $\alpha$ to be $l$.
 
-A two-way infinite path $\alpha$ in $\Gamma$ is defined in the same way, except that $\alpha$ maps from $\mathbb{R}$ instead of an interval.
+A \textbf{two-way infinite path} $\alpha$ in $\Gamma$ is defined in the same way, except that $\alpha$ maps from $\mathbb{R}$ instead of an interval.
 
-A \textbf{subpath} $\alpha'$ of $\alpha$ is any restriction of $\alpha$ to a subinterval of its domain, ie.\ $\alpha|_{[a, b]}$, reparametrised so that $\alpha'(0) = \alpha(a)$.
+A \textbf{subpath} $\alpha'$ of (finite or infinite) path $\alpha$ is any restriction of $\alpha$ to a subinterval of its domain, ie.\ $\alpha|_{[a, b]}$, reparametrised so that $\alpha'(0) = \alpha(a)$.
 
 The \textbf{reversal} $\alpha^{-1} : [0, l] \to \Gamma$ of $\alpha$ is the map which sends $t \in [0, l]$ to $\alpha(l-t)$.
 
@@ -110,9 +113,9 @@
 
 $\alpha$ is a \textbf{geodesic} if it is a $(1, 0)$-quasigeodesic (that is, an isometry). A \textbf{geodesic metric space} is a metric space such that any two points in the space have a geodesic connecting them.
 
-Finally, for $L > 0$ define $\alpha$ to have a property \textbf{$L$-locally} if every length $L$ subpath of $\alpha$ has that property. So for example, $L$-local quasigeodesics are paths for which each length $L$ subpath is a quasigeodesic.
+For $L > 0$ define $\alpha$ to have a property \textbf{$L$-locally} if every length $L$ subpath of $\alpha$ has that property. So for example, $L$-local quasigeodesics are paths for which each length $L$ subpath is a quasigeodesic.
 
-An for any property above, an infinite path has that property if every finite subpath does. Thus we may describe an infinite path as a quasigeodesic and so on.
+Finally, a two-way infinite path one of the above properties if every finite subpath does. Thus we may describe an infinite path as a quasigeodesic and so on.
 \end{definition}
 
 \section{$X$-graphs}
@@ -125,14 +128,14 @@
 
 \begin{definition}
 \label{def:xgraph}
-Suppose $\Gamma$ is a directed graph which is connected ignoring edge directions, and has all edges labelled by elements of some finite set $X$. Then $\Gamma$ is an $X$-graph if, for each vertex $\vertex{p} \in \Gamma$ and each $x \in X$, there are unique edges $\edge{e}$ and $\edge{f}$ labelled by $x$, so that $\edge{e}$ starts at $\vertex{p}$ and $\edge{f}$ terminates at $\vertex{p}$. An $X$-graph will always be endowed with a distinguished base vertex.
+Suppose $\Gamma$ is a directed graph which is connected ignoring edge directions, and has all edges labelled by elements of some finite set $X$. Then $\Gamma$ is an \textbf{$X$-graph} if, for each vertex $\vertex{p} \in \Gamma$ and each $x \in X$, there are unique edges $\edge{e}$ and $\edge{f}$ labelled by $x$, so that $\edge{e}$ starts at $\vertex{p}$ and $\edge{f}$ terminates at $\vertex{p}$. An $X$-graph will always be endowed with a distinguished base vertex.
 \end{definition}
 
 Thus, an $X$-graph is a pointed labelled directed graph in which any word whose letters are in $X \cup X^{-1}$ defines an edge path starting from any vertex, formalised as follows:
 
 \begin{definition}
 \label{def:xgraphpath}
-For a finite set $A$, let $A^n$ be the set of tuples $(a_1, \ldot, a_n)$ where each $a_i \in A$. We define the set $A^* = \bigcup_{n=0}^\infty A^n$ and write elements of $A^*$ without brackets and commas, that is, in the form $a_1a_2 \cdots a_n$. If $u, v \in A^*$ we define $uv$ to be the element of $A^*$ defined by the concatenation of these strings.
+For a finite set $A$, let $A^n$ be the set of tuples $(a_1, \ldots, a_n)$ where each $a_i \in A$. We define the set $A^* = \bigcup_{n=0}^\infty A^n$ and write elements of $A^*$ without brackets and commas, that is, in the form $a_1a_2 \cdots a_n$. If $u, v \in A^*$ we define $uv$ to be the element of $A^*$ defined by the concatenation of these strings.
 
 Suppose $X$ is a finite set. Define $X^{\pm 1}$ to be the union of $X$ with the set $\{x^{-1} : x \in X\}$ where $x^{-1}$ is assumed to never be an element of $X$.
 
@@ -151,22 +154,9 @@
 
 Similarly, the coset Cayley graph (sometimes called a Schreier diagram or relative Cayley graph) of a subgroup $H \le G$ with respect to $X$ has vertex set $V = \{ Hg : g \in G \}$ (ie.\ the set of right cosets of $H$), and edges connnecting $Hg$ to $Hgx$ for each $Hg \in V$ and $x \in X$. Again, this is an $X$-graph, and we take the base vertex to be the vertex representing the trivial coset $H$.
 
-In fact, any $X$-graph $\Gamma$ is just a coset Cayley graph of a subgroup of the free group on $X$. To see this, let $\vertex{p}$ be the base vertex of $\Gamma$. Let $G$ be the free group generated by $X$ with elements represented by reduced $X$-words, and let $H$ be the set of reduced $X$-words $w$ such that $\vertex{p} \cdot w = \vertex{p}$. Then $H$ is a subgroup of $G$, and its coset Cayley graph with respect to $X$ is $\Gamma$. In this construction, $\vertex{p}$ is the vertex representing the trivial coset $H$. Much of Chapter \ref{chapter:qc_coset} could therefore be equivalently restated in terms of coset Cayley graphs.
+In fact, any $X$-graph $\Gamma$ is just a coset Cayley graph of a subgroup of the free group on $X$. To see this, let $\vertex{p}$ be the base vertex of $\Gamma$. Let $G$ be the free group generated by $X$ with elements represented by reduced $X$-words, and let $H$ be the set of reduced $X$-words $w$ such that $\vertex{p} \cdot w = \vertex{p}$. Then words in $H$ are a subgroup of $G$ whose its coset Cayley graph with respect to $X$ is $\Gamma$. In this construction, $\vertex{p}$ is the vertex representing the trivial coset $H$. Much of Chapter \ref{chapter:qc_coset} could therefore be equivalently restated in terms of coset Cayley graphs.
 
-The work in Chapter \ref{chapter:qc_coset} often concerns connected subsets of an $X$-graph; we define these here in order to avoid having to make two definitions of a ``geodesic word''.
-
 \begin{definition}
-\label{def:connected}
-Given a set of vertices $\Gamma'$ in a graph $\Gamma$, the \textbf{subgraph of $\Gamma$ induced by $\Gamma'$} is $\Gamma'$ together with every edge in $\Gamma$ which connects two vertices in $\Gamma'$.
-
-A set $\Gamma'$ of vertices in a $X$-graph $\Gamma$ is a \textbf{connected vertex subset} or \textbf{CVS} if the subgraph of $\Gamma$ induced by $\Gamma'$ is connected. Where we are not concerned with the full $X$-graph $\Gamma$, we will simply say that $\Gamma'$ is an $X$-CVS.
-
-If $\Gamma'$ is an $X$-CVS, $\vertex{p} \in \Gamma'$ and $w$ is an $X$-word, $w$ is a \textbf{$\Gamma'$-word} at $p$ if $p \cdot w(i) \in \Gamma'$ for each $i \in \{ 1, \ldots, |w| \}$.
-\end{definition}
-
-That is, a $\Gamma'$-word at $\vertex{p}$ is a word labelling a path starting at $\vertex{p}$ whose vertices are all inside $\Gamma'$, and a CVS is a set of vertices which are pairwise connected by $\Gamma'$-words. We will also consider finite balls in $X$-graphs to contain only vertices, so that:
-
-\begin{definition}
 If $\vertex{p}$ is a vertex in an $X$-graph $\Gamma$ and $k \ge 0$, the \textbf{$k$-ball} around $\vertex{p}$, or $B^{\Gamma}_k(\vertex{p})$, is the set containing all vertices $\vertex{q}$ with $d(\vertex{q}, \vertex{p}) \le k$. The superscript will often be omitted where the $X$-graph is clear from the vertex.
 \end{definition}
 
@@ -209,7 +199,7 @@
 
 By fixing some ordering on $X \cup X^{-1}$ we can produce a lexicographic ordering on $X$-words. We say $w$ is a short-lex least word if $w$ labels a geodesic at $\vertex{a}$ and no other geodesic connecting $\vertex{a}$ to $\vertex{a} \cdot w$ has a label lexicocgraphically less than $w$.
 
-Such a word is \textbf{short-lex straight} if each $w^i$ is a short-lex least word.
+Such a word is \textbf{short-lex straight} if $w^i$ is a short-lex least word for each $i > 0$.
 \end{defn}
 
 \section{Hyperbolicity}
@@ -223,7 +213,7 @@
 
 For points $x, y, z \in \Gamma$, define the \textbf{hyperbolic inner product} \[ (x, y)_z = \frac{d(x, z) + d(y, z) - d(x, y)}{2}. \]
 
-Given three points $x, y, z \in \Gamma$, we define a triangle to be a choice of paths $\path{x}{y}$, $\path{y}{z}$ and $\path{z}{x}$. We say the triangle is geodesic (resp. quasigeodesic, local geodesic, \ldots) if each of the three paths which make it up are geodesics (resp. quasigeodesic, \ldots).
+Given three points $x, y, z \in \Gamma$, we define a \textbf{triangle} to be a choice of paths $\path{x}{y}$, $\path{y}{z}$ and $\path{z}{x}$. We say the triangle is geodesic (resp. quasigeodesic, local geodesic, \ldots) if each of the three paths which make it up are geodesics (resp. quasigeodesic, \ldots).
 
 \begin{figure}
 \begin{center}
@@ -233,13 +223,13 @@
 \end{center}
 \end{figure}
 
-On a triangle connecting these three points, define the meeting point on the side $\path{x}{y}$ to be the point $c_z \in \path{x}{y}$ such that $d_{\path{x}{y}}(x, c_z) = \frac{d_{\path{x}{y}}(x, y) + d_{\path{x}{z}}(x, z) - d_{\path{y}{z}}(y, z)}{2}$. Notice that this meeting point may be on an edge when $\Gamma$ is a graph. Define $c_x$ and $c_y$ similarly as in Figure \ref{figure:thin_triangles}. Note that in the case of a geodesic triangle, $d(x, c_z) = (y, z)_x$.
+On a triangle connecting these three points, define the \textbf{meeting point} on the side $\path{x}{y}$ to be the point $c_z \in \path{x}{y}$ such that $d_{\path{x}{y}}(x, c_z) = \frac{d_{\path{x}{y}}(x, y) + d_{\path{x}{z}}(x, z) - d_{\path{y}{z}}(y, z)}{2}$. Notice that this meeting point may be on an edge when $\Gamma$ is a graph. Define $c_x$ and $c_y$ similarly as in Figure \ref{figure:thin_triangles}. Note that in the case of a geodesic triangle, $d(x, c_z) = (y, z)_x$.
 
 Suppose that $p$ is a point on $\path{x}{c_z}$. We say the point $q \in \path{x}{c_y}$ such that $d_{\path{x}{c_y}}(x, q) = d_{\path{x}{c_z}}(x, p)$ \textbf{corresponds} to $p$ and vice versa. By relabelling the corners, we may find a corresponding point to each point on each of the three sides of the triangle. Observe that the meeting points all correspond to each other and hence have 2 corresponding points (except in degenerate cases where the meeting points are equal), and that all other points have 1 corresponding point (except in similar degenerate cases).
 
 The triangle is \textbf{$\delta$-thin} if $d(p, q) \le \delta$ for all such corresponding points $p$ and $q$. It is \textbf{$\delta$-vertex-thin} if $d(\vertex{p}, \vertex{q}) \le \delta$ for all corresponding \textit{vertices} $\vertex{p}$ and $\vertex{q}$.
 
-A geodesic space is \textbf{$\delta$-hyperbolic} if all geodesic triangles in it are $\delta$-thin. A graph is \textbf{$\delta$-vertex-hyperbolic} if every geodesic triangle in the graph whose corners lie on vertices is $\delta$-vertex-thin and $\delta$ is an positive integer.
+A geodesic space is \textbf{$\delta$-hyperbolic} if all geodesic triangles in it are $\delta$-thin. A graph is \textbf{$\delta$-vertex-hyperbolic} if every geodesic triangle in the graph whose corners lie on vertices is $\delta$-vertex-thin and $\delta$ is an integer. In either case we will assume $\delta \ge 1$ to avoid complications in run times and so on.
 
 A finitely generated group $G = <\!X\!>$ is \textbf{$\delta$-hyperbolic} with respect to $X$ if its Cayley graph with respect to $X$ is $\delta$-hyperbolic.
 
@@ -248,9 +238,9 @@
 
 Notice that for any points $x, y, z \in \Gamma$ we have $(x, z)_y + (y, z)_x = d(x, y)$. This fact is used in many places to produce bounds on $d(x, y)$.
 
-For an $X$-graph $\Gamma$, with base vertex $\vertex{a}$, if we have $X$-words $u, v$ which label geodesics at $\vertex{a}$ then the value of $(\vertex{a} \cdot u, \vertex{a} \cdot v)_{\vertex{a}}$ in some sense measures the amount of cancellation in the word $u^{-1}v$ when it defines a path starting at $\vertex{a} \cdto u$. When $\Gamma$ is a Cayley graph, notice that $(\vertex{a} \cdot u, \vertex{a} \cdot v)_{\vertex{a}} = \frac{|u|_G + |v|_G - |uv^{-1}|_G}{2}$ is independent of the specific vertex $\vertex{a}$. Thus, when some group $G$ has been picked, we will write $\canc(u, v) = (\vertex{a} \cdot u, \vertex{a} \cdot v)_{\vertex{a}}$.
+For an $X$-graph $\Gamma$, with base vertex $\vertex{a}$, if we have $X$-words $u, v$ which label geodesics at $\vertex{a}$ then the value of $(\vertex{a} \cdot u, \vertex{a} \cdot v)_{\vertex{a}}$ in some sense measures the amount of cancellation in the word $u^{-1}v$ when it defines a path starting at $\vertex{a} \cdot u$. When $\Gamma$ is a Cayley graph, notice that $(\vertex{a} \cdot u, \vertex{a} \cdot v)_{\vertex{a}} = \frac{|u|_G + |v|_G - |uv^{-1}|_G}{2}$ is independent of the specific vertex $\vertex{a}$. Thus, when some group $G$ has been picked, we will write $\canc{u}{v} = (\vertex{a} \cdot u, \vertex{a} \cdot v)_{\vertex{a}}$.
 
-It is perhaps not clear whether or not a vertex-hyperbolic space is hyperbolic (although a hyperbolic space is clearly vertex-hyperbolic). The $\delta$ associated to vertex-hyperbolicity is rather more relevant to a hyperbolic group, as we are mostly concerned with words -- that is, labels of paths which connect vertices. In Section \ref{section:graph_hyp_implies_space_hyp} we show that these properties are indeed equivalent. Most of the literature uses the hyperbolicity constant rather than vertex-hyperbolicity constant, so we will for the most part be using this constant also to simplify results.
+It is perhaps not clear whether or not a vertex-hyperbolic space is hyperbolic (although a hyperbolic space is clearly vertex-hyperbolic). In Section \ref{section:graph_hyp_implies_space_hyp} we show that these properties are indeed equivalent. The $\delta$ associated to vertex-hyperbolicity is rather more relevant to a hyperbolic group as we are mostly concerned with words -- that is, labels of paths which connect vertices. Most of the literature, however, uses the hyperbolicity constant rather than vertex-hyperbolicity constant, so we will for the most part be using this constant also to simplify the use of results from elsewhere.
 
 The property of being $\delta$-hyperbolic for \textit{some} $\delta$ is a property of the group and not just the generating set (see \cite{gromov1987hyperbolic}), although the particular value of $\delta$ will likely change depending on the particular generating set used.
 
@@ -258,16 +248,16 @@
 
 This algorithm terminates if and only if the presentation defines a hyperbolic group, and has no bound on its running time: It is impossible to predict when the algorithm will complete, only that it will at some point do so. We will therefore assume that for any word-hyperbolic group mentioned in this thesis, the algorithm has \textit{already been executed} and thus the constant $\delta$ is known.
 
-Note that this indeterminate runtime is the best that we can hope for. Given a $\delta$-hyperbolic group, it is rather easy to test if that group is trivial: use the solution of the word problem to show that each generator is equal to the identity. In fact, the trivial group is $1$-hyperbolic for any generating set. If there were an efficient algorithm which determined if a given presentation was hyperbolic, it would therefore be able to determine if a given finite presentation is a presentation of the trivial group or not. This is well known to be impossible.
+Note that this indeterminate runtime is the best that we can hope for. Given a $\delta$-hyperbolic group, it is rather easy to test if that group is trivial: use the solution of the word problem to show that each generator is equal to the identity. In fact, the trivial group is $0$-hyperbolic for any generating set. If there were an efficient algorithm which determined whether or not a given presentation was hyperbolic, it would therefore be able to determine whether or not a given finite presentation is a presentation of the trivial group. This is well known to be impossible.
 
-We noted earlier that the word problem was solvable in the setting of hyperbolic groups. In \cite{epstein2006linearity} a solution to the word problem due to Shapiro is given which runs in linear time, as follows.
+We noted earlier that the word problem was solvable in the setting of hyperbolic groups. In \cite{epstein2006linearity} a solution to the word problem due to Shapiro is given which runs in linear time on a Turing machine with two tapes, as follows.
 
 \begin{lemma}
 \label{lemma:short_lex}
 Suppose that $G$ is a $\delta$-hyperbolic group. Then there is an algorithm which, given a word $w$ in the generators of $G$ will return the short-lex least representative of $w$ in time $O(|w|)$.
 \end{lemma}
 
-We will denote use of this lemma (ie.\ the act of finding short-lex reduced words) by $\slex$ operating on elements, words and lists of elements or words in the obvious way. Of course, we will also use it implicitly, since it implies that operations like finding the length of an element, or deciding equality of two elements can be performed in time linear in the length of the input words.
+We will denote use of this lemma (ie.\ the act of finding short-lex reduced words) by $\slex$ operating on elements, words and lists of elements or words in the obvious way. Of course, we will also use it implicitly, since it implies that operations like finding the length $|g|_G$ of an element $g$, or deciding equality of two elements can be performed in time linear in the length of the input words.
 
 \section{Automatic groups and DFAs}
 
@@ -276,11 +266,11 @@
 \begin{definition}
 Given a set $A$, let $A' = A \cup \{ \epsilon \}$ where $\epsilon$ is assumed not to be in $A$.
 
-A \textbf{finite state automaton} $M$ on an alphabet $A$ (or $A$-FSA) is a finite set $S$ of states, a subset $X \subset S$ of \textbf{start states}, a set $Y \subset S$ of \textbf{accepting states} and a set $\tau \subset S \times A' \times S$ of \textbf{transitions}.
+A \textbf{finite state automaton} $M$ on an alphabet $A$ (or $A$-FSA) is a finite set $S$ of states, a subset $X \subset S$ of \textbf{start states}, a subset $Y \subset S$ of \textbf{accepting states} and a set $\tau \subset S \times A' \times S$ of \textbf{transitions}.
 
 The set of transitions allow us to regard $M$ as a directed graph $G$ with vertex set $S$ and an edge connecting $s$ to $t$ with label $a$ whenever $(s, a, t) \in \tau$. An edge with label $\epsilon$ is called an $\epsilon$-transition.
 
-We say $M$ is \textbf{deterministic}, or $M$ is an \textbf{$A$-DFA}, if $X$ has only a single element $s_0$, there are no $\epsilon$-transitions and for all $s \in S$ and $a \in A$ there is at most one edge in $G$ labelled $a$ which starts at $s$.
+We say $M$ is \textbf{deterministic}, or $M$ is an \textbf{$A$-DFA}, if $X$ has only a single element $s_0 \in X$, there are no $\epsilon$-transitions and for all $s \in S$ and $a \in A$ there is at most one edge in $G$ labelled $a$ which starts at $s$.
 
 We say an element $w \in A^*$ is \textbf{accepted by $M$} if there is a path in $G$ starting at an element of $X$ and ending at an element of $Y$ whose label, after deleting all occurrences of $\epsilon$, is $w$.
 
@@ -289,22 +279,33 @@
 A language is \textbf{regular} if it is the language of an $A$-FSA.
 \end{definition}
 
-In the deterministic case, notice that $\tau$ defines a partial function $\sigma : S \times A \to S$. By adding a ``reject'' state $r$ to $S$, we can make $\sigma$ a full function $\sigma'$ by setting $\sigma'(s, a) = r$ whenever $\sigma'(s, a)$ is not defined. We can extend this to a function $\overline{\sigma} : S \time A^* \to S$ by letting $\overlne{\sigma}(s, w) := \sigma'(\sigma'(\sigma'(s, a_1), a_2), \ldots, a_n)$ whenever $w = a_1a_2 \cdots a_n \in A^*$. Thus $w$ is accepted if and only if $\overline{\sigma}(s_0, w) \in Y$, and one can test membership in time linear in input length.
+In the deterministic case, notice that $\tau$ defines a partial function $\sigma : S \times A \to S$. By adding a ``reject'' state $r$ to $S$, we can make $\sigma$ a full function $\sigma'$ by setting $\sigma'(s, a) = r$ whenever $\sigma'(s, a)$ is not defined. We can extend this to a function $\overline{\sigma} : S \times A^* \to S$ by letting $\overline{\sigma}(s, w) := \sigma'(\sigma'(\sigma'(s, a_1), a_2), \ldots, a_n)$ whenever $w = a_1a_2 \cdots a_n \in A^*$. Thus $w$ is accepted if and only if $\overline{\sigma}(s_0, w) \in Y$, and one can test membership in time linear in input length.
 
-Every regular language is accepted by a \textit{DFA}. In section 13.1.6.1 of \cite{holt2005handbook}, for instance, an method is given to produce a DFA from any FSA.
+Every regular language is accepted by a \textit{DFA}. In section 13.1.6.1 of \cite{holt2005handbook}, for instance, a method is given to produce a DFA from any FSA.
 
+A basic property of regular languages is that they obey the \textbf{pumping lemma} (see \cite{hopcraft--ullman}, Lemma 3.1 for example). A quick sketch proof is given here, as a similar technique is used in Section \ref{section:holt}.
+
+\begin{proposition}
+\label{prop:pumpinglemma}
+Suppose $M$ is an $A$-DFA. Then there is a constant $K$ such that for any word $w$ in the language of $M$ with $|w| \ge K$ there are words $a, b, c \in A^*$ such $w = abc$, $|b| > 0$ and $ab^nc$ is in the language of $M$ for all $n > 0$.
+\end{proposition}
+
+\begin{proof}
+Let $K$ be the number of states in $M$, let $s_0$ be its start state and let $\sigma$ be its transition function. If $|w| \ge K$ then when reading $w$, some state is hit twice, ie.\ there is some state $s$ with $s = \overline{\sigma}(s_0, w(i)) = \overline{\sigma}(s_0, w(j))$ for some $i < j$. Then $\overline{\sigma}(s, w(i:j)) = s$, so let $a := w(i)$, $b := w(i:j)$ and $c := w(j:|w|)$ and for any $n > 0$ we have $\overline{\sigma}(ab^nc) = \overline{\sigma}(abc) = \overline{\sigma}(w)$. In particular, $ab^nc$ is also accepted by $M$.
+\end{proof}
+
 There are many other definitions of a regular language which are equivalent to this, for instance, regular expressions. We will not need these definitions, however, so we omit them. We do, however, make use of (synchronous) $n$-variable FSAs which we now define.
 
 \begin{definition}
-Given a set $A$, let $\widetilde{A} = A \cup \{\$\}$ where $\$$ is some symbol which is not in $A$.
+For this definition, given a set $A$, let $A' = A \cup \{\$\}$ where $\$$ is some symbol which is not in $A$.
 
-Given a tuple $T = (w_1, \ldots, w_n)$ of words with letters in $A$, let $l$ be the length of the longest word in $T$. For each $i$, let $w_i'$ be $w_i$ with a string of $\$$ symbols added onto the end so that each $w_i'$ has length exactly $l$. Now let $\widetilde{T} = a_1 \cdots a_l$ where $a_j := (w_1'[j], \ldots, w_n'[j])$ so that $\widetilde{T}$ is an element of $(\widetilde{A}^n)^*$.
+Given a tuple $T = (w_1, \ldots, w_n)$ of words with letters in $A$, let $l$ be the length of the longest word in $T$. For each $i$, let $w_i'$ be $w_i$ with a string of $\$$ symbols added onto the end so that each $w_i'$ has length exactly $l$. Now let $\widetilde{T} = a_1 \cdots a_l$ where $a_j := (w_1'[j], \ldots, w_n'[j])$ so that $\widetilde{T}$ is an element of $(A'^n)^*$.
 
-An $n$-variable $A$-FSA $M$ is an $\tilde{A}^n$-FSA $M'$.
+An $n$-variable $A$-FSA $M$ is an $A'^n$-FSA $M'$.
 
-We say $M$ accepts a tuple $T \in (\tilde{A}^*)^n$ if $M'$ accepts $\tilde{T}$ and define the language of $M$ to be the set of all such tuples accepted by $M$.
+We say $M$ accepts a tuple $T \in (A'^*)^n$ if $M'$ accepts $\widetilde{T}$ and define the language of $M$ to be the set of all such tuples accepted by $M$.
 
-We say that a subset of $(\widetilde{A}^*)^n$ is a regular $n$-variable language if it is the language of an $n$-variable $A$-DFA.
+We say that a subset of $(A'^*)^n$ is a \textbf{regular $n$-variable language} if it is the language of an $n$-variable $A$-DFA.
 \end{definition}
 
 Notice that a $1$-variable $A$-FSA simply defines an $A$-FSA (the symbol $\$$ will never be needed so any edge with that label may be ignored). We now state some simple results involving regular languages and provide a brief proof skipping some details.
@@ -312,7 +313,8 @@
 \begin{proposition}
 \label{prop:regular}
 Suppose $A$ is a finite set containing $l$ elements.
-\begin{enumerate}[\textcircle{i}]
+\renewcommand{\labelenumi}{(\arabic{enumi}) }
+\begin{enumerate}
 \item \label{item:reg_empty} The empty set is the language of an $A$-FSA with 1 state.
 \item \label{item:reg_all} $A^*$ is the language of an $A$-FSA with 1 state.
 \item \label{item:reg_word} For any word $y \in A^*$, the set $\{y\}$ is the language of an $A$-FSA with $|y|+1$ states.
@@ -322,49 +324,50 @@
 \end{enumerate}
 
 Now suppose that there are are $n_1$-variable and $n_2$-variable $A$-FSAs with languages $L_1$ and $L_2$, and have $k_1$ and $k_2$ states respectively.
-\begin{enumerate}[\textcircle{i}]
-\setcounter{enum}{\value{regularenum}}
-\item \label{item:reg_pair} $\{(w, w):w \in L_1\}$ is the language of a $2n_1$-variable $A$-FSA with $k_1$ states.
+\begin{enumerate}
+\setcounter{enumi}{\value{regularenum}}
 \item \label{item:reg_proj} Projection of $L_1$ to any its first factor is the language of an $A$-FSA with $k_1$ states.
 \item \label{item:reg_cart} $L_1 \times L_2$ is the language of an $n_1 + n_2$-variable $A$-FSA with $k_1k_2$ states.
 \setcounter{regularenum}{\value{enumi}}
 \end{enumerate}
 
 Suppose that $n_1 = n_2$.
-\begin{enumerate}[\textcircle{i}]
-\setcounter{enum}{\value{regularenum}}
+\begin{enumerate}
+\setcounter{enumi}{\value{regularenum}}
 \item \label{item:reg_union} $L_1 \cup L_2$ is the language of an $n_1$-variable $A$-FSA with $k_1k_2$ states.
 \item \label{item:reg_intersection} $L_1 \cap L_2$ is the language of an $n_1$-variable $A$-FSA with $k_1k_2$ states.
 \setcounter{regularenum}{\value{enumi}}
 \end{enumerate}
 
 Finally, suppose that there are $A$-FSAs with languages $L_1$ and $L_2$, and have $k_1$ and $k_2$ states respectively.
-\begin{enumerate}[\textcircle{i}]
-\setcounter{enum}{\value{regularenum}}
+\begin{enumerate}
+\setcounter{enumi}{\value{regularenum}}
+\item \label{item:reg_pair} $\{(w, w):w \in L_1\}$ is the language of a $2n_1$-variable $A$-FSA with $k_1$ states.
 \item \label{item:reg_concat} The concatenation, $L_1L_2 = \{w_1w_2:w_1 \in L_1, w_2 \in L_2\}$ of $L_1$ and $L_2$ is the language of an $A$-FSA with $k_1 + k_2$ states.
 \end{enumerate}
 
 All of the automata above can be computed in time $O(l^2s)$, where $s$ is the number of states in the new automaton.
+\renewcommand{\labelenumi}{\arabic{enumi}. }
 \end{proposition}
 
 \begin{proof}
-For \textcircle{\ref{item:reg_empty}} let $S = X = Y = \{1\}$ and $\tau$ be the empty set. For \textcircle{\ref{item:reg_all}}, let  $S = X = Y = \{1\}$ and let $\tau = S \times A' \times S$.
+For (\ref{item:reg_empty}) let $S = X = Y = \{1\}$ and $\tau$ be the empty set. For (\ref{item:reg_all}), let  $S = X = Y = \{1\}$ and let $\tau = S \times A' \times S$.
 
-For \textcircle{\ref{item:reg_word}} suppose $y = a_1 \cdots a_n$. Let $S = \{ 0, \ldots, n \}$, $X = \{ 0 \}$ and $Y = \{ n \}$. Let $\tau = \{ (i - 1, a_i, i) : 1 \le i \le n \}$. For \textcircle{\ref{item:reg_loop}}, let $S = \{ 1, \ldots, n \}$, $X = \{ 0 \}$ and $Y = \{ 1 \}$. Let $\tau = \{ (i, a_i, i + 1) : 1 \le i \le n - 1 \} \cup \{ (n, a_n, 1) \}$.
+For (\ref{item:reg_word}) suppose $y = a_1 \cdots a_n$. Let $S = \{ 0, \ldots, n \}$, $X = \{ 0 \}$ and $Y = \{ n \}$. Let $\tau = \{ (i - 1, a_i, i) : 1 \le i \le n \}$. For (\ref{item:reg_loop}), let $S = \{ 1, \ldots, n \}$, $X = \{ 0 \}$ and $Y = \{ 1 \}$. Let $\tau = \{ (i, a_i, i + 1) : 1 \le i \le n - 1 \} \cup \{ (n, a_n, 1) \}$.
 
 For the remainder of the examples, we assume the FSAs have state sets $S_i$, start states $X_i$, accept states $Y_i$ and transitions $\tau_i$.
 
-For \textcircle{\ref{item:reg_pair}}, let $S = S_1$, $X = X_1$, $Y = Y_1$ and $\tau = \{ (s, (a, a), t) : (s, a, t) \in \tau_1 \}$.
+For (\ref{item:reg_proj}), let $S = S_1$, $X = X_1$, $Y = Y_1$ and $\tau = \{ (s, a_1, t) : (s, (a_1, \ldots, a_{n_1}), t) \in \tau_1 \}$, replacing any transitions labelled $\$$ with transitions labelled $\epsilon$.
 
-For \textcircle{\ref{item:reg_proj}}, let $S = S_1$, $X = X_1$, $Y = Y_1$ and $\tau = \{ (s, a_1, t) : (s, (a_1, \ldots, a_{n_1}), t) \in \tau_1 \}$, replacing any transitions labelled $\$$ with transitions labelled $\epsilon$.
+For (\ref{item:reg_cart}) if both automata have one variable, let $S = S_1 \times S_2$, $X = X_1 \times X_2$ and $Y = Y_1 \times Y_2$. Let $\tau_i' = \tau_i \cup \{s, \$, s : s \in S_i\}$ for each $i$ and then let $\tau = \{ ((s_1, s_2), (a_1, a_2), (t_1, t_2)) : (s_1, a_1, t_1) \in \tau_1', (s_2, a_2, t_2) \in \tau_2' \}$. The multiple variable case is similar but requires that one be a little careful with transitions labelled $\$$.
 
-For \textcircle{\ref{item:reg_cart}} if both automata have one variable, let $S = S_1 \times S_2$, $X = X_1 \times X_2$ and $Y = Y_1 \cap Y_2$. Let $\tau_i' = \tau_i \cup \{s, \$, s : s \in S_i\}$ for each $i$ and then let $\tau = \{ ((s_1, s_2), (a_1, a_2), (t_1, t_2)) : (s_1, a_1, t_1) \in \tau_1', (s_2, a_2, t_2) \in \tau_2' \}$. The multiple variable case is similar but requires that one be a little careful with transitions labelled $\$$.
+For (\ref{item:reg_union}) and (\ref{item:reg_intersection}) let $S = S_1 \times S_2$, $X = X_1 \times X_2$ and $\tau = \{ (s_1, s_2, a, t_1, t_2) : (s_1, a, t_1) \in \tau_1, (s_2, a, t_2) \in \tau_2\}$. For (\ref{item:reg_union}) let $Y = (Y_1 \times S_2) \cup (S_1 \times Y_2)$; for (\ref{item:reg_union}) let $Y = (Y_1 \times S_2) \cap (S_1 \times Y_2)$.
 
-For \textcircle{\ref{item:reg_union}} and \textcircle{\ref{item:reg_intersection}} let $S = S_1 \times S_2$, $X = X_1 \times X_2$ and $\tau = \{ (s_1, s_2, a, t_1, t_2) : (s_1, a, t_1) \in \tau_1, (s_2, a, t_2) \in \tau_2\}$. For \textcircle{\ref{item:reg_union}} let $Y = (Y_1 \times S_2) \cup (S_1 \times Y_2)$.
+For (\ref{item:reg_pair}), let $S = S_1$, $X = X_1$, $Y = Y_1$ and $\tau = \{ (s, (a, a), t) : (s, a, t) \in \tau_1 \}$.
 
-For \textcircle{\ref{item:reg_concat}} let $S = S_1 \cup S_2$, $X = X_1$ and $Y = Y_2$ and let $\tau = \tau_1 \cup \tau_2 \cup \{ y, \epsilon, x : y \in Y_1, x \in X_2 \}$.
+For (\ref{item:reg_concat}) let $S = S_1 \cup S_2$, $X = X_1$ and $Y = Y_2$ and let $\tau = \tau_1 \cup \tau_2 \cup \{ y, \epsilon, x : y \in Y_1, x \in X_2 \}$.
 
-In each case, the sets $S, X, Y$ and $\tau$ define the required automaton.
+In each case, the sets $S, X, Y$ and $\tau$ define the required automaton and are computed in the required time.
 \end{proof}
 
 We now define various types of automatic groups.
@@ -387,22 +390,11 @@
 
 Much like with hyperbolicity, it is impossible to determine whether or not an arbitrary finitely presented group is automatic -- in fact, the problem here is made even more difficult as one must search for a regular set $W$, which might not be something easily described like the set of geodesic words.
 
-There is one particular property that we will use of a regular language, that they obey the pumping lemma (see \cite{hopcraft--ullman}, Lemma 3.1 for example). A quick sketch proof is given here, as a similar technique is used in Section \ref{section:holt}.
-
-\begin{proposition}
-\label{prop:pumpinglemma}
-Suppose $M$ is an $A$-DFA. Then there is a constant $K$ such that for any word $w$ in the language of $M$ with $|w| > K$ there are words $a, b, c \in A^*$ such $w = abc$, $|b| > 0$ and $ab^nc$ is in the language of $M$ for all $n > 0$.
-\end{proposition}
-
-\begin{proof}
-Let $K$ be the number of states in $M$, let $s_0$ be its start state and let $\sigma$ be its transition function. If $|w| \ge K$ then when reading $w$, some state is hit twice, ie.\ there is some state $s$ with $s = \tilde{\sigma}(s_0, w(i)) = \tilde{\sigma}(s_0, w(j))$ for some $i < j$. Then $\tilde{\sigma}(s, w(i:j)) = s$, so let $a := w(i)$, $b := w(i:j)$ and $c := w(j:|w|)$ and for any $n > 0$ we have $\tilde{\sigma}(ab^nc) = \tilde{\sigma}(abc) = \tilde{\sigma}(w)$. In particular, $ab^nc$ is also accepted by $M$.
-\end{proof}
-
 \section{Other notation}
 
 We close this chapter with some other miscellaneous notation which is used throughout.
 
-Many of the results below relate to conjugacy. We adopt a shorthand to express conjugation.
+Many of the results in the thesis relate to conjugacy. We adopt a shorthand to express conjugation.
 
 \begin{defn}
 Supposing $g, h \in G$, we will denote conjugation of $g$ by $h$ using superscripts, so that $g^h = h^{-1}gh$.
@@ -420,7 +412,7 @@
 
 \section{Introduction}
 
-In \cite{bridson2005conjugacy}, Bridson and Howie give a solution of the conjugacy problem for finite lists $A = (a_1, \ldots, a_m)$ and $B = (b_1, \ldots, b_m)$ of elements in a hyperbolic group -- in fact, they prove that the problem is solvable in time $O(m \mu^2)$ for a torsion free group, where $\mu$ is an upper bound on the lenght of elements in both lists.
+In \cite{bridson2005conjugacy}, Bridson and Howie give a solution of the conjugacy problem for finite lists $A = (a_1, \ldots, a_m)$ and $B = (b_1, \ldots, b_m)$ of elements in a hyperbolic group -- in fact, they prove that the problem is solvable in time $O(m \mu^2)$ for a torsion free group, where $\mu$ is an upper bound on the length of elements in both lists.
 
 The aim here is to both improve the bound on running time to $O(m\mu)$, and to tie up the rather limp conclusion in part 2 of Theorem B of \cite{bridson2005conjugacy}, in which their algorithm simply terminates when the lists contain entirely elements of finite order without giving any results on the conjugacy.
 
@@ -434,15 +426,15 @@
 
 The technicalities behind the proof in the case where one element, say $a_1$, has infinite order are largely covered by solving the conjugacy problem $a_1^h =_G b_1$ for $h$ as in \cite{epstein2006linearity}. In the process of doing so, we can find a useful description of elements of the centraliser $C$ of $a_1$ and then test if for some $c \in C$ we have $A^{ch} =_G B$. Of course $C$ is infinite, so it is important to perform this testing efficiently. Section \ref{section:inf_order} describes a way of doing so.
 
-Unfortunately, since we can only obtain this form of the centraliser for infinite order elements we run up against problems when we consider lists of torsion elements. It is, however, possible to show that provided we bound the number of elements in our lists, we can efficiently either find a pair of lists $A'$ and $B'$ such that $A^h =_G B$ if and only if $A'^h =_G B'$ and such that either $A'$ contains an infinite order element or each element of $A'^g$ is of bounded length for some element $g$. In the latter case, one may simply use the exponential algorithm given in \cite{bridson2005conjugacy} to finish the solution.
+Unfortunately, since we can only obtain this form of the centraliser for infinite order elements we run up against problems when we consider lists of torsion elements. It is, however, possible to show that provided we bound the number of elements in our lists, we can efficiently find a pair of lists $A'$ and $B'$ such that $A^h =_G B$ if and only if $A'^h =_G B'$ and such that either $A'$ or $B'$ contains an infinite order element, or each element in $A'$ and $B'$ is of bounded length for some element $g$. In the latter case, one may simply use the exponential algorithm given in \cite{bridson2005conjugacy} to finish the solution.
 
-The disadvantage of computing in this way is that for lists with more elements, the amount of computation required grows in at least exponential fashion. However, it can be shown that if there are sufficiently many finite order elements in the list then its centraliser is finite. In particular, there are only a finite number of elements which can simultaneously conjugate the initial elements of one list to the initial elements of the other, so we need only test these elements on the remainder of the lists to complete the procedure.
+The disadvantage of computing in this way is that for lists with more elements, the amount of computation required grows in at least exponential fashion. However, it can be shown that if there are sufficiently many finite order elements in the list then its centraliser is finite. In particular, there are only a finite number of elements which can simultaneously conjugate the initial elements of one list to the initial elements of the other, so we need only test these centralising elements on the remainder of the elements of the lists to complete the procedure.
 
 In fact, all of the methods we use above will produce a complete description of the set of \textit{all} conjugating elements as a regular set. Thus we have:
 
 \begin{theorem}
 \label{thm:linear_conj}
-Given integers $\delta \ge 1$ and $l$, there is an algorithm which, given a $\delta$-hyperbolic group $G=<X|R>$ with $|X| \le l$ and lists $A$ and $B$ of words in the generators of $G$ can find an $X^{\pm 1}$-NFA whose language $L$ satisfies:
+Given integers $\delta \ge 1$ and $l$, there is an algorithm which, given a $\delta$-hyperbolic group $G=<X|R>$ with $|X| \le l$ and lists $A$ and $B$ of words in the generators of $G$ can find an $X^{\pm 1}$-FSA whose language $L$ satisfies:
 \begin{itemize}
 \item $A^w =_G B$ for any $w \in L$, and
 \item for any $g \in G$ such that $A^g =_G B$ there is an element $w \in L$ with $w =_G g$.
@@ -471,8 +463,12 @@
 
 \section{The infinite order case}
 
-In this section, we will assume that we are given two equal length lists $A$ and $B$ whose elements $X$-words, and that all elements of $A$ and $B$ have length at most $\mu$. We will also assume that the first
+\label{section:inf_order}
 
+In this section, we will assume that we are given two equal length lists $A$ and $B$ whose elements $X$-words, and that all elements of $A$ and $B$ have length at most $\mu$. We will also assume that the first element of $A$ is of infinite order.
+
+We begin with several sections which bring together results from other sources and then put those results together to give an algorithm which finds elements which conjugate $A$ to $B$.
+
 \subsection{Results from \cite{epstein2006linearity}}
 
 \label{section:holt}
@@ -493,7 +489,7 @@
 If $w$ is an $L$-local $(1, 2\delta)$ quasigeodesic in $\Gamma$, and $u$ is a geodesic connecting its endpoints, then every point on $w$ is within $4\delta$ of a point on $u$ and vice versa. Also, if $|w| \ge L$ then $|u| \ge \frac{7|w|}{17}$.
 \end{proposition}
 
-In particular, if $|w_C| > 2L$ then $w$ is of infinite order as there is no bound on the length of shortest representatives of its powers.
+In particular, if $|w_C| > 2L$ then $w$ is of infinite order as there is no bound on the length of shortest representatives of its powers. We will use this fact extensively in the next section also.
 
 The next step is to show that such a word $u$ can be equated with some root of a conjugate of a short-lex straight word. The following two results summarise Section 3.2 of \cite{epstein2006linearity}.
 
@@ -511,9 +507,9 @@
 
 Thus we have the following code to test for short-lex straight-ness:
 
-\begin{algorithm}[h]
+\begin{algorithm}
 \label{algorithm:testsls}
-\caption{Test if an $X$-word is short-lex straight}
+Test if an $X$-word is short-lex straight
 \begin{algorithmic}[1]
 \Function{TestSLS}{$u$}
 \Statex \textbf{Input:} An $X$-word $u$.
@@ -529,7 +525,7 @@
 \State $visited[s]\gets true$
 \For{$i:= 1$ to $|w|$}
 	\State $s \gets f(s, w[i])$
-	\If{$\neg$ \Call{IsAcceptState}{$WA, S$}}
+	\If{$\neg$ \Call{IsAcceptState}{$WA, s$}}
 		\State \textbf{return} false
 	\EndIf
 	\If{$i=0\mod|u|$}
@@ -545,9 +541,9 @@
 
 And we can find a short-lex straight power as follows:
 
-\begin{algorithm}[h]
+\begin{algorithm}
 \label{algorithm:findslspower}
-\caption{Find a short-lex straight power}
+Find a short-lex straight power
 \begin{algorithmic}
 \Function{FindSLSPower}{$a$}
 \Statex \textbf{Input:} An $X$-word $a$ for which $\widetilde{a^\infty}$ is a $L$-local $(1, 2\delta)$ quasigeodesic.
@@ -563,26 +559,28 @@
 \end{algorithmic}
 \end{algorithm}
 
-Once a word is short-lex straight, it is easier to test a conjugacy against it. The next result summarises Section 3.3 of \cite{epstein2006linearity}.
+Once a word is short-lex straight, it is easier to test conjugacy against it. The next result summarises Section 3.3 of \cite{epstein2006linearity}.
 
 \begin{proposition}
 \label{prop:test_conj_sls}
-If $u$ is short-lex straight and $v$ is a word such that $\tilde{v^\infty}$ is a $(1, 2\delta)$ $L$-local quasigeodesic with $|v|_G > L$, and $g^{-1}vg =_Gu$ for some $g$, then there exists a word $h$ with $|h| \le 6\delta$ such that $h^{-1}vh$ is a cyclic conjugate of $u$. 
+If $u$ is short-lex straight and $v$ is a word such that $\widetilde{v^\infty}$ is a $(1, 2\delta)$ $L$-local quasigeodesic with $|v|_G > L$, and $g^{-1}vg =_Gu$ for some $g$, then there exists a word $h$ with $|h| \le 6\delta$ such that $\slex(h^{-1}vh)$ is a cyclic conjugate of $u$. 
 \end{proposition}
 
-Thus the following pseudocode will test conjugacy of such words $u$, $v$:
+One can test if a word $u$ is a cyclic conjugate of another word $v$ by testing if $v$ appears as a substring of $u^2$, which can be done for instance using the Knuth-Morris-Pratt algorithm which runs in time $O(|u| + |v|)$. We denote the use of this algorithm by \textsc{FindSubstring} and later, \textsc{FindSecondSubstring}.\footnote{The KMP algorithm appears to be the only point at which the assumption of a RAM model of computing is needed; at all other points where it appears arithmetic is being done, we are actually comparing lengths of words which can be performed in linear time on a Turing machine with 2 tapes.}
 
-\begin{algorithm}[h]
+The following pseudocode will test conjugacy of such words $u$, $v$:
+
+\begin{algorithm}
 \label{algorithm:testconjugacyslslong}
-\caption{Test if a short-lex straight word is conjugate to a ``long'' word}
+Test if a short-lex straight word is conjugate to a ``long'' word.
 \begin{algorithmic}[1]
 \Function{TestConjugacySLSLong}{$u, v$}
 \Statex \textbf{Input:} A short-lex straight $X$-word $u$ and an $X$-word $u$ for which $\widetilde{a^\infty}$ is a $L$-local $(1, 2\delta)$ quasigeodesic.
 \Statex \textbf{Output:} An $X$-word $g$ with $u^g =_G v$ or $null$ if no such $g$ exists.
 \For{$h \in B_{6\delta}(1)$}\Comment{Test conjugacy using Proposition \ref{prop:test_conj_sls}}
-	\State $i \gets$ \Call{FindSubString}{$u^2$, $\pi(h^{-1}vh)$}
+	\State $i \gets$ \Call{FindSubString}{$u^2$, $\pi(hvh^{-1})$}
 	\If{$i$ is not null}
-		\State \textbf{return} $h^{-1}u(i)$
+		\State \textbf{return} $u(i)h$
 	\EndIf
 \EndFor
 \State \textbf{return} $null$
@@ -601,21 +599,20 @@
 
 Again, here is the algorithm in pseudocode:
 
-\begin{algorithm}[h]
+\begin{algorithm}
 \label{algorithm:findslscentralisersuperset}
-\caption{Find a nice superset of the centraliser of a short-lex straight word}
+Find a ``nice'' superset of the centraliser of a short-lex straight word.
 \begin{algorithmic}[1]
 \Function{FindSLSCentraliserSuperset}{$z$}
 \Statex \textbf{Input:} A short-lex straight $X$-word $z$
-\Statex \textbf{Output:} A short-lex straight word $y$ and a set $S$ with $y^l = z$ for some $l$ and $C_G(z) \subset \{ y^ns : n \in \mathbb{Z}, s \in S \}$.
+\Statex \textbf{Output:} A short-lex straight word $y$ with $w^l = z$ for some $l$ and a set $S$ with $C_G(z) \subset \{ y^ns : n \in \mathbb{Z}, s \in S \}$.
 \State $i \gets$ \Call{FindSecondSubString}{$z^2$, $z$}
 \State $y \gets z(i)$ 
-\State $S \gets []$
+\State $S \gets \{\}$
 \For{$h \in B_{2\delta}(1)$}\Comment{Find centraliser of $a$ using Proposition \ref{prop:find_centraliser_sls}}
-	\State $i \gets$ \Call{FindSubString}{$z^2$, $\pi(hzh^{-1})$}
+	\State $i \gets$ \Call{FindSubString}{$z^2$, $\slex(hzh^{-1})$}
 	\If{$i$ is not null}
-		\State $u \gets z(i)$
-		\State \Call{Push}{$S$, $uh$}
+		\State $S \gets S \cup \{z(i)h\}$
 	\EndIf
 \EndFor
 \State \textbf{return} $y, S$
@@ -623,24 +620,24 @@
 \end{algorithmic}
 \end{algorithm}
 
-Suppose that $z=\slex(a^{-1}(u_C)^ia)$ is short-lex straight, that $y^l=z$ with $l$ maximal, that $\tilde{v^\infty}$ is an $L$-local $(1,2\delta)$ quasigeodesic, that $b^{-1}zb=_G v^i$ and that $g^{-1}ug=_Gv$. Note that \begin {eqnarray*}
-        b^{-1}zb
+Suppose that $z=\slex(a^{-1}(u_C)^ia)$ is short-lex straight, that $y^l=z$ with $l$ maximal, that $\widetilde{v^\infty}$ is an $L$-local $(1,2\delta)$ quasigeodesic, that $b^{-1}zb=_G v^i$ and that $g^{-1}ug=_Gv$. Note that \begin {eqnarray*}
+        z^b
 & =_G & v^i \\
-& =_G & g^{-1}u^ig\\
-& =_G & g^{-1}u_Lu_C^i(u_L)^{-1}g\\
-& =_G & g^{-1}u_Laz a^{-1}(u_L)^{-1}g
+& =_G & (u^i)^g \\
+& =_G & (u_C^i)^{(u_L)^{-1}g} \\
+& =_G & z^{a^{-1}(u_L)^{-1}g}
 \end{eqnarray*} so that $a^{-1}(u_L)^{-1}gb^{-1} \in C_G(z)$, and so is equal in $G$ to $y^ny_1h$ where $n$ is some integer, $h$ is a word of length at most $2\delta$ and $y_1$ is a prefix of $y$ that depends only on $h$. Therefore $g=_Gu_Lay^ny_1hb$.
 
 This fact is used in the following algorithm which returns a word $p$ of length $O(|u|)$, a short-lex straight word $y$ of length $O(|u|)$ and a set $S$ of at most $V$ words each of length $O(|u| + |v|)$ such that if $g^{-1}ug =_Gv$ then $g=_Gpy^ns$ for some $n \in \mathbb{Z}$ and some $s\in S$.
 
 \begin{algorithm}
 \label{algorithm:getconjugationcandidateshe}
-\caption{Find a ``nice'' set of candidates for conjugation elements}
+Find a ``nice'' set of candidates for conjugating elements.
 \begin{algorithmic}[1]
 \Function{GetConjugationCandidatesHE}{$u, v$}
 \Statex \textbf{Input:} Two $X$-words $u$ and $v$ which label geodesics in $\Gamma$ and have $|u_C|_G > 2L$ and $|v_C|_C > 2L$
 \Statex \textbf{Output:} An $X$-word $p$, a short-lex straight word $y$ and a set $S$ with $(u^p)^i = y^j$ for some $i, j \in \mathbb{Z}$ and such that $\slex{w} \in \{ \slex{py^ns} : n \in \mathbb{Z}, s \in S \}$ whenever $u^w =_G v$.
-\State $a, i \gets$ \Call{FindSLSPower}{$u_C$}
+\State $a, i \gets$ \Call{FindSLSPower}{$\slex(u_C)$}
 \State $z \gets \pi(a^{-1}(u_C)^ia)$
 \State $b \gets$ \Call{TestConjugacySLSLong}{$z, \pi((v_C)^i)$}
 \If{$b$ is null}
@@ -705,19 +702,19 @@
 \end{eqnarray*} Recall that $|w| \le 2L$, $\lambda = |w|V$ and $\epsilon = 2|w|^2V^2+2|w|V$, so \begin{eqnarray*}
         e(\frac{D - \delta}{2})
 & \ge & (12+12+12+12)10^4\delta^2 L^2 V^2 \\
-& \ge & 12\times10^4\delta^2 L^2 V^2 + 12\times10^4\delta^2 L^2 V^2 + 12\times10^4\delta^2 L^2 V^2 + 12\times10^4\delta^2 L^2 V^2 \\
+&  =  & 12\times10^4\delta^2 L^2 V^2 + 12\times10^4\delta^2 L^2 V^2 + 12\times10^4\delta^2 L^2 V^2 + 12\times10^4\delta^2 L^2 V^2 \\
 & \ge & 4\times10^4\delta^2 LV + 12LV \times10^4 \delta^2 LV + 8L^2 V^2 + 4LV \\
 & \ge & 4\times10^4\delta^2 LV + 6|w|V \times10^4\delta^2LV + 2|w|^2V^2 + 2|w|V \\
 &  =  & 4D + 6\lambda D + \epsilon.
 \end{eqnarray*}
 
-Thus picking $n \in \mathbb{N}$ and some geodesic path $\gamma = \path{\vertex{e}}{\vertex{e} \cdot w^n}$, by Proposition \ref{prop:qgeo_close_to_geo} each point on $\gamma$ lies within $D$ of some point on $\alpha = \wordpath{\vertex{e}}{w^n}$.
+Thus picking a geodesic path $\alpha := \path{\vertex{e}}{\vertex{e} \cdot w^M}$, by Proposition \ref{prop:qgeo_close_to_geo} each point on $\alpha$ lies within $D$ of some point on $\gamma = \widetilde{w^\infty}$.
 
 Let $\vertex{x} := \vertex{e}$, $\vertex{y} := \vertex{x} \cdot w^M$ and $\vertex{z} := \vertex{y} \cdot w^M$, recalling that $M =10^3\delta^2 L^3V^2$. Let $\path{\vertex{x}}{\vertex{y}}$ and $\path{\vertex{y}}{\vertex{z}}$ be labelled $u := \slex(w^M)$ and let $\vertex{p} := \vertex{x} \cdot u_L$ and $\vertex{q} := \vertex{y} \cdot u_L$. See figure \ref{figure:make_long}.
 
 \begin{figure}
 \begin{center}
-\input fig3_make_long.pstex_t
+\input make_long.pstex_t
 \caption{Cutting across a long quasigeodesic}
 \label{figure:make_long}
 \end{center}
@@ -729,7 +726,7 @@
 & \ge & d(\vertex{p'},\vertex{q'}) - 2D \\
 & \ge & \frac{d_\gamma(\vertex{p'}, \vertex{q'})}{\lambda} - \epsilon - 2D \\
 &  =  & \frac{|w|M}{\lambda} - \epsilon - 2D.
-\end{eqnarray*} We now substitute in the value of $M$, $\lambda$ and $\epsilon$ to find \begin{eqnarray*}
+\end{eqnarray*} We now substitute in the values of $M$, $\lambda$ and $\epsilon$ to find \begin{eqnarray*}
         |u_C|
 & \ge & \frac{|w|LV^2D}{20|w|V} - 2|w|^2V^2 - 2|w|V - 2D \\
 &  =  & \frac{LVD}{20} - 2|w|^2V^2 - 2|w|V - 2D,
@@ -739,7 +736,7 @@
 &  =  & LV(500 \delta^2LV - 8LV - 4 - 20000\delta^2).
 \end{eqnarray*} Note that $V \ge 2\delta + 1 \ge 5$ and $L = 34\delta +2 \ge 36$, so $VL \ge 180$ and \begin{eqnarray*}
         |u_C|
-& \ge & LV((8 + 6 + 486)\delta^2LV - 8LV - 4 - 20000\delta^2).
+& \ge & LV((8 + 6 + 486)\delta^2LV - 8LV - 4 - 20000\delta^2) \\
 &  =  & LV(8\delta^2LV - 8LV + 6\delta^2LV - 4 + 486\delta^2LV - 20000 \delta^2) \\
 &  >  & LV((8LV - 8LV) + (6 - 4) + (87480 \delta^2 - 20000 \delta ^2)) \\
 &  >  & 2L
@@ -752,13 +749,13 @@
 
 By this proposition, short infinite order words can be raised to large powers to get an appropriate input for \textsc{GetConjugationCandidatesHE}. We also wish to confirm that words which are already appropriate inputs stay appropriate when raised to the power of $M$.
 
-\begin{lemma}
-\label{lemma:long_stays_long}
+\begin{proposition}
+\label{prop:long_stays_long}
 Suppose that $w$ is a word and $|w_C| > 2L$. If $n \ge L$ then $|(\slex((w_C)^n))_C| > 2L$. In particular, $|(\slex((w_C)^M))_C| > 2L$.
-\end{lemma}
+\end{proposition}
 
 \begin{proof}
-Let $r:=\slex((w_C)^n)$, and let $\gamma$ be the path starting at $\vertex{x} := \vertex{e}$ labelled by $(w_C)^{2n}$. Let $\vertex{y} := \vertex{y} \cdot r$ and let $\vertex{z} := \vertex{y} \cdot r$. Now let $\vertex{p} := \vertex{x} \cdot r_L$ and let $\vertex{q} := \vertex{y} \cdot r_L$ so that $p$ and $q$ are mid-vertices on the short-lex geodesic paths $\path{\vertex{x}}{\vertex{y}}$ and $\path{\vertex{y}}{\vertex{z}}$ respectively and $r_C$ labels a path from $\vertex{p}$ to $\vertex{q}$.
+Let $r:=\slex((w_C)^n)$, and let $\gamma$ be the path starting at $\vertex{x} := \vertex{e}$ labelled by $(w_C)^{2n}$. Let $\vertex{y} := \vertex{y} \cdot r$ and let $\vertex{z} := \vertex{y} \cdot r$. Now let $\vertex{p} := \vertex{x} \cdot r_L$ and let $\vertex{q} := \vertex{y} \cdot r_L$ so that $p$ and $q$ are mid-vertices on the short-lex geodesic paths $\path{\vertex{x}}{\vertex{y}}$ and $\path{\vertex{y}}{\vertex{z}}$ respectively and $r_C$ labels a path from $\vertex{p}$ to $\vertex{q}$. Figure \ref{figure:make_long} provides a suitable demonstration once again.
 
 Note that $\gamma$ is an $L$-local $(1, 2\delta)$-quasigeodesic by Proposition \ref{prop:short_conj}, so Proposition \ref{prop:nice_qgeo} applies. Then there is a vertex $\vertex{p'} = \vertex{x} \cdot (w_C)^n(i)$ for some $i$ with $d(\vertex{p'}, \vertex{p}) \le 4\delta$. Let $\vertex{q'} := \vertex{y} \cdot (w_C)^n(i)$ so that $d(\vertex{q'}, \vertex{q}) \le 4\delta$ also. Since $d_\gamma(\vertex{p'}, \vertex{q'}) = n|w_C| \ge L$, Proposition \ref{prop:nice_qgeo} also gives a lower bound on $d(\vertex{p'}, \vertex{q'})$ as follows: \begin{eqnarray*}
         d(\vertex{p}, \vertex{q})
@@ -780,13 +777,13 @@
 
 By the above 2 results $|(\slex((u_C)^M))_C|_G > 2L$ for any infinite order word $u$ which labels a geodesic in $\Gamma$. In particular, if $u$ and $v$ label geodesics in $\Gamma$ and are of infinite order in $G$ then \textsc{GetConjugationCandidatesHE} can be applied to $\slex((u_C)^M)$ and $\slex((v_C)^M)$ by executing \textsc{GetConjugationCandidates}$(u, v)$ as defined in the following pseudocode:
 
-\begin{algorithm}[h]
+\begin{algorithm}
 \label{algorithm:getconjugationcandidates}
-\caption{Find candidates for conjugation elements}
+Find candidates for conjugation elements.
 \begin{algorithmic}[1]
 \Function{GetConjugationCandidates}{$u, v$}
-\Statex \textbf{Input:} Two $X$-words $u$ and $v$ which are of infinite order and are short-lex least in $G$.
-\Statex \textbf{Output:} An $X$-word $p$, a short-lex straight word $y$ and a set $S$ with $(u^p)^i = y^j$ for some $i, j \in \mathbb{Z}$ and such that $\slex{w} \in \{ \slex{py^ns} : n \in \mathbb{Z}, s \in S \}$ whenever $u^w =_G v$.
+\Statex \textbf{Input:} Two $X$-words $u$ and $v$ which are of infinite order in $G$.
+\Statex \textbf{Output:} An $X$-word $p$, a short-lex straight word $y$ and a set $S$ such that $w$ is equal in $G$ to an element of $\{ \slex(py^ns) : n \in \mathbb{Z}, s \in S \}$ whenever $u^w =_G v$.
 \State $u' \gets \slex(u)$
 \State $v' \gets \slex(v)$
 \State $c \gets \slex((u'_C)^M)$
@@ -801,130 +798,126 @@
 
 \begin{corollary}
 \label{cor:find_sls_and_conj_form}
-Suppose $u$ and $v$ are $X$-words which are conjugate and infinite order in $G$. Then there exists an integer $k \le MQ^2$ and an $X$-word $w$ of length at most $(M+1)|u| + 4\delta$ such that $z := \slex((u^k)^w)$ is short-lex straight.
+Suppose $u$ and $v$ are $X$-words which are conjugate and infinite order in $G$. Then there exists an integer $k \le MQ^2$ and an $X$-word $w$ of length at most $(M+1)|u| + 4\delta$ such that $z := \slex((u^k)^w)$ is short-lex straight. Finding $w$ takes time $O(|w|)$.
+
 Further, any element $g \in G$ with $u^g =_G v$ has $g =_G u^ih$ where $i$ is an integer and $h$ is an $X$-word of length at most $3MQ^2(|u|+|v|)+12\delta$.
 \end{corollary}
 
 \begin{proof}
-Let $u_1 := \slex(u)$, let $u_2 := \slex(((u_1)_C)^M)$ and let $u_3 := \slex((u_2)_C)$. By Proposition \ref{prop:make_long} or Lemma \ref{lemma:long_stays_long} we know that $|u_3| > 2L$.
+Let $u_1 := \slex(u)$, let $u_2 := \slex(((u_1)_C)^M)$ and let $u_3 := \slex((u_2)_C)$. By Proposition \ref{prop:make_long} or Proposition \ref{prop:long_stays_long} we know that $|u_3| > 2L$.
 
-By Proposition \ref{prop:short_conj}, all positive powers of $u_3$ label $L$-local $(1, 2\delta)$-quasigeodesics and then by Proposition \ref{prop:long_conj_slex} we know that $u_4 := k^{-1}u_3^lk$ is short-lex straight for some $l \le Q^2$ and some $X$-word $k$ of length at most $4\delta$. Notice that $u_4 =_G (u^{lM})^{w_u}$ where $w_u := k(u_2)_L(u_1)_L$ so that $|w_u| \le \frac{(M+1)|u|}{2}+4\delta$. This proves the first part.
+By Proposition \ref{prop:short_conj}, all positive powers of $u_3$ label $L$-local $(1, 2\delta)$-quasigeodesics and then by Proposition \ref{prop:long_conj_slex} we know that $u_4 := \slex(k^{-1}u_3^lk)$ is short-lex straight for some $l \le Q^2$ and some $X$-word $k$ of length at most $4\delta$. Notice that $u_4 =_G (u^{lM})^{w_u}$ where $w_u := k(u_2)_L(u_1)_L$ so that $|w_u| \le \frac{(M+1)|u|}{2}+4\delta$. This proves the first part.
 
 Suppose $u_4 = u_5^l$ for some integer $l$ (which we assume is maximal for this property). By Proposition \ref{prop:find_centraliser_sls} there is a set $S$ containing elements of the form $yp$, where $p$ is an $X$-word of length at most $2\delta$ and $y$ is a prefix of $u_5$ which depends only on $p$, such that every element of the centraliser of $u_4$ is of the form $u_5^iyp$. This is equal to $u_4^iu_5^jyp$ for some integers $i$ and $j$ with $0 \le j < l$ and some $yp \in S$. Notice that $|u_5^jyp| \le |u_4| + 2\delta \le MQ^2|u| + 2\delta$.
 
-Construct $v_1$, $v_2$ and $v_3$ in the same way as $u_1$ through $u_3$, setting $w_v := (v_2)_L(u_1)_L$. Since $u$ and $v$ are conjugate, so are $u_4$ and $v_3^l$, so by Proposition \ref{prop:test_conj_sls} there is an $X$-word $h$ with $|h| \le 6\delta$ such that $u_4^h =_G v_3^l$. Now any element of $G$ conjugating $u_4$ to $v_3^l$ is of the form $u_5^iyph$ for some integer $i$ and some $yp \in S$. Then $g$ must be equal to $w_uu_4^iu_5^jyphw_v^{-1} =_G u^{lM}w_uu_5^jyphw_v^{-1}$ and $|w_uu_5^jyphw_v^{-1}| \le \frac{(M+1)((2Q^2+1)|u| + |v|)}{2} + 12\delta \le 3MQ^2(|u|+|v|)+12\delta$.
+Construct $v_1$, $v_2$ and $v_3$ in the same way as $u_1$ through $u_3$, setting $w_v := (v_2)_L(u_1)_L$. Since $u$ and $v$ are conjugate, so are $u_4$ and $v_3^l$, so by Proposition \ref{prop:test_conj_sls} there is an $X$-word $h$ with $|h| \le 6\delta$ such that $u_4^h =_G v_3^l$. Now any element of $G$ conjugating $u_4$ to $v_3^l$ is of the form $u_5^iyph$ for some integer $i$ and some $yp \in S$. Then $g$ must be equal to $w_uu_4^iu_5^jyphw_v^{-1} =_G u^{lMi}w_uu_5^jyphw_v^{-1}$ and $|w_uu_5^jyphw_v^{-1}| \le \frac{(M+1)((2Q^2+1)|u| + |v|)}{2} + 12\delta \le 3MQ^2(|u|+|v|)+12\delta$.
 \end{proof}
 
 We also have a method of checking whether an element is of finite order.
 
 \begin{corollary}
 \label{corollary:test_fin_ord}
-It is possible to test whether a word $w$ is finite or infinite order in time $O(|w|)$.
+There is an algorithm \textsc{TestInfOrder} which tests whether or not an input word $w$ is of infinite order in $G$ and runs in time $O(|w|)$.
 \end{corollary}
 
 \begin{proof}
-First reduce $w$ to a short-lex least word $w'$. Now if $|(w_C^M)_C|_G > 2L$ then $w_C^M$ and therefore $w$ is of infinite order. If not, $w$ cannot be of infinite order.
+First reduce $w$ to a short-lex least word $w'$. Now if $|(\slex(w_C^M))_C|_G > 2L$ then $w_C^M$ and therefore $w$ is of infinite order by Proposition \ref{prop:short_conj} and we return false. If not, $w$ cannot be of infinite order by Proposition \ref{prop:make_long} or Proposition \ref{prop:long_stays_long}.
+
+Since $|w_C^M| \le M|w|$, this test takes time at worst $O(|w|)$.
 \end{proof}
 
-Thus we have the following algorithm:
+Using \textsc{GetConjugationCandidatesHE} we will later reduce the conjugacy problem for lists to testing, for input words $u$ and $v$, which powers of a short-lex straight word conjugate $u$ to $v$. This testing process is the concern of the next two subsections.
 
-\begin{algorithm}[h]
-\label{algorithm:testinforder}
-\caption{Test whether or not an input word is infinite order in $G$}
-\begin{algorithmic}[1]
-\Function{TestInfOrder}{$u$}
-\Statex \textbf{Input:} An $X$-word $u$.
-\Statex \textbf{Output:} True if $u$ is infinite order in $G$, false otherwise.
-\State $u' \gets \slex(u)$
-\State $c \gets \slex((u'_C)^M)$
-\If{$|c| > 2L$}
-	\State \textbf{return} true
-\Else
-	\State \textbf{return} false
-\EndIf
-\end{algorithmic}
-\end{algorithm}
-
-Using \textsc{GetConjugationCandidatesHE} we will later reduce the conjugacy problem for lists to testing, for input words $u$ and $v$, which powers of a short-lex straight word conjugate $u$ to $v$. This is the concern of the next subsection.
-
 \subsection{Conjugating by a power of a short-lex straight word}
 
-In this subsection, we suppose that we are given an $X$-word $u$ which labels a geodesic in $\Gamma$ and a short-lex straight word $y$. We wish to find a useful description of the conjugates $u^{y^n}$.
+In this subsection, we suppose that we are given an $X$-word $g$ which labels a geodesic in $\Gamma$ and a short-lex straight word $y$. We wish to find a useful description of the conjugates $g^{y^n}$.
 
-We begin by proving a result which is true of general hyperbolic metric spaces.
+We begin by proving a result which is true of general vertex-hyperbolic metric spaces.
 
 \begin{figure}
 \begin{center}
-\input fig10_quad.pstex_t
-\caption{The thin section of a geodesic quadrilateral}
-\label{figure:thin_section}
+\input thin_quad.pstex_t
+\caption{A geodesic quadrilateral}
+\label{figure:thin_quad}
 \end{center}
 \end{figure}
 
 \begin{figure}
 \begin{center}
-\input fig11_quad_zoom.pstex_t
-\caption{A part of figure \ref{figure:thin_section}}
-\label{figure:quad_zoom}
+\input thin_quad_zoom.pstex_t
+\caption{A thin part of a quadrilateral}
+\label{figure:thin_quad_zoom}
 \end{center}
 \end{figure}
 
+\begin{figure}
+\begin{center}
+\input quad_end.pstex_t
+\caption{Points after the meeting points are distant}
+\label{figure:quad_end}
+\end{center}
+\end{figure}
+
 \begin{lemma}
 \label{lemma:trapezium}
-Let $\vertex{c}$, $\vertex{d}$, $\vertex{e}$ and $\vertex{f}$ be vertices in $\Gamma$ such that $l:= d(\vertex{c}, \vertex{d}) = d(\vertex{e}, \vertex{f})$. Let $\alpha_1 : [0, l] \to \Gamma$ be a geodesic path from $\vertex{c}$ to $\vertex{d}$ and let $\alpha_2 : [0, l] \to \Gamma$ be a geodesic path from $\vertex{f}$ to $\vertex{e}$. Define the constants \begin{eqnarray*}
-K & := & d(\vertex{c}, \vertex{d}) - d(\vertex{d}, \vertex{f})  \\
-N_1 & := & (\vertex{c}, \vertex{d})_{\vertex{f}} \\ 
-N_2 & := & (\vertex{d}, \vertex{e})_{\vertex{f}}.
+Let $\vertex{a}$, $\vertex{b}$, $\vertex{c}$ and $\vertex{d}$ be vertices in $\Gamma$ such that $l:= d(\vertex{a}, \vertex{b}) = d(\vertex{c}, \vertex{d})$. Let $\alpha_1 : [0, l] \to \Gamma$ be a geodesic path from $\vertex{a}$ to $\vertex{b}$ and let $\alpha_2 : [0, l] \to \Gamma$ be a geodesic path from $\vertex{d}$ to $\vertex{c}$ as in Firgure \ref{figure:thin_quad}.
+
+Define the constants \begin{eqnarray*}
+K & := & d(\vertex{a}, \vertex{b}) - d(\vertex{b}, \vertex{d})  \\
+N_1 & := & (\vertex{a}, \vertex{b})_{\vertex{d}} \\ 
+N_2 & := & (\vertex{b}, \vertex{c})_{\vertex{d}}.
 \end{eqnarray*}
 
 For $i \in \mathbb{N}$:
 \begin{enumerate}
 \item If $N_1 \le i \le N_2$ then \[ d(\alpha_2(i), \alpha_1(i+K)) \le 2\delta. \]
 \item If $N_1 + K \le i \le N_2 + K$ then \[ d(\alpha_2(i-K), \alpha_1(i)) \le 2\delta. \]
-\item If $l \ge i \ge \max\{N_1 + K, N_2, N_2 +K\}$ then \[ d(\alpha_1(i), \alpha_2(i)) =^{3\delta} d(\vertex{d}, \vertex{e}) - 2 (l - i). \]
+\item If $l \ge i \ge \max\{N_1 + K, N_2, N_2 +K\}$ then \[ d(\alpha_1(i), \alpha_2(i)) =^{3\delta} d(\vertex{b}, \vertex{c}) - 2 (l - i). \]
 \end{enumerate}
 
-If $l \ge i \ge d(\vertex{c}, \vertex{f})$ then at least one of these three cases applies.
+If $l \ge i \ge d(\vertex{a}, \vertex{d})$ then at least one of these three cases applies.
 \end{lemma}
 
 \begin{proof}
-Pick a geodesic $\gamma := \path{\vertex{d}}{\vertex{f}}$ so that we have two geodesic triangles, one with corners $\vertex{c}$, $\vertex{d}$, and $\vertex{f}$; the other with corners $\vertex{d}$, $\vertex{f}$ and $\vertex{e}$; both sharing a common side $v$. Also, let $\vertex{p}:= \alpha_2(i)$ and $\vertex{q}:= \alpha_1(i)$.
+Pick a geodesic $\gamma := \path{\vertex{b}}{\vertex{d}}$ so that we have two geodesic triangles, one with corners $\vertex{a}$, $\vertex{b}$, and $\vertex{d}$; the other with corners $\vertex{b}$, $\vertex{d}$ and $\vertex{c}$; both sharing a common side $v$. Also, let $\vertex{p}:= \alpha_2(i)$ and $\vertex{q}:= \alpha_1(i)$.
 
-Suppose that $N_1 \le i \le N_2$. Note that $\vertex{p}$ corresponds to some point $\vertex{q''}$ on $\gamma$ which in turn corresponds to some point $\vertex{q'}$ on $\alpha_1$. Observe that \begin{eqnarray*}
-      d(\vertex{c}, \vertex{q'})
-& = & d(\vertex{c}, \vertex{d}) - d(\vertex{d}, \vertex{q'}) \\
-& = & d(\vertex{c}, \vertex{d}) - d(\vertex{d}, \vertex{q''}) \\
-& = & d(\vertex{c}, \vertex{d}) - d(\vertex{d}, \vertex{f}) + d(\vertex{f}, \vertex{q''}) \\
-& = & d(\vertex{c}, \vertex{d}) - d(\vertex{d}, \vertex{f}) + d(\vertex{f}, \vertex{p}) \\
-& = & K + d(\vertex{f}, \vertex{p}) \\
+Suppose that $N_1 \le i \le N_2$. Note that $\vertex{p}$ corresponds to some point $\vertex{q''}$ on $\gamma$ which in turn corresponds to some point $\vertex{q'}$ on $\alpha_1$ as illustrated in Figure \ref{figure:thin_quad_zoom}. Observe that \begin{eqnarray*}
+      d(\vertex{a}, \vertex{q'})
+& = & d(\vertex{a}, \vertex{b}) - d(\vertex{b}, \vertex{q'}) \\
+& = & d(\vertex{a}, \vertex{b}) - d(\vertex{b}, \vertex{q''}) \\
+& = & d(\vertex{a}, \vertex{b}) - d(\vertex{b}, \vertex{d}) + d(\vertex{d}, \vertex{q''}) \\
+& = & d(\vertex{a}, \vertex{b}) - d(\vertex{b}, \vertex{d}) + d(\vertex{d}, \vertex{p}) \\
+& = & K + d(\vertex{d}, \vertex{p}) \\
 & = & K + i \\
-& = & K + d(\vertex{c}, \vertex{q}),
+& = & K + d(\vertex{a}, \vertex{q}),
 \end{eqnarray*} so $\vertex{q'} = \alpha_1(i+K)$, and a geodesic path between $\vertex{p}$ and $\vertex{q'}$ has length at most $2\delta$ as required in the first case. 
 
 In the second case, note that \begin{align}
     N_1 + K 
-& = \frac{d(\vertex{f}, \vertex{c}) + d(\vertex{f}, \vertex{d}) - d(\vertex{c}, \vertex{d})}{2} + d(\vertex{c}, \vertex{d}) - d(\vertex{d}, \vertex{f}) \notag\\
-& = \frac{d(\vertex{c}, \vertex{f}) + d(\vertex{c}, \vertex{d}) - d(\vertex{d}, \vertex{f})}{2} \notag\\
-& = (\vertex{d}, \vertex{f})_{\vertex{c}}, \tag{*}
-\end{align} the distance from $\vertex{c}$ to the meeting point on $\alpha_1$. Thus, $\vertex{q}$ corresponds to a point $\vertex{p''}$ on $\gamma$, and \begin{eqnarray*}
-        d(\vertex{f}, \vertex{p''})
-&  =  & d(\vertex{d},\vertex{f})-d(\vertex{d},\vertex{p''}) \\
-&  =  & d(\vertex{d},\vertex{f})-d(\vertex{d},\vertex{q}) \\
-&  =  & d(\vertex{d},\vertex{f})-d(\vertex{c},\vertex{d})+d(\vertex{c},\vertex{q}) \\
+& = \frac{d(\vertex{d}, \vertex{a}) + d(\vertex{d}, \vertex{b}) - d(\vertex{a}, \vertex{b})}{2} + d(\vertex{a}, \vertex{b}) - d(\vertex{b}, \vertex{d}) \notag\\
+& = \frac{d(\vertex{a}, \vertex{d}) + d(\vertex{a}, \vertex{b}) - d(\vertex{b}, \vertex{d})}{2} \notag\\
+& = (\vertex{b}, \vertex{d})_{\vertex{a}}, \tag{*}
+\end{align} the distance from $\vertex{a}$ to the meeting point on $\alpha_1$. Thus, $\vertex{q}$ corresponds to a point $\vertex{p''}$ on $\gamma$, and \begin{eqnarray*}
+        d(\vertex{d}, \vertex{p''})
+&  =  & d(\vertex{b},\vertex{d})-d(\vertex{b},\vertex{p''}) \\
+&  =  & d(\vertex{b},\vertex{d})-d(\vertex{b},\vertex{q}) \\
+&  =  & d(\vertex{b},\vertex{d})-d(\vertex{a},\vertex{b})+d(\vertex{a},\vertex{q}) \\
 &  =  & i-K \\
 & \le & N_2,
-\end{eqnarray*} so $\vertex{p''}$ corresponds to a point $\vertex{p'}$ on $\alpha_2$ with $d(\vertex{f}, \vertex{p'}) = d(\vertex{f}, \vertex{p''}) = i - K$. Therefore $\vertex{p'} = \alpha_2(i-K)$ and the distance between $\vertex{p'}$ and $\vertex{q}$ is at most $2\delta$ as required in the second case.
+\end{eqnarray*} so $\vertex{p''}$ corresponds to a point $\vertex{p'}$ on $\alpha_2$ with $d(\vertex{d}, \vertex{p'}) = d(\vertex{d}, \vertex{p''}) = i - K$. Therefore $\vertex{p'} = \alpha_2(i-K)$ and the distance between $\vertex{p'}$ and $\vertex{q}$ is at most $2\delta$ as required in the second case.
 
-Now suppose that $i \ge \max\{N_1 + K, N_2, N_2 + K\}$. Let $\beta$ be a geodesic from $\vertex{d}$ to $\vertex{e}$. Then $d(\vertex{f}, \vertex{p}) \ge N_2$, so $\vertex{p}$ corresponds to a point $\vertex{p'}$ on $\beta$. Similarly, $d(\vertex{c},\vertex{q}) \ge N_1+K=(\vertex{d},\vertex{f})_{\vertex{c}}$ by (*) so $\vertex{q}$ corresponds to a point $\vertex{q''}$ on $\gamma$ with $d(\vertex{f}, \vertex{q''}) = i - K \ge N_2$, which in turn corresponds to a point $\vertex{q'}$ on $\beta$. Now, \begin{eqnarray*}
+Now suppose that $i \ge \max\{N_1 + K, N_2, N_2 + K\}$. Let $\beta$ be a geodesic from $\vertex{b}$ to $\vertex{c}$. Then $d(\vertex{d}, \vertex{p}) \ge N_2$, so $\vertex{p}$ corresponds to a point $\vertex{p'}$ on $\beta$. Similarly, $d(\vertex{a},\vertex{q}) \ge N_1+K=(\vertex{b},\vertex{d})_{\vertex{a}}$ by (*) so $\vertex{q}$ corresponds to a point $\vertex{q''}$ on $\gamma$ with $d(\vertex{d}, \vertex{q''}) = i - K \ge N_2$, which in turn corresponds to a point $\vertex{q'}$ on $\beta$. This is illustrated in Figure \ref{figure:quad_end}.
+
+Now, \begin{eqnarray*}
       d(\vertex{p'}, \vertex{q'})
-& = & d(\vertex{d}, \vertex{p'}) - d(\vertex{d}, \vertex{q'}) \\
-& = & d(\vertex{d}, \vertex{e}) - d(\vertex{e}, \vertex{p}) - d(\vertex{d}, \vertex{q'}) \\
-& = & d(\vertex{d}, \vertex{e}) - d(\vertex{d}, \vertex{q}) - d(\vertex{d}, \vertex{q}) \\
-& = & d(\vertex{d}, \vertex{e}) - 2d(\vertex{d}, \vertex{q}) \\
-& = & d(\vertex{d}, \vertex{e}) - 2(d(\vertex{c}, \vertex{d}) - i),
-\end{eqnarray*} so $d(\alpha_1(i), \alpha_2(i)) =^{3\delta} d(\vertex{d}, \vertex{e}) - 2(l-i)$ as required.
+& = & d(\vertex{b}, \vertex{p'}) - d(\vertex{b}, \vertex{q'}) \\
+& = & d(\vertex{b}, \vertex{c}) - d(\vertex{c}, \vertex{p}) - d(\vertex{b}, \vertex{q'}) \\
+& = & d(\vertex{b}, \vertex{c}) - d(\vertex{b}, \vertex{q}) - d(\vertex{b}, \vertex{q}) \\
+& = & d(\vertex{b}, \vertex{c}) - 2d(\vertex{b}, \vertex{q}) \\
+& = & d(\vertex{b}, \vertex{c}) - 2(d(\vertex{a}, \vertex{b}) - i),
+\end{eqnarray*} so $d(\alpha_1(i), \alpha_2(i)) =^{3\delta} d(\vertex{b}, \vertex{c}) - 2(l-i)$ as required.
 
-For the last statement, assume that $i \ge d(\vertex{c}, \vertex{f})$ and that the first two cases do not apply. Since $i \ge d(\vertex{c}, \vertex{f}) \ge (\vertex{c}, \vertex{d})_{\vertex{f}} = N_1$, we have $i > N_2$ or we are in Case $1$. Similarly, (*) gives us $i \ge d(\vertex{c}, \vertex{f}) \ge (\vertex{d}, \vertex{f})_{\vertex{c}} = N_1 + K$, so $i > N_2 + K$ or we are in Case 2. Therefore $i \ge \max\{N_1+K, N_2, N_2 + K\}$ and we are in Case 3; in particular $l \ge i \ge d(\vertex{c}, \vertex{f})$ implies that one of the three cases applies.
+For the last statement, assume that $i \ge d(\vertex{a}, \vertex{d})$ and that the first two cases do not apply. Since $i \ge d(\vertex{a}, \vertex{d}) \ge (\vertex{a}, \vertex{b})_{\vertex{d}} = N_1$, we have $i > N_2$ or we are in Case $1$. Similarly, (*) gives us $i \ge d(\vertex{a}, \vertex{d}) \ge (\vertex{b}, \vertex{d})_{\vertex{a}} = N_1 + K$, so $i > N_2 + K$ or we are in Case 2. Therefore $i \ge \max\{N_1+K, N_2, N_2 + K\}$ and we are in Case 3; in particular $l \ge i \ge d(\vertex{a}, \vertex{d})$ implies that one of the three cases applies.
 \end{proof}
 
 This lemma allows some results about conjugates to be shown. In particular, simply building the construction above in the group for some large power of a conjugating word gives computable estimates on the lengths of all smaller power conjugates, and a constraint on the form of those conjugates which are ``short.'' Recall that $\canc{u}{v} = (\vertex{a} \cdot u, \vertex{a} \cdot v)_{\vertex{a}}$ for $X$-words $u$ and $v$.
@@ -934,9 +927,9 @@
 Suppose that $y$ is a straight word and that $g$ is labels a geodesic in $\Gamma$. Let $n \in \mathbb{N}$, let $K := |y|n - |gy^n|_G$ and let $0 \le j \le n$.
 
 \begin{enumerate}
-\item If $\canc{g}{gy^n} \le |y|j \le \canc{gy^n}{y^n}$ then $y^{-j}gy^j =_G h(y^\infty(K))^{-1}$ for some word $h$ with $|h| \le 2\delta$. 
-\item If $\canc{g}{gy^n} + K \le |y|j \le \canc{gy^n}{y^n} + K$ then $y^{-j}gy^j =_G y^\infty(-K)h$ for some word $h$ with $|h| \le 2\delta$. 
-\item If $|y|n \ge |y|j \ge \max \{\canc{gy^n}{y^n}, \canc{g}{gy^n} + K, (gy^n, y^n)_1 + K\}$ then $|y^{-j}gy^j|_G =^{3\delta} |y^{-n}gy^n|_G - 2|y|(n -j)$.
+\item If $\canc{g}{gy^n} \le |y|j \le \canc{gy^n}{y^n}$ then $g^{y^j} =_G h(y^\infty(K))^{-1}$ for some word $h$ with $|h| \le 2\delta$. 
+\item If $\canc{g}{gy^n} + K \le |y|j \le \canc{gy^n}{y^n} + K$ then $g^{y^j} =_G y^\infty(-K)h$ for some word $h$ with $|h| \le 2\delta$. 
+\item If $|y|n \ge |y|j \ge \max \{\canc{gy^n}{y^n}, \canc{g}{gy^n} + K, \canc{gy^n}{y^n} + K\}$ then $|g^{y^j}|_G =^{3\delta} |g^{y^n}|_G - 2|y|(n -j)$.
 \end{enumerate}
 
 If $|y|j \ge |g|$ then at least one of the three cases applies.
@@ -945,42 +938,44 @@
 \begin{proof}
 Let $\vertex{c} := \vertex{a} \cdot g$, $\vertex{d} := \vertex{c} \cdot y^n$, $\vertex{e} := \vertex{a} \cdot y^n$ and $\vertex{f} := \vertex{a}$, and note that the three cases of Lemma \ref{lemma:trapezium} (with $i = |y| j$) correspond exactly to the three cases here.
 
-In the first case, note that $w_1(i+K:i) = y^n (|y|j+K:|y|j) =_G (y^\infty(K))^{-1}$, and we know that $d(w_2(i), w_1(i + K)) \le 2\delta$, so $y^{-j}gy^j =_G w_2(i)^{-1}w_1(i)=_Gh(y^\infty(K))^{-1}$ for some word $h$ of length at most $2\delta$ as required.
+In the first case, note that $w_1(i+K:i) = y^n (|y|j+K:|y|j) =_G (y^\infty(K))^{-1}$, and we know that $d(w_2(i), w_1(i + K)) \le 2\delta$, so $g^{y^j} =_G w_2(i)^{-1}w_1(i)=_Gh(y^\infty(K))^{-1}$ for some word $h$ of length at most $2\delta$ as required.
 
-For the second case, $w_2(i:i - K)=_G y^\infty(-K)$ so by a similar argument $y^{-j}gy^j =_G y^\infty (-K) h$ for some word $h$ at length at most $2\delta$ as required.
+For the second case, $w_2(i:i - K)=_G y^\infty(-K)$ so by a similar argument $g^{y^j} =_G y^\infty (-K) h$ for some word $h$ at length at most $2\delta$ as required.
 
-For the third case, since $d(\vertex{d}, \vertex{e}) = |y^{-j}gy^j|_G$ and $d(\vertex{c}, \vertex{f}) = |y|n$, the third part of this lemma is proved by the third part of Lemma \ref{lemma:trapezium}.
+For the third case, since $d(\vertex{d}, \vertex{e}) = |g^{y^j}|_G$ and $d(\vertex{c}, \vertex{f}) = |y|n$, the third part of this lemma is proved by the third part of Lemma \ref{lemma:trapezium}.
 
 Noting that $|g| = d(\vertex{c}, \vertex{f})$, the last statement again corresponds to the last statement of Lemma \ref{lemma:trapezium}.
 \end{proof}
 
-Recall that we are trying to establish which powers $y^n$ have $u^{y^n} =_G v$. We will start by determining whether a power of $y$ centralises $u$, and thus establish whether or not the set of conjugating powers can be infinite.
+Recall that we are trying to find a useful description of elements $g^{y^n}$. We will start by determining whether a power of $y$ centralises $u$, and thus establish whether or not the set of conjugates is infinite.
 
 Since the conjugates in the first range in Lemma \ref{lemma:long_rectangle} are parametrised by a word of length at most $2\delta$, if a large number of $j$ in this range can be found, some conjugate will repeat and some power of $y$ will indeed be in the centraliser of $g$. The next lemma states this more precisely.
 
 \begin{lemma}
 \label{lemma:thinness_extends}
-Suppose that $y$ is a straight word, that $g$ is any geodesic word in the generators of $G$, and that $N \in \mathbb{Z}$. If $N - \floor{\frac{|g| + |y^{-N}gy^N|_G}{2|y|}} > V$ then there exist constants $d, e$ with $|g| - 2\delta \le d \le |g|$ and $1 \le e \le V$ such that $|y^{-i}gy^i|_G =^{2\delta} d$ for all $i \in \mathbb{Z}$ and $y^e \in C_G(g)$.
+Suppose that $y$ is a straight word, that $g$ is any geodesic word in the generators of $G$, and that $N \in \mathbb{Z}$. If $N - \floor{\frac{|g| + |g^{y^N}|_G}{2|y|}} > V$ then there exist constants $d, e$ with $|g| - 2\delta \le d \le |g|$ and $1 \le e \le V$ such that \[ |g^{y^i}|_G =^{2\delta} d \] for all $i \in \mathbb{Z}$, and \[ y^e \in C_G(g). \]
 \end{lemma}
 
 \begin{proof}
-The number of conjugates $y^{-j}gy^j$ in the first case of Lemma \ref{lemma:long_rectangle} is at least \begin{eqnarray*}
-      \ceil{\frac{\canc{gy^N}{y^N} - \canc{g}{gy^N}}{|y|}}
-& = & \ceil{\frac{|gy^N|_G + |y|N - |y^{-N}gy^N|_G}{2|y|} - \frac{|g| + |gy^N|_G - |y|N}{2|y|}} \\
-& = & \ceil{\frac{2|y|N - |y^{-N}gy^N|_G - |g|}{2|y|}} \\
-& = &  N - \floor{\frac{|g| + |y^{-N}gy^N|_G}{2|y|}}.
-\end{eqnarray*} Let $p:=\frac{(gy^N,y^N)_1}{|y|}$. Since these conjugates are all of the form $h(y^\infty(K))^{-1}$ for words $h \in B_{2\delta}(1)$, if there are more than $V$ of them there must be at least one duplicate, say, $g^{y^i} =_G g^{y^j}$ for some integers $i$ and $j$ with $p + V + 1 > j > i \ge p$. Let $e:=j-i\le V$, so that $g=_G g^{y^iy^{-j}}=_G g^{y^e}$, and $y^e$ is in the centraliser of $g$ as required.
+The number of conjugates $g^{y^j}$ in the first case of Lemma \ref{lemma:long_rectangle} is \begin{eqnarray*}
+&   & \ceil{\frac{\canc{gy^N}{y^N} - \canc{g}{gy^N}}{|y|}} \\
+& = & \ceil{\frac{|gy^N|_G + |y|N - |g^{y^N}|_G}{2|y|} - \frac{|g| + |gy^N|_G - |y|N}{2|y|}} \\
+& = & \ceil{\frac{2|y|N - |g^{y^N}|_G - |g|}{2|y|}} \\
+& = &  N - \floor{\frac{|g| + |g^{y^N}|_G}{2|y|}}.
+\end{eqnarray*}
 
-Since all conjugates $g^{y^k}$ can now be written in the form $g^{y^l}$ for some $p \le l \le p + e \le \canc{gy^N}{y^N}$, Lemma \ref{lemma:long_rectangle} implies that they are all of the form $hy^\infty(-K)$ with $K = |y|n - |gy^n|_G$ as in that lemma, so in particular $|y^{-i}gy^i|_G =^{2\delta} |K|$. Since $g = y^{-0}gy^0$ we have $|g| \le |K| + 2\delta$, and finally $K = |y|n - |gy^n|_G \le |y|n - |y|n + |g| = |g|$ so we may take $d := |K|$ and we are done.
+Let $p:=\frac{\canc{gy^N}{y^N}}{|y|}$. Since these conjugates are all of the form $h(y^\infty(K))^{-1}$ for words $h \in B_{2\delta}(1)$, if there are more than $V$ of them there must be at least one duplicate, say, $g^{y^i} =_G g^{y^j}$ for some integers $i$ and $j$ with $p + V + 1 > j > i \ge p$. Let $e:=j-i\le V$, so that $g=_G g^{y^iy^{-j}}=_G g^{y^e}$, and $y^e$ is in the centraliser of $g$ as required.
+
+Since all conjugates $g^{y^k}$ can now be written in the form $g^{y^l}$ for some $p \le l \le p + e \le \canc{gy^N}{y^N}$, Lemma \ref{lemma:long_rectangle} implies that they are all of the form $hy^\infty(-K)$ with $K = |y|n - |gy^n|_G$ as in that lemma, so in particular $|g^{y^i}|_G =^{2\delta} |K|$. Since $g = g^{y^0}$ we have $|g| \le |K| + 2\delta$, and finally $|K| = \big||y|n - |gy^n|_G\big| \le |g|$ so we may take $d := |K|$ and we are done.
 \end{proof}
 
 The following lemma illustrates that we can test whether some power of $y$ is in the centraliser of $g$ by finding the length of a single group element. 
 
 \begin{lemma}
 \label{lemma:test_centraliser}
-Suppose that $y$ is a straight word and that $g$ is any geodesic word in the generators of $G$. If $N > V + \floor{\frac{|g| + \delta}{|y|}}$ and $|y^{-N}gy^N|_G \le |g| + 2\delta$ then $N - \floor{\frac{|g| + |y^{-N}gy^N|_G}{2|y|}} > V$.
+Suppose that $y$ is a straight word and that $g$ is any geodesic word in the generators of $G$. If $N > V + \floor{\frac{|g| + \delta}{|y|}}$ and $|g^{y^N}|_G \le |g| + 2\delta$ then $N - \floor{\frac{|g| + |g^{y^N}|_G}{2|y|}} > V$.
 
-In particular $|y^{-N}gy^N|_G \le |g| + 2\delta$ if and only if some power of $y$ is in the centraliser of $g$.
+In particular $|g^{y^N}|_G \le |g| + 2\delta$ if and only if some power of $y$ is in the centraliser of $g$.
 \end{lemma}
 
 \begin{proof}
@@ -999,7 +994,7 @@
 \end{eqnarray*} so by Lemma \ref{lemma:thinness_extends} we have $|g^{y^N}|_G \le |g| + 2\delta$ as required.
 \end{proof}
 
-Since we can now detect when some power of $y$ centralises $g$, and since we know the behaviour of conjugates $g^{y^k}$ in this case, it remains to analyse the behaviour of the conjugates where this is not the case. We now show that if no power of $y$ centralises $u$ then the length of conjugates $u^{y^n}$ for large $n$ is very predictable.
+Since we can now detect when some power of $y$ centralises $g$, and since we know the behaviour of conjugates $g^{y^k}$ in this case, it remains to analyse the behaviour of the conjugates when no power of $y$ centralises $g$. We now show that if no power of $y$ centralises $u$ then the length of conjugates $u^{y^n}$ for large $n$ is very predictable.
 
 \begin{lemma}
 \label{lemma:unbd_conj_long}
@@ -1014,11 +1009,11 @@
 
 \begin{proposition}
 \label{proposition:large_power_conjugate}
-Let $g \in G$ and let $y$ be some straight word. Let $N > V + \ceil{\frac{|g| + \delta}{|y|}}$. One of the following is true:
+Let $g \in G$ and let $y$ be some straight word. Let $N > V + \ceil{\frac{|g|_G + \delta}{|y|}}$. One of the following is true:
 
 \begin{enumerate}
-\item \label{case:lpc:central} $|g^{y^N}|_G \le |g| + 2\delta$ and there is some $0 < i \le V$ such that $y^i \in C_G(g)$.
-\item \label{case:lpc:noncentral} $|g^{y^N}|_G > |g| + 2\delta$ and $|g^{y^n}|_G =^{3\delta}|g^{y^N}|_G + 2|y|(n-N)$ for any $n \ge N$. 
+\item \label{case:lpc:central} $|g^{y^N}|_G \le |g|_G + 2\delta$ and there is some $0 < i \le V$ such that $y^i \in C_G(g)$.
+\item \label{case:lpc:noncentral} $|g^{y^N}|_G > |g|_G + 2\delta$ and $|g^{y^n}|_G =^{3\delta}|g^{y^N}|_G + 2|y|(n-N)$ for any $n \ge N$. 
 \end{enumerate}
 \end{proposition}
 
@@ -1029,8 +1024,8 @@
 In this subsection, we suppose we are given $X$-words $u$ and $v$ and a short-lex straight word $y$, and wish to test whether $u^{y^n} =_G v$ for some integer $n$.
 
 \begin{proposition}
-\label{prop:test_conj_sls}
-Let $u, v \in G$ and let $y$ be some straight word. In time $O(|a|+|b|+|y|)$ it is possible to find $r, t \in \mathbb{Z} \cup \{\infty\}$ such that either 
+\label{prop:test_conj_vs_sls}
+Let $u, v \in G$ and let $y$ be some straight word. In time $O(|u|+|v|+|y|)$ it is possible to find $r, t \in \mathbb{Z} \cup \{\infty\}$ such that either 
 
 \begin{enumerate}
 \item \label{case:pl:central}  $0\le r<t\le V$ and $u^{y^j} =_G v$ if and only if $j \equiv r \mod t$,
@@ -1048,7 +1043,7 @@
 
 Now suppose that $l_u \le |u|_G + 2\delta$. By Proposition \ref{proposition:large_power_conjugate}, some power $y^n$ for $n \le V$ centralises $a$, so in particular Case \ref{case:pl:conj} does not apply. Since $V$ is dependent only on the chosen presentation for $G$, it is possible to check for each $0 \le r' < t' \le V$ if $u^{y^{t'}} =_G ua$ or $u^{y^{r'}} =_G v$ in time $O(|a|+|b|+|y|)$. If no $r'$ is found, Case 3 holds so let $r = t = \infty$, otherwise Case 1 holds so pick the lowest values found for $r'$ and $t'$ as $r$ and $t$ respectively.
 
-Finally, suppose that $l_u > |u|_G + 2\delta$. Proposition \ref{proposition:large_power_conjugate} implies that $|u^{y^n}|_G =^{3\delta} l_u + 2|y|(n-N)$ for large $n$, so Case \ref{case:pl:central} cannot apply. In fact, by Proposition  \ref{proposition:large_power_conjugate}, if $u^{y^r} =_G v$ then \begin{eqnarray*}
+Finally, suppose that $l_u > |u|_G + 2\delta$. Proposition \ref{proposition:large_power_conjugate} implies that $|u^{y^n}|_G =^{3\delta} l_u + 2|y|(n-N)$ for large $n$, so Case \ref{case:pl:central} cannot apply and no power of $y$ is in the centraliser of $u$. In fact, by Proposition  \ref{proposition:large_power_conjugate}, if $u^{y^r} =_G v$ then \begin{eqnarray*}
 l_u +2|y|(n-r-N) 
 & =^{3\delta} & |u^{y^{n-r}}|_G \\
 & = & |v^{y^n}|_G \\
@@ -1058,21 +1053,21 @@
 
 We summarise this information in the following algorithm.
 
-\begin{algorithm}[h]
+\begin{algorithm}
 \label{algorithm:testconjugacybysls}
-\caption{Test which powers of a short-lex straight are conjugating elements}
+Test which powers of a short-lex straight are conjugating elements.
 \begin{algorithmic}[1]
 \Function{TestConjugacyBySLS}{$u, v, y$}
-\Statex \textbf{Input:} Two $X$-word $u$ and $v$ and a short-lex straight $X$-word $y$
-\Statex \textbf{Output:} Values $r$ and $s$ as in Proposition \ref{prop:test_conj_sls}
+\Statex \textbf{Input:} Two $X$-words $u$ and $v$ and a short-lex straight $X$-word $y$
+\Statex \textbf{Output:} Values $r$ and $s$ as in Proposition \ref{prop:test_conj_vs_sls}
 \State $u' \gets \slex(u)$
 \State $v' \gets \slex(v)$
 \State $N \gets V + \floor{\frac{|u'|+|v'|+\delta}{|y|}}$
 \State $l_u \gets |u'^{y^N}|_G$
 \State $l_v \gets |v'^{y^N}|_G$
-\If{$l_u \le |u| + 2\delta$}
-	\If{$l_v > |v| + 2\delta$}
-		\textbf{return} $\infty, \infty$
+\If{$l_u \le |u'| + 2\delta$}
+	\If{$l_v > |v'| + 2\delta$}
+		\State \textbf{return} $\infty, \infty$
 	\Else
 		\State $r \gets \infty$ \label{line:in_central_turing}
 		\State $s \gets \infty$
@@ -1090,48 +1085,55 @@
 			\State \textbf{return} $r, s$
 		\EndIf
 	\EndIf
-\Else
-	\State $u \gets \max\{u, \ceil{\frac{l_v-l_u-6\delta}{2|y|}}\}$
-	\State $U \gets \min\{U, \floor{\frac{l_v-l_u+6\delta}{2|y|}}\}$
-	\For{$r \in \{u, \ldots, U\}$}
-		\If{$u^{y^r} =_G v$}
-			\State \textbf{return} $r, \infty$
-		\EndIf
-	\EndFor
-	\State \textbf{return} $\infty, \infty$
+\Else\Comment{If we get here, $l_u > |u'| + 2\delta$}
+	\If{$l_v \le |v'| + 2\delta$}
+		\State \textbf{return} $\infty, \infty$
+	\Else
+		\State $l \gets \ceil{\frac{l_v-l_u-6\delta}{2|y|}}$
+		\State $m \gets \floor{\frac{l_v-l_u+6\delta}{2|y|}}$
+		\For{$r \in \{l, \ldots, m\}$}
+			\If{$u^{y^r} =_G v$}
+				\State \textbf{return} $r, \infty$
+			\EndIf
+		\EndFor
+		\State \textbf{return} $\infty, \infty$
+	\EndIf
 \EndIf
+\EndFunction
 \end{algorithmic}
 \end{algorithm}
 
-Notice that this implementation finds the length of a word, so runs in time $O((|u|+|v|+|y|)\log(|u|+|v|+|y|))$ on a turing machine. By being rather more careful and using a Turing machine with seven tapes, we can avoid this issue and alter the algorithm to run in time $O(|u|+|v|+|y|)$. The trick is that it's not the power of $y$ that counts, but the length of $y^N$. Thus assume we start out with tapes containing $u$, $v$ and $y$.
+%Notice that this implementation finds the length of a word, so runs in time $O((|u|+|v|+|y|)\log(|u|+|v|+|y|))$ on a turing machine. By being rather more careful and using a Turing machine with seven tapes, we can avoid this issue and alter the algorithm to run in time $O(|u|+|v|+|y|)$. The trick is that it's not the power of $y$ that counts, but the length of $y^N$. Thus assume we start out with tapes containing $u$, $v$ and $y$.
 
-On a 4th tape, place $N$ copies of $y^{-1}$, and then place further copies of $y^{-1}$ while simultaneously reading $u$ and $v$. Once we have read more than $2\delta$ units past the longest of $u$ and $v$, complete the current copy of $y$ and reset the first 3 tapes. We now have a suitable power $y^{-N}$ on tape 4, and have produced it in time $O(|u| + |y|)$.
+%On a 4th tape, place $N$ copies of $y^{-1}$, and then place further copies of $y^{-1}$ while simultaneously reading $u$ and $v$. Once we have read more than $2\delta$ units past the longest of $u$ and $v$, complete the current copy of $y$ and reset the first 3 tapes. We now have a suitable power $y^{-N}$ on tape 4, and have produced it in time $O(|u| + |y|)$.
 
-Copy $u$ to the end of the 4th tape, and construct $y^N$ after this and $u^{y^N}$ is on tape 4. Short-lex reduce this using $\slex$ onto tape 5. We can check if $|u^{y^N}|_G > |u| + 2\delta$ by reading tape 5 and $u$ simultaneously and checking if we finish tape within $2\delta$ units of finishing $u$. We have still taken time only $O(|u|+|y|)$. We repeat the steps so far with $v$ on tapes 6 and 7.
+%Copy $u$ to the end of the 4th tape, and construct $y^N$ after this and $u^{y^N}$ is on tape 4. Short-lex reduce this using $\slex$ onto tape 5. We can check if $|u^{y^N}|_G > |u| + 2\delta$ by reading tape 5 and $u$ simultaneously and checking if we finish tape within $2\delta$ units of finishing $u$. We have still taken time only $O(|u|+|y|)$. We repeat the steps so far with $v$ on tapes 6 and 7.
 
-If we find ourselves on Line \ref{line:in_central_turing}, we can proceed as before to check equality of conjugates. The remaining arithmetic is all bounded, so can be executed in linear time.
+%If we find ourselves on Line \ref{line:in_central_turing}, we can proceed as before to check equality of conjugates. The remaining arithmetic is all bounded, so can be executed in linear time.
 
-Otherwise, we can construct $y^u$ in a similar way to $y^N$ and check the conjugates required by adding copies of $y$ onto the end until the string has grown by more than $6\delta$.
+%Otherwise, we can construct $y^u$ in a similar way to $y^N$ and check the conjugates required by adding copies of $y$ onto the end until the string has grown by more than $6\delta$.
 
-Finally, we return $y^r$ and $y^s$ instead of $r$ and $s$ (or empty strings in the case where $r$ or $s$ are $\infty$), and find the alorithm has run in time $O(|u| + |v| + |y|)$.
+%Finally, we return $y^r$ and $y^s$ instead of $r$ and $s$ (or empty strings in the case where $r$ or $s$ are $\infty$), and find the alorithm has run in time $O(|u| + |v| + |y|)$.
 
 In the next subsection, we complete a solution to the conjugacy problem where we know an element is of infinite order by putting together all of the tools we have so far in this section.
 
 \subsection{Testing conjugacy of $A$ and $B$}
 
-We are now in a position to test the if there is an element of $G$ which conjugates the entire list $A = (a_1, \ldots, a_m)$ to $B = (b_1, \ldots, b_m)$. Recall that $a_1$ is assumed to be of infinite order. Use Algorithm \ref{algorithm:testinforder} to test in time $O(|b_1|)$ if $b_1$ is of infinite order. If it is not, $a_1$ and $b_1$ are not conjugate, so neither at $A$ and $B$.
+We are now in a position to test the if there is an element of $G$ which conjugates the entire list $A = (a_1, \ldots, a_m)$ to $B = (b_1, \ldots, b_m)$. Recall that $a_1$ is assumed to be of infinite order. Let $\mu$ be an upper bound on the length of elements in either list.
 
-First, apply Algorithm \ref{algorithm:getconjugationcandidates} on $a_1$ and $b_1$ to obtain an $X$-word $p$, a short-lex straight word $y$ and a set $S$ of $X$-words with at most $V$ elements such that $a_1^g =_G b_1$ if and only if $g =_G py^ns$ for some $n \in \mathbb{Z}$ and $s \in S$. All returned $X$-words have length $O(|a_1| + |b_1|)$ and this step takes time $O(|a_1| + |b_1|)$.
+Use Corollary \ref{corollary:test_fin_ord} (\textsc{TestInfOrder}) to test in time $O(|b_1|)$ if $b_1$ is of infinite order. If it is not, $a_1$ and $b_1$ are not conjugate, so neither are $A$ and $B$ and we may stop.
 
+Next, apply Algorithm \ref{algorithm:getconjugationcandidates} (\textsc{GetConjugationCandidates}) on $a_1$ and $b_1$ to obtain an $X$-word $p$, a short-lex straight word $y$ and a set $S$ of $X$-words with at most $V$ elements such that $a_1^g =_G b_1$ if and only if $g =_G py^ns$ for some $n \in \mathbb{Z}$ and $s \in S$. All returned $X$-words have length $O(|a_1| + |b_1|)$ and this step takes time $O(|a_1| + |b_1|)$ and in particular $O(\mu)$.
+
 We repeat the remaining steps for each element $s \in S$. Since there are at most $V$ elements in $S$, we can do this without affecting the overall runtime of the algorithm.
 
-For each $i \in \{1, \cdots, m\}$, apply Algorithm \ref{algorithm:testconjugacybysls} to $a_i$ and $b_i$ to obtain values $r_i$ and $t_i$.\footnote{As $y$ was originally found as an element of the centraliser of a power of $a_1$, it might seem superfluous to test $i=1$ here, but we only know at this point that a power of $y$ centralises a \textit{power} of $a_1$, and in any case it is not clear what power of $y$ this is the case for.} This takes time $O(m\mu)$.
+For each $i \in \{1, \cdots, m\}$, apply Algorithm \ref{algorithm:testconjugacybysls} (\textsc{TestConjugacyBySLS}) to $a_i^p$, $b_i^{s^{-1}}$ and $y$ to obtain values $r_i$ and $t_i$.\footnote{As $y$ was originally found as an element of the centraliser of a power of $a_1$, it might seem superfluous to test $i=1$ here, but we only know at this point that a power of $y$ centralises a \textit{power} of $a_1$, and in any case it is not clear what power of $y$ this is the case for.} This takes time $O(m\mu)$.
 
 If $r_i = \infty$ for some $i$ then $a_i$ can't be conjugated to $b_i$ for any power of $y$, so the same is true of $A$ and $B$ and we can move to the next element of $S$.
 
-Otherwise, a set of $m$ (possibly modular) equations must be solved simultaneously. If $t_i = \infty$ for some $i$, this is simple; it suffices to check that $r_i = r_j$ for each $j \ne i$ where $t_j = \infty$, and that $r_i \equiv r_j \mod t_j$ for each $j \ne i$ where $t_j \ne \infty$. If all of the equations are satisfied then $A^{y^{r_i}} =_G B$ and $r_i$ is the unique power of $y$ with this property; otherwise there is no power of $y$ which conjugates $A$ to $B$. These checks can be made in time $O(m\log \mu)$.
+Otherwise, a set of $m$ (possibly modular) equations must be solved simultaneously. If $t_i = \infty$ for some $i$, this is simple; it suffices to check that $r_i = r_j$ for each $j \ne i$ where $t_j = \infty$, and that $r_i \equiv r_j \mod t_j$ for each $j \ne i$ where $t_j \ne \infty$. If all of the equations are satisfied then $A^{y^{r_i}} =_G B$ and $r_i$ is the unique power of $y$ with this property; otherwise there is no power of $y$ which conjugates $A$ to $B$. Either way we may move onto the next $s$ and these checks take time $O(m)$.
 
-The remaining case is where all $t_i$ and $r_i$ are finite, in which case the set of equations $j \equiv r_i \mod t_i$ must be solved simultaneously. First, note that if $d$ and $e$ are coprime natural numbers then $j \equiv c \mod de$ if and only if $j \equiv c \mod d$ and $j \equiv c \mod e$ both hold, so each congruence $j \equiv r_i \mod t_i$ can be split into a number of congruences modulo prime powers. As $t_i \le V$ for each $i$, and $V$ depends only on $G$, this operation takes constant time for each $i$, so time $O(m)$ overall.
+The remaining case is where all $t_i$ and $r_i$ are finite, in which case the set of equations $j \equiv r_i \mod t_i$ must be solved simultaneously. First, note that if $d$ and $e$ are coprime natural numbers then $j \equiv c \mod de$ if and only if $j \equiv c \mod d$ and $j \equiv c \mod e$ both hold, so each congruence $j \equiv r_i \mod t_i$ can be split into a number of congruences modulo prime powers. As $t_i \le V$ for each $i$, and $V$ depends only on $X$, this operation takes constant time for each $i$, so time $O(m)$ overall.
 
 Now for integers $c, d$ and natural numbers $e,f$ the two equations $a \equiv c \mod p^e$ and $a \equiv d \mod p^ep^f$ are equivalent to the second if $c \equiv d \mod p^e$ and have no solution if not. Thus the equations can be either shown to be inconsistent, or reduced to a set of at most $V$ equations modulo prime powers where each prime is distinct and each prime power is at most $V$. By allocating an array with an element corresponding to each prime below $V$, this will take constant time per starting prime power equation, so again time $O(m)$ overall.
 
@@ -1141,110 +1143,98 @@
 
 To summarise, here is the full algorithm in pseudocode.
 
+\begin{algorithm}
+\label{algorithm:findconjugatingelementsinf}
+Test conjugacy of lists where the first element of $A$ is known to have infinite order.
 \begin{algorithmic}[1]
 \Statex \textbf{Input:} Lists $A = [a_1, \ldots, a_m]$ and $B = [b_1, \ldots, b_m]$ with $a_1$ of infinite order.
 \Statex \textbf{Output:} A set of all elements $g \in G$ such that $g^{-1}Ag =_G B$.
 \Function{FindConjugatingElementsInf}{$A$, $B$}
-\If{$\not$\Call{TestInfOrder}{$b_1$}}
+\If{$\neg$\Call{TestInfOrder}{$b_1$}}
 	\State \textbf{return} $\{\}$
 \EndIf
 \State $p, y, S \gets$ \Call{GetConjugationCandidates}{$a_1, b_1$}
 \State $O \gets \{\}$
 \For{$s \in S$}
-	\State $u \gets -\infty$\Comment{Bounds on powers of $y$}
-	\State $U \gets \infty$
 	\State $E \gets \{\}$\Comment{Any modular equations go here}
 	\State $n \gets null$\Comment{Set to $r_i$ if $s_i = \infty$ for some $i$}
 	\For{$i \in \{1, \ldots, n\}$} \label{line:conj_inf_main_loop}
 		\State $a \gets \pi(a_i^p)$
 		\State $b \gets \pi(b_i^{s^{-1}})$
-		\State $r_i, s_i \gets$ \Call{TestConjugacySLS}{$a, b, y$}
+		\State $r_i, t_i \gets$ \Call{TestConjugacySLS}{$a, b, y$}
 		\If{$r_i = \infty$}
 			\State \textbf{next} $s$
 		\EndIf
-		\If{$s_i = \infty$}
+		\If{$t_i = \infty$}
 			\State $n \gets r_i$
 		\EndIf
-		\State $E \gets E \cup \{(r_i, s_i)\}$
+		\State $E \gets E \cup \{(r_i, t_i)\}$
 	\EndFor
-	\If{$r = null$}
-		\State $(r, s) \gets$ \Call{SolveSimultaneousModularEquations}{$E$}
-		\State $O \gets O \cup \{ py^ry^{sk}s : k \in \mathbb{Z} \}$
+	\If{$n = null$}
+		\State $(r, t) \gets$ \Call{SolveSimultaneousModularEquations}{$E$}\label{line:conj_inf_multi}
+		\State $O \gets O \cup \{ py^ry^{tk}s : k \in \mathbb{Z} \}$\label{line:add_inf_1}
 	\Else
-		\For{$(r, s) \in E$}
-			\If{$s = \infty$ and $r \ne n$}
+		\For{$(r, t) \in E$}
+			\If{$t = \infty$ and $r \ne n$}
 				\State \textbf{next} $s$
-			\ElsIf{$s < \infty$ and $r \notequiv n \mod s$}
+			\ElsIf{$t < \infty$ and $r \nequiv n \mod t$}
 				\State \textbf{next} $s$
 			\EndIf
 		\EndFor
-		\State $O \gets O \cup \{ py^ns \}$
+		\State $O \gets O \cup \{ py^ns \}$\label{line:conj_inf_sing}
 	\EndIf
 \EndFor
 \State \textbf{return} $O$
 \EndFunction
 \end{algorithmic}
+\end{algorithm}
 
-Since $|y| \in O(|a_1|)$ and $|s| \in O(|a_1| + |b_1|)$, the loop on line \ref{line:conj_inf_main_loop} takes time $O(|a_i| + |b_i| + |a_1| + |b_1|)$ per iteration, so time $O(m(|a_1| + |b_1|) + \mu)$ in total, where $\mu$ is the total length of all elements in both lists. By the discussion above, tests after this loop run in time $O(m)$, so the overall running time of the algorithm is $O(m(|a_1| + |b_1|) + \mu)$.
+Since $|y| \in O(|a_1|)$ and $|s| \in O(|a_1| + |b_1|)$, the loop on line \ref{line:conj_inf_main_loop} takes time $O(|a_i| + |b_i| + |a_1| + |b_1|)$ per iteration, so time $O(m\mu)$ in total. By the discussion above, line \ref{line:conj_inf_multi} runs in time $O(m)$ and returns $r$ and $s$ whose value depends only on $X$, so this section runs within time $O(m\mu)$. Finally, the $n$ on line \ref{line:conj_inf_sing} has $|y^n| \in O(\mu)$ so the last section also runs in time $O(m\mu)$.
 
-Notice that on line \ref{line:add_inf_1} the word $py^js$ has length $O(\mu)$ so is the language of an $(X \cup X^{-1})$-DFA with $O(\mu)$ states which can be computed in time $O(\mu)$ by Proposition \ref{prop:regular}.
+Notice that on line \ref{line:conj_inf_sing} the word $py^js$ has length $O(\mu)$ so is the language of an $X^{\pm 1}$-FSA with $O(\mu)$ states which can be computed in time $O(\mu)$ by Proposition \ref{prop:regular}.
 
-Similarly on line \ref{line:add_inf_2} the set $\{py^js : j \in P\}$ is the concatenation of the sets $\{py^k\}$, $\{y^{dn} : n \in \mathbb{Z}\}$ and $\{s\}$ and that each of these is accepted by an $(X \cup X^{-1})$-DFA with $O(\mu)$ states, so is accepted by an $(X \cup X^{-1})$-NFA with $O(\mu)$ states which can be computed in time $O(\mu)$ by Proposition \ref{prop:regular}.
+Similarly on line \ref{line:add_inf_1} the set $\{py^uy^{vn}s : n \in \mathbb{Z}\}$ is the concatenation of the sets $\{py^k\}$, $\{y^{dn} : n \in \mathbb{Z}\}$ and $\{s\}$ and that each of these is accepted by an $X^{\pm 1}$-FSA with $O(\mu)$ states (the language of powers can be represented by $\{y^n:n\ge0\}$ concatenated with $\{y^{-n}:n\ge0\}$).
 
+Thus $\{py^uy^{vn}s : n \in \mathbb{Z}\}$ is acepted by an $X^{\pm 1}$-FSA with $O(\mu)$ states, which can be computed in time $O(\mu)$ by Proposition \ref{prop:regular}.
+
+Then $O$ is the union of at most $V$ $X^{\pm 1}$-FSAs each with $O(\mu)$ states, so it too is the language of an $X^{\pm 1}$-FSA if $O(\mu)$ states, computed in $O(\mu)$ time.
+
 To summarise:
 
 \begin{theorem}
 \label{thm:conj_inf}
-Suppose $A$ and $B$ are lists of elements of $G$ such that the first element of $A$ is of infinite order and let $\mu$ be the total length of all elements of both $A$ and $B$. In time $O(m\mu)$, it is possible to compute an NFA over $(X \cup X^{-1})$ whose language $L$ has $\slex(L)$ equal to the set of all short lex least words $w$ with $A^w =_G B$.
+Suppose $A$ and $B$ are lists of elements of $G$ such that the first element of $A$ is of infinite order and let $\mu$ be the total length of all elements of both $A$ and $B$. In time $O(m\mu)$, it is possible to compute an $X^{\pm 1}$-FSA whose language $L$ has $\slex(L)$ equal to the set of all short lex least words $w$ with $A^w =_G B$.
 \end{theorem}
 
-Note that the centraliser of $A$ is returned by \textsc{FindConjugatingElementsInf}$(A, A)$ in time $O(m|a_1| + \mu)$.
+Note that the centraliser of $A$ is returned by \textsc{FindConjugatingElementsInf}$(A, A)$ in time $O(m\mu)$.
 
 \section{Conjugacy of general lists}
 
-In this section we will show that the conjugacy problem for lists is solvable even if all elements of both lists are of finite order, by either finding an infinite or element which is a multiple of some of the elements in one or the other list, or by reducing the problem to testing the conjugacy of bounded length lists containing only elements of bounded length.
+In this section we will show that the conjugacy problem for lists is solvable in linear time even if all elements of both lists are of finite order, by either finding an infinite order element which is a multiple of some of the elements in one or the other list, or by reducing the problem to testing the conjugacy of bounded length lists containing only elements of bounded length.
 
 \subsection{Simple results}
 
+We start by making an elementary observation about mid-vertices.
+
 \begin{lemma}
 \label{lemma:triangle}
-Suppose $\alpha$ is a geodesic triangle with corners on vertices $\vertex{x}$, $\vertex{y}$ and $\vertex{z}$, and that $\vertex{p}$ is a mid-vertex on the geodesic $\path{\vertex{x}}{\vertex{y}}$. Then \[
+Suppose $\vertex{x}$, $\vertex{y}$ and $\vertex{z}$ are vertices in $\Gamma$ and that $\vertex{p}$ is a mid-vertex a the geodesic $\path{\vertex{x}}{\vertex{y}}$. Then \[
 d(\vertex{p}, \vertex{z}) \le \frac{2\max\{d(\vertex{x}, \vertex{z}), d(\vertex{y}, \vertex{z})\} - d(\vertex{x}, \vertex{y}) + 1}{2} + \delta.
 \]
+\end{lemma}
 
+\begin{proof}
+Let $\path{\vertex{x}}{\vertex{z}}$, and $\path{\vertex{y}}{\vertex{z}}$ be geodesics so that we have a geodesic triangle with corners $\vertex{x}$, $\vertex{y}$ and $\vertex{z}$. sides of the triangle.
+
 \begin{figure}
 \begin{center}
-\begin{picture}(7,2)(-0.2,-0.05)
-\put(0,0){\line(1,0){6}}
-\put(0,0){\line(2,1){2}}
-\put(2,1){\line(4,-1){4}}
-
-\put(0,0){\circle*{0.05}} % x
-\put(-0.2,-0.1){\makebox(1,1)[bl]{$\vertex{y}$}}
-\put(6,0){\circle*{0.05}} % y
-\put(6.1,-0.1){\makebox(1,1)[bl]{$\vertex{x}$}}
-\put(2,1){\circle*{0.05}} % z
-\put(1.8,1.05){\makebox(0.4,1)[b]{$\vertex{z}$}}
-
-\put(2.5,0.875){\circle*{0.05}} % c_x
-\put(2.5,0.925){\makebox(0.3,1)[b]{$c_y$}}
-\put(1.5,0.75){\circle*{0.05}} % c_y
-\put(1.3,0.8){\makebox(0.3,1)[b]{$c_x$}}
-\put(2.1,0){\circle*{0.05}} % c_z
-\put(1.8,0.05){\makebox(0.4,1)[b]{$c_z$}}
-\put(3,0.){\circle*{0.05}} % p
-\put(2.8,0.05){\makebox(0.4,1)[b]{$p$}}
-\end{picture}
-\caption{A Triangle in Hyperbolic Space}
-\label{figure:hyp_tri}
+\input tri_midpoint.pstex_t
+\caption{A midpoint on a geodesic triangle}
+\label{figure:tri_midpoint}
 \end{center}
 \end{figure}
-\end{lemma}
 
-\begin{proof}
-Let $\path{\vertex{x}}{\vertex{y}}$, $\path{\vertex{x}}{\vertex{z}}$, and $\path{\vertex{y}}{\vertex{z}}$ be the geodesic sides of the triangle.
-
-Assume that $d(\vertex{x}, \vertex{z}) > d(\vertex{y}, \vertex{z})$, as in Figure \ref{figure:hyp_tri}. Note that \begin{eqnarray*}
+Assume that $d(\vertex{x}, \vertex{z}) > d(\vertex{y}, \vertex{z})$, as in Figure \ref{figure:tri_midpoint}. Note that \begin{eqnarray*}
         d(\vertex{x}, \vertex{p})
 & \le & \frac{d(\vertex{x}, \vertex{y}) + 1}{2} \\
 & \le & \frac{d(\vertex{x}, \vertex{y}) + d(\vertex{x}, \vertex{z}) - d(\vertex{y}, \vertex{z})}{2} \\
@@ -1266,6 +1256,8 @@
 \end{eqnarray*} as required. If $d(\vertex{p}, \vertex{x}) = (\vertex{y}, \vertex{z})_{\vertex{x}} + \frac{1}{2}$ then interchange $\vertex{x}$ and $\vertex{y}$ in the above argument to get the same result.
 \end{proof}
 
+We also make a simple observation which will be used later to aid us in shortening list elements.
+
 \begin{lemma}
 \label{lemma:replace}
 Suppose $g, a_1, a_2, b_1, b_2 \in G$. Then $(a_1, a_2)^g = (b_1, b_2)$ if and only if $(a_1a_2, a_2)^g = (b_1b_2, b_2)$.
@@ -1279,11 +1271,16 @@
 
 \subsection{Bounding element length in short lists}
 
-First we show that if the number of elements in a list is bounded, we can find a related list in which every element has bounded length. We will describe in a later section how to use this information to solve the conjugacy problem. The procedure to find such a list is described below.
+In this subsection, we show that if the number of elements in a list is bounded, we can find a related list in which every element has bounded length. We will describe in a later section how to use this information to solve the conjugacy problem. The procedure to find such a list is described below.
 
 \begin{proposition}
 \label{prop:shorten_list}
-There is an algorithm \textsc{ShortenList} which, given a list $A=(a_1,\ldots,a_m)$ of elements of $G$, will either return some $c \in G$ for which $|c^{-1}a_i a_{i+1} \cdots a_mc| \le 3^{m-i}(7L + \delta + \frac{1}{2})$ for any $1 \le i \le m$, or return integers $j$ and $k$ with $j \le k \le m$ such that $a_j a_{j+1} \cdots a_k$ is of infinite order. Further, the algorithm will run in time $O(m^2\mu)$, where $\mu$ is the total length of the elements in the list. If $\{a_i: 1 \le i \le m\}$ is known in advance to generate a finite subgroup, the algorithm can be modified to run in time $O(m \mu)$.
+There is an algorithm \textsc{ShortenList} which, given a list $A=(a_1,\ldots,a_m)$ of elements of $G$, will either: \begin{itemize}
+\item return some $c \in G$ which for any $1 \le i \le m$ has \[ |c^{-1}a_i a_{i+1} \cdots a_mc| \le 3^{m-i}(7L + \delta + \frac{1}{2}) \] or
+\item return integers $j$ and $k$ such that $j \le k \le m$ and $a_j a_{j+1} \cdots a_k$ is of infinite order.
+\end{itemize}
+
+Further, the algorithm will run in time $O(m^3\mu)$, where $\mu$ is the maximum length of the elements in $A$.
 \end{proposition}
 
 \begin{proof}
@@ -1294,7 +1291,7 @@
 \Function{ShortenList}{$[a_1, \ldots, a_m]$}
 \State $c_0 \gets 1$
 \For{$k:=1$ to $m$}
-	\For{$j \in \{1, \ldots, k\}$}\Comment{Skip this loop $A$ generates a finite subgroup}
+	\For{$j \in \{1, \ldots, k\}$}
 		\If{$|(\pi(c_{k-1}^{-1}a_j \cdots a_kc_{k-1}))_C|_G > 2L$} \label{line:conj_finite_check}
 			\State \textbf{return} $null, j, k$ \Comment{$a_j\cdots a_k$ is of infinite order} \label{line:conj_finite_return_infinite}
 		\EndIf
@@ -1305,109 +1302,115 @@
 \EndFunction
 \end{algorithmic}
 
-If the algorithm finds and returns integers $j, k$ on line \ref{line:conj_finite_return_infinite}, then a conjugate $g$ of $a_j \cdots a_k$ has $|(\slex(g))_C|$, and so $g$ is of infinite order by Proposition \ref{prop:short_conj}. Then $a_j \cdots a_k$ has infinite order also and the algorithm is correct to return $i, j$.
+If the algorithm finds and returns integers $j, k$ on line \ref{line:conj_finite_return_infinite}, then a conjugate $g$ of $a_j \cdots a_k$ has $|(\slex(g))_C| \ge 2L$, and so $g$ is of infinite order by Proposition \ref{prop:short_conj}. But then $a_j \cdots a_k$ has infinite order also and the algorithm is correct to return $j, k$.
 
-We may therefore assume that the assertion on line \ref{line:conj_finite_check} always fails. In fact, if $\{a_i: 1 \le i \le m\}$ is known in advance to generate a finite subgroup, these checks are always guaranteed to fail and thus do not need to be executed. It remains to show that after the outer loop has run $k$ times, the length of $c_k^{-1}a_i\cdots a_kc_k$ is less than or equal to $(7L+2\delta)3^{k-i}$ and that the algorithm has taken time $O(k^2 \mu_k)$ where $\mu_k$ is the total length of the first $k$ elements in $A$.
+We may therefore assume that the assertion on line \ref{line:conj_finite_check} always fails. It remains to show that after the outer loop has run $k$ times, the length of $c_k^{-1}a_i\cdots a_kc_k$ is less than or equal to $(7L+\delta+\frac{1}{2})3^{k-i}$ and that the algorithm has taken time $O(k^3 \mu)$.
 
-We first aim to show that $|c_k| \le \frac{\mu_k}{2}+k(\delta+1)$. Consider a geodesic triangle with corners $\vertex{e}$, $\vertex{b}:=\vertex{e} \cdot c_{k-1}$ and $\vertex{c}:=\vertex{e} \cdot a_kc_{k-1}$. Label the sides with the short lex geodesicsi $\path{\vertex{e}}{\vertex{b}}$, $\path{\vertex{b}}{\vertex{c}}$ and $\path{\vertex{e}}{\vertex{c}}$. Let $\vertex{p}:=\vertex{b} \cdot (\slex(c_{k-1}^{-1}a_kc_{k-1}))_L$, which is a mid-vertex of $\path{\vertex{b}}{\vertex{c}}$ as illustrated in Figure \ref{figure:extend_c}. Since $c_k$ labels a geodesic from $\vertex{e}$ to $\vertex{p}$, by Lemma \ref{lemma:triangle} we have \begin{eqnarray*}
+We first aim to show that $|c_k| \le k(\frac{\mu}{2}+\delta+1)$. Consider a geodesic triangle with corners $\vertex{e}$, $\vertex{b}:=\vertex{e} \cdot c_{k-1}$ and $\vertex{c}:=\vertex{e} \cdot a_kc_{k-1}$. Label the sides with the short lex geodesics $\path{\vertex{e}}{\vertex{b}}$, $\path{\vertex{b}}{\vertex{c}}$ and $\path{\vertex{e}}{\vertex{c}}$. Let $\vertex{p}:=\vertex{b} \cdot (\slex(c_{k-1}^{-1}a_kc_{k-1}))_L$, which is a mid-vertex of $\path{\vertex{b}}{\vertex{c}}$ as illustrated in Figure \ref{figure:extend_c}. Since $c_k$ labels a geodesic from $\vertex{e}$ to $\vertex{p}$, by Lemma \ref{lemma:triangle} we have \begin{eqnarray*}
         |c_k|
 & \le & \frac{2\max\{d(\vertex{e}, \vertex{c}), d(\vertex{e}, \vertex{c})\} - d(\vertex{b}, \vertex{c}) + 1}{2}+\delta \\
 & \le & \frac{2\max\{|c_{k-1}|,|a_kc_{k-1}|_G\}-|c_{k-1}^{-1}a_kc_{k-1}|_G+1}{2}+\delta.
 \end{eqnarray*}
 
+\begin{figure}
+\begin{center}
+\input extend_c.pstex_t
+\caption{Extending $c$.}
+\label{figure:extend_c}
+\end{center}
+\end{figure}
+
 Suppose $|c_{k-1}| \ge |a_kc_{k-1}|_G$. Notice that $|c_{k-1}^{-1}a_kc_{k-1}|_G \ge |c_{k-1}| - |a_kc_{k-1}|_G$ by the triangle inequality, so we find that \begin{eqnarray*}
         |c_k|
 & \le & \frac{2|c_{k-1}| - |c_{k-1}| + |a_kc_{k-1}|_G + 1}{2} + \delta \\
-& \le & \frac{|c_{k-1}| + |a_kc_{k-1}|_G + 1}{2} + \delta \\
+&  =  & \frac{|c_{k-1}| + |a_kc_{k-1}|_G + 1}{2} + \delta \\
 & \le & \frac{2|c_{k-1}| + 1}{2} + \delta \\
 & \le & |c_{k-1}| + \frac{|a_k|}{2} + \delta + 1.
 \end{eqnarray*} Similarly if $|c_{k-1}| < |a_kc_{k-1}|_G$ then \begin{eqnarray*}
         |c_k|
 & \le & \frac{2|a_kc_{k-1}|_G - |a_kc_{k-1}|_G + |c_{k-1}|}{2} + \delta \\
-& \le & \frac{|a_kc_{k-1}|_G + |c_{k-1}|}{2} + \delta \\
+&  =  & \frac{|a_kc_{k-1}|_G + |c_{k-1}|}{2} + \delta \\
 & \le & \frac{|a_k| + 2|c_{k-1}|}{2} + \delta \\
 &  =  & |c_{k-1}| + \frac{|a_k|}{2} + \delta + 1.
 \end{eqnarray*} In either case, then, $|c_k| \le |c_{k-1}| + \frac{|a_k|}{2} + \delta + 1$.
 
-By repeating this argument starting at $k=0$ we find that $|c_k| \le \frac{\mu_k}{2} + k(\delta+1)$ as required.
+By repeating this argument starting at $c_0$ we find that $|c_k| \le k(\frac{\mu}{2} + \delta + 1)$ as required.
 
-It can now be shown that the algorithm runs in time $O(m^2\mu)$. It is sufficient to show that each of the steps in the outer loop run in time $O(m\mu)$. Note that $|c_{k-1}^{-1}a_j\cdots a_kc_{k-1}| \le \mu_k+2|c_{k-1}| \le 2\mu_k + 2k(\delta+1)$ so the checks on line \ref{line:conj_finite_check} each run in time $O(\mu_k+k)=O(\mu_k)$. There are $k$ such steps per loop and a total of $m$ loops, so the overall running time is in $O(m^2\mu_m)$ for this step. In the case that we are not running these checks, this part can be ignored. Similarly, $|c_{k-1}c_{k-1}^{-1}a_kc_{k-1}| \le 4\mu_k$ so line \ref{line:conj_finite_extend} runs in time $O(\mu_k)$ and the overall time taken in this step is in $O(m\mu_m)$. Therefore the whole algorithm runs in time $O(m^2\mu)$ or $O(m \mu)$ if the checks on line \ref{line:conj_finite_check} are not being run.
+It can now be shown that the algorithm runs in time $O(m^3\mu)$. It is sufficient to show that each of the steps in the outer loop run in time $O(m^2\mu)$.
 
-It remains to show that the bound on the length of the elements $c_m^{-1}a_i\cdots a_mc_m$ is satisfied. This can be shown by induction on $m$. Let us first, for each $k\in\{1,\ldots,m\}$, define $K_{k,k}:=2L$ and $K_{i, k+1}: = 3K_{i,k} + 10L + 2\delta + 1$ for any $1 < i\le k$, in order to make notation simpler. The aim is to use induction on $k$ to show that $|c_k^{-1}a_j \cdots a_k c_k|_G \le K_{i, k}$ for any $1 \le i \le k$.
+Note that $|c_{k-1}^{-1}a_j\cdots a_kc_{k-1}| \le k\mu+2|c_{k-1}| \le k(\mu + 2\delta+2)$ so the checks on line \ref{line:conj_finite_check} each run in time $O(k\mu)$. There are $k$ such steps per loop and a total of $m$ loops, so the overall running time is in $O(m^3\mu)$ for this step. Similarly, $|c_{k-1}c_{k-1}^{-1}a_kc_{k-1}| \in O(k\mu)$ so line \ref{line:conj_finite_extend} runs in time $O(k\mu)$ and the overall time taken in this step is in $O(m^2\mu)$. Therefore the whole algorithm runs in time $O(m^3\mu)$.
 
-In the $k = 1$ case, $c_k = (a_k)_L$ so that $c_k^{-1}a_kc_k =_G(a_k)_C$ which by assumption has length less than or equal to $2L$ as required.
+It remains to show that the bound on the length of the elements $c_m^{-1}a_i\cdots a_mc_m$ is satisfied. This can be shown by induction on $m$. Let us first, for each $k\in\{1,\ldots,m\}$, define $K_{k,k}:=2L$. Now let $K_{i, k+1}: = 3K_{i,k} + 10L + 2\delta + 1$ for any $1 < i\le k$. The aim is to use induction on $k$ to show that $|c_k^{-1}a_i \cdots a_k c_k|_G \le K_{i, k}$ for any $1 \le i \le k$ and then show that $K_{i,m}$ is within the required bound.
 
-Now suppose that the inequality $|c_k^{-1}a_i\cdots a_k c_k|_G\le K_{i,k}$ is satisfied for all $1 \le i \le k$. It is our aim to bound $|c_{k+1}^{-1} a_i \ldots a_{k+1}c_{k+1}|_G$ for each $i$. Pick some specific $i$, and let $e:= \slex(c_k^{-1}a_i \ldots a_{k+1} c_k)$ and $g:= \slex(c_k^{-1}a_{k+1}c_k)$ so that $c_{k+1} =_G c_kg_L$. Note that \begin{eqnarray*}
-        c_{k+1}^{-1}a_i \ldots a_{k+1} c_{k+1}
-& =_G & c_{k+1}^{-1} c_ke c_k^{-1} c_{k+1} \\
-& =_G & g_L^{-1} eg_L \\
-& =_G & g_L^{-1} e_L e_C e_L^{-1} g_L.
-\end{eqnarray*} Since by assumption, $|e_C| \le 2L$ we need only bound $|g_L^{-1} e_L|_G$ to get a bound on $|c_{k+1}^{-1}a_i \ldots a_{k+1} c_{k+1}|_G$. Noting that $|g_R g_L|_G = |g_C|_G \le 2L$, we have $|g_L^{-1} e_L|_G = |g_L^{-1}g_R^{-1} g_R e_L |_G \le 2L + |g_R e_L |_G$ so a bound on $|g_R e_L|_G$ is sufficient. 
+In the $k = i$ case, $a_k^{c_k} =_G d^{d_L} =_F d_C$ where $d = \slex(a_k^{c_{k-1}})$. Since we ensure that $|d_C|_G \le 2L$ on line \ref{line:conj_finite_check} we must have $|a_k^{c_k}|_G \le K_{k,k}$.
 
-Consider a geodesic triangle with corners $\vertex{e}$, $\vertex{b}:= \vertex{e} \cdot g$ and $\vertex{c}:=\vertex{e} \cdot ge_L$. Let $f:= \slex(c_k^{-1}a_i\ldots a_k c_k)=_Geg^{-1} $ and recall that $|f|\le K_{i,k}$ by inductive assumption. Note that \begin{eqnarray*}
+Now suppose that the inequality $|c_k^{-1}a_i\cdots a_k c_k|_G\le K_{i,k}$ is also satisfied for all $1 \le i \le k$. We must show that $|c_{k+1}^{-1} a_i \ldots a_{k+1}c_{k+1}|_G \le K_{i,k+1}$ for each $i$.
+
+Pick some specific $i$, and let $e := \slex(c_k^{-1}a_i \ldots a_{k+1} c_k)$ and $g := \slex(c_k^{-1}a_{k+1}c_k)$. Notice that $c_{k+1} =_G c_kg_L$ and so \begin{eqnarray*}
+        (a_i \ldots a_{k+1})^{c_{k+1}}
+& =_G & e^{c_k^{-1}c_{k+1}} \\
+& =_G & e^{g_L} \\
+& =_G & e_C^{e_L^{-1}g_L} \\
+& =_G & e_C^{e_L^{-1}g_R^{-1}g_C}.
+\end{eqnarray*}
+
+The checks on line \ref{line:conj_finite_check} ensure that $|e_C|_G \le 2L$, and $|g_C|_G \le 2L$, so we know that $|e_C^{e_L^{-1}g_L}|_G \le 2|g_Re_L|_G + 6L$. In particular, we will be done if we can show that $|g_Re_L|_G \le \frac{3}{2}K_{i,k} + 2L + \delta + \frac{1}{2}$.
+
+Let $f := \slex(c_k^{-1}a_i\ldots a_k c_k) =_G eg^{-1} $ and recall that $|f|\le K_{i,k}$ by our earlier assumption. Consider a geodesic triangle with corners $\vertex{e}$, $\vertex{b}:= \vertex{e} \cdot g$ and $\vertex{c}:=\vertex{b} \cdot e_L$ illustrated in Figure \ref{figure:shorten_tri}. Note that \begin{eqnarray*}
         d(\vertex{e}, \vertex{c})
 &  =  & |ge_L|_G \\
 &  =  & |f^{-1} ee_L|_G \\
 & \le & |ee_L|_G + K_{i,k}\\ 
-&  =  & |e_Le_C|_G + K_{i,k} \\
+&  =  & |e_Le_C|_G + K_{i,k},
+\end{eqnarray*} but $|e_C|_G \le 2L$ so \begin{eqnarray*}
+        d(\vertex{e}, \vertex{c})
 & \le & |e_L| + K_{i,k} + 2L \\
 & \le & \frac{|e|}{2} + K_{i,k} + 2L \\
 & \le & \frac{|f| + |g|}{2} + K_{i,k} + 2L.
 \end{eqnarray*}
 
-Let $\vertex{p} := \vertex{e} \cdot g_L$. Note that $2|e_L| \le |e| \le |f| + |g|$, so Lemma \ref{lemma:triangle} implies that \begin{eqnarray*}
+\begin{figure}
+\begin{center}
+\input shorten_tri.pstex_t
+\caption{Bounding $g_Re_L$}
+\label{figure:shorten_tri}
+\end{center}
+\end{figure}
+
+Also, $d(\vertex{b}, \vertex{c}) = |e_L| \le \frac{|e|}{2} \le \frac{|f| + |g|}{2}$.
+
+Pick the mid-vertex $\vertex{p} := \vertex{e} \cdot g_L$ on $\path{\vertex{e}}{\vertex{b}}$. Lemma \ref{lemma:triangle} implies that \begin{eqnarray*}
         |g_R e_L|_G
-&  =  & d(p, \vertex{c}) \\
+&  =  & d(\vertex{p}, \vertex{c}) \\
 & \le & \frac{2 \max\{d(\vertex{e}, \vertex{c}), d(\vertex{b}, \vertex{c})\} -d(\vertex{e}, \vertex{b}) + 1}{2} + \delta \\
-& \le & \frac{2 \max\{|e_L| + 2L + K_{i, k}, |e_L|\} -|g| + 1}{2} + \delta \\
-&  =  & \frac{2(|e_L| + 2L + K_{i, k} ) -|g| + 1}{2} + \delta \\
+& \le & \frac{2 \max\{\frac{|f|+|g|}{2} + 2L + K_{i, k}, \frac{|f|+|g|}{2}\} -|g| + 1}{2} + \delta \\
+&  =  & \frac{2(2L + K_{i, k}) |g|+|f|-|g| + 1}{2} + \delta \\
 & \le & \frac{2(2L + K_{i, k}) + |f| + 1}{2} + \delta \\
 & \le & \frac{3}{2}K_{i, k} + 2L + \delta + \frac{1}{2},
-\end{eqnarray*} and $|g_L^{-1}e_L|_G \le 2L + |g_R e_L|_G \le \frac{3}{2} K_{i, k} + 4L + \delta + \frac{1}{2}$. Now \begin{eqnarray*}
-        |c_{k+1}^{-1}a_i \cdots a_{k+1}c_{k+1}|_G
-& \le & 2|g_L^{-1}e_L|_G + |e_C|_G \\
-& \le & 3K_{i, k} + 10L + 2\delta + 1\\
-&  =  & K_{i, k+1}
 \end{eqnarray*} as required.
 
-Finally, using a simple induction on $j$, \begin{eqnarray*}
-        K_{i,j}
-&  =  & 3K_{i,j-1} + 10L + 2\delta + 1\\
-&  =  & 3^{j-i}K_{i,i} + (10L + 2\delta + 1)\sum_{n=i}^{j-1} 3^{n-i} \\
-&  =  & 3^{j-i}K_{i,i} + (10L + 2\delta + 1)\frac{3^{j-i}-1}{3-1} \\
-&  =  & 2\times 3^{j-i}L + (5L + \delta + \frac{1}{2})(3^{j-i}-1)\\
-& \le & 3^{j-i} (7L + \delta + \frac{1}{2}) 
-\end{eqnarray*} as required in the hypothesis.
+Therefore $|(a_i \cdots a_k)^{c_k}|_G \le K_{i,k}$ for each $1 \le i \le k \le m$ and it remains to show that $K_{i,k} \le 3^{k-i}(7L+\delta+\frac{1}{2})$. But \begin{eqnarray*}
+        K_{i,k}
+&  =  & 3K_{i,k-1} + 10L + 2\delta + 1\\
+&  =  & 3^{k-i}K_{i,i} + (10L + 2\delta + 1)\sum_{n=i}^{k-1} 3^{n-i} \\
+&  =  & 3^{k-i}K_{i,i} + (10L + 2\delta + 1)\frac{3^{k-i}-1}{3-1} \\
+&  =  & 3^{k-i} \times 2L + (3^{k-i}-1)(5L + \delta + \frac{1}{2}) \\
+& \le & 3^{k-i} (7L + \delta + \frac{1}{2}),
+\end{eqnarray*} and we are done.
 \end{proof}
 
-\begin{figure}
-\begin{center}
-\input fig9_minitri.pstex_t
-\caption{Extending $c$.}
-\label{figure:extend_c}
-\end{center}
-\end{figure}
+We end this subsection by noting that by repeated application of Lemma \ref{lemma:replace}, the conjugacy problem remains unchanged between studying the lists $(a_1, \ldots, a_m)$ and $(b_1, \ldots, b_m)$, and the lists $(a_1', a_2', \ldots, a_m')$ and $(b_1', b_2', \ldots, b_m)$ where $a_i' = a_i \cdots a_m$ and $b_i' = b_i \cdots b_m$. This is critical to our solution later.
 
-\begin{figure}
-\begin{center}
-\input fig9_fin_order.pstex_t
-\caption{The conjugates of the $a_i'$ are all short.}
-\label{figure:fin_order}
-\end{center}
-\end{figure}
-
-By repeated application of Lemma \ref{lemma:replace}, the conjugacy problem remains unchanged between studying the lists $(a_1, \ldots, a_m)$ and $(b_1, \ldots, b_m)$, and the lists $(a_1 \cdots a_m, a_2 \cdots a_m, \ldots, a_m)$ and $(b_1 \cdots b_m, b_2 \cdots b_m, \ldots, b_m)$.
-
 \subsection{Some worse-than-linear algorithms}
 
-This section is a small toolbox of results which solve various problems involving lists in worse than linear time. They are useful as the previous section allows us to bound the lengths of elements in terms of the number of elements. The following result is a restatement of Corollary 3.2 of \cite{bridson2005conjugacy}.
+This section is a small toolbox of results which solve various problems involving lists in worse than linear time. They are useful, as the previous section allows us to bound the lengths of elements in terms of the number of elements. The following result is a restatement of Corollary 3.2 of \cite{bridson2005conjugacy}.
 
 \begin{proposition}
 \label{proposition:small_cent}
 Let $(a_1, \ldots, a_m)$ be a list of $m$ pairwise distinct finite order elements of $G$. Suppose that $x \in G$ satisfies \[ |x|_G \ge (2k + 5)^{4\delta+2}(l + 2\delta) \] where $l = \max\{|a_1|_G, |a_1^x|_G, \ldots, |a_m|_G, |a_m^x|_G\}$ and $k$ is the number of generators of $G$. Then $m$ is less than or equal to $Q^2$.
 \end{proposition}
 
-The statement in \cite{bridson2005conjugacy} says that $m \le (2k)^{8 \delta}$, but the proof is sufficient to prove the statement here. Proposition \ref{proposition:small_cent} can be used to show that the centraliser of a long list of finite order elements is finite. Theorem III.$\Gamma$.3.2 of \cite{BriHae99} then provides a bound on the number of elements in a finite subgroup:
+The statement in \cite{bridson2005conjugacy} says that $m \le (2k)^{8 \delta}$, but the proof there is sufficient to prove the statement here. Proposition \ref{proposition:small_cent} implies that the centraliser of a long list of finite order elements is finite. Theorem III.$\Gamma$.3.2 of \cite{BriHae99} then provides a bound on the number of elements in a finite subgroup:
 
 \begin{proposition}
 \label{proposition:finite_small_ball}
@@ -1418,100 +1421,164 @@
 
 \begin{corollary}
 \label{cor:short_cent}
-Given a constant $l$, there is constant $R$ which depends only on $G$ and $l$ and an algorithm \textsc{FindCentraliserExp} which takes as input a list $A$ consisting of $n > Q^2$ pairwise distinct words all of length less than $l$, all of which represent finite order elements of $G$, returns the centraliser $C$ of $A$ and runs in time $O(\mu)$ where $\mu$ is the total length of all elements in $A$. All elements of $C$ have length at most $R$ and the number of elements in $C$ depends only on $G$.
+Given a positive integer $\mu$, there is constant $R$ which depends only on $G$ and $\mu$ and an algorithm \textsc{FindCentraliserExp} which takes as input a list $A$ consisting of $n > Q^2$ words all of length less than $\mu$, all of which represent pairwise distinct finite order elements of $G$, returns the centraliser $C$ of $A$ and runs in time $O(n)$. All elements of $C$ have length at most $R\mu$ and the number of elements in $C$ depends only on $G$.
 \end{corollary}
 
 \begin{proof}
-Suppose that $A = (a_1, \ldots, a_n)$ is such a list. If $x$ is in the centraliser of $A$ then $a_i^x = a_i$ for all $1 \le i \le n$, so in Proposition \ref{proposition:small_cent} we have that $l$ is just the maximum length of the $a_i$ in $A$. Since $n > Q^2$, we have $|x|_G < (2k + 5)^{4\delta+2}(l + 2\delta) \in O(\mu)$.
+Suppose that $A = (a_1, \ldots, a_n)$ is such a list. If $x$ is in the centraliser of $A$ then $a_i^x = a_i$ for all $1 \le i \le n$, so in Proposition \ref{proposition:small_cent} we have that $l = \mu$. Since $n > Q^2$, we have $|x|_G < R$, where $R = (2k + 5)^{4\delta+2}(\mu + 2\delta) \in O(\mu)$.
 
 Since all elements in $C$ are of bounded length, $C$ is finite. Proposition \ref{proposition:finite_small_ball} implies that $C$ can be conjugated into a ball in $\Gamma$ of radius $4\delta + 2$, and in particular the number of elements in $C$ is bounded by a constant depending only on $G$.
 
-Thus the algorithm \textsc{FindCentraliserExp} need now just check each word $w$ of length at most $(2k + 5)^{4\delta+2}(l + 2\delta)$ whether $A^w =_G A$. There number of such elements depends only on $l$ and $G$ and each of the checks can be performed in time $O(\mu)$, which proves the bound on running time.
+Thus the algorithm \textsc{FindCentraliserExp} need now just check each word $w$ of length at most $R$ whether $A^w =_G A$. The number of such checks depends only on $\mu$ and $X$, and each of the checks can be performed in time $O(n\mu)$, which proves the bound on running time.
 \end{proof}
 
-Thus we have a method of computing the centraliser of a long list of short finite order words. We still need one which can be used on a short list of short finite order words. In \cite{gersten1991rational}, it is shown that the centraliser of any finite list in a conjugacy automatic group is a regular language. We provide a run-time analysis of this algorithm for completeness.
+Thus we have a method of computing the centraliser of a long list of short finite order words. We still need one which can be used on a short list of short finite order words. Lemma 4.2 and Proposition 4.3 of \cite{gersten1991rational} show that the centraliser of any finite list in a conjugacy automatic group is a regular language. We provide a run-time analysis of this algorithm for completeness.
 
 \begin{proposition}
 \label{prop:compute_centraliser}
-If $A = (a_1, \ldots, a_m)$ is a list of words, there is a regular language $L$ of short-lex least words which is exactly the centraliser of $A$. Further, there is an algorithm \textsc{FindCentraliserRational} and a constant $M$ depending only on $G$ such that \textsc{ComputeCentraliser} returns an $(X \cup X^{-1})$-NFA which accepts $L$ in time $O(M^\mu)$ where $\mu$ is the total length of elements in $A$.
+If $A = (a_1, \ldots, a_m)$ is a list of words, there is a regular language $Z$ of short-lex least words which is exactly the centraliser of $A$.
+Further, for any positive integer $\mu$, there is a constant $R$ which depends only on $X$ and $\mu$, and an algorithm \textsc{FindCentraliserRational} which takes as input a list of $X$-words of length at most $\mu$ such that \textsc{FindCentraliserRational} returns an $X^{\pm 1}$-FSA which accepts $Z$ in time $O(R^m)$.
 \end{proposition}
 
 \begin{proof}
-Let $M$ be the short-lex automaton and let $W$ be its language. Pick DFAs $M_x$ for $x \in (X \cup X^{-1})$ or $x$ equal to the identity to accept each language $L(x)$ in the conjugacy automatic structure for $G$ with respect to $W$. Let $k$ be the maximum number of states in any such DFA.
+Let $WA$ be the short-lex automaton and let $W$ be its language. Pick $X^{\pm 1}$ DFAs $M_x$ for $x \in X^{\pm 1}$ or $x$ equal to the identity to accept each language $L(x)$ in the conjugacy automatic structure for $G$ with respect to $W$. Let $k$ be the maximum number of states in these DFAs.
 
-For $w = x_1 \cdots x_n$, let $L(w)$ be the intersection of $L(x_1) \times \ldots \times L(x_n)$ and $\{(u_1, u_2, u_2, u_3, u_3, \cdots, u_n, u_n, u_1) : u_1, \ldots, u_n \in W \}$. By Proposition \ref{prop:regular}, both languages are accepted by a DFA with $(k+1)^{2n}$ states (the second one is essentially the cartesian product of a number of copies of $\{(w, w):w \in W\}$) so $L(w)$ is accepted by a DFA with at most $(k+1)^{4n}$ states.
+For $w = x_1 \cdots x_n$, let $L(w)$ be the intersection of \[ L(x_1) \times \ldots \times L(x_n) \] and \[ \{(u_1, u_2, u_2, u_3, u_3, \cdots, u_n, u_n, u_1) : u_1, \ldots, u_n \in W \}. \]
 
-Notice that if $(u_1, u_2, u_2, u_3, u_3, \cdots, u_n, u_n, u_{n+1}) \in L(w)$ for some set of words $u_i$ then $u_i^{x_i} = u_{i+1}$ for each $1 \le i \le n$, and so $u_1^w = u_{n+1} = u_1$. Thus the centraliser of $C(w)$ is just the projection of $L(w)$ to its first factor and is accepted by a $(k+1)^{4n}$-state NFA by Proposition \ref{prop:regular}.
+By Proposition \ref{prop:regular}, both languages are accepted by an FSA with $k^{2n}$ states (the second one is essentially the cartesian product of a number of copies of $\{(w, w):w \in W\}$) so $L(w)$ is accepted by an FSA with at most $k^{4n}$ states.
 
-The centraliser of $A$ is the intersection of the centralisers $C(a_i)$ of its elements $a_i$, which by Proposition \ref{prop:regular} is accepted by a $(k+1)^{4\mu}$-state NFA. Computation of this NFA takes time $O((k+1)^{4\mu})$ so it sufficies to let $M=(k+1)^4$.
+Notice that $(u_1, u_2, u_2, u_3, u_3, \cdots, u_n, u_n, u_{n+1}) \in L(w)$ for some set of words $u_i$ if and only if $u_i^{x_i} = u_{i+1}$ for each $1 \le i \le n$, and so $u_1^w = u_{n+1} = u_1$. Thus the centraliser of $C(w)$ is just the projection of $L(w)$ to its first factor and is accepted by a $k^{4n}$-state FSA by Proposition \ref{prop:regular}.
+
+The centraliser of $A$ is the intersection of the centralisers $C(a_i)$ of its elements $a_i$, which by Proposition \ref{prop:regular} is accepted by a $k^{4m\mu}$-state FSA. Computation of this FSA takes time $O(k^{4m\mu})$ so it sufficies to let $M=k^{4\mu}$.
 \end{proof}
 
+The reader may notice that it would be possible to instead use this method in place of \textsc{FindCentraliserExp} and the running time would not be dissimilar. We choose not to in order to give better emphasis to the fact that the centraliser in that case is finite and avoid the complications of finding the language of the FSA so-returned.
+
 We now have enough information to compute centralisers of lists of short elements. To complete this section, we give a method of testing conjugacy between lists of short elements. The main theorem regarding lists of finite order elements in \cite{bridson2005conjugacy}, Theorem 3.3, is restated below.
 
 \begin{proposition}
-Let $A = (a_1, \ldots, a_m)$ and $B = (b_1, \ldots, b_m)$ be sets of torsion elements in $G$. If $A$ and $B$ are conjugate then there exists a word $x$ with \[ |x|_G \le (2k+5)^{4\delta+2}(l+2\delta) + Q^{2Q^2} \] where $l$ is the maximal length of an element in either list and $k$ is the number of generators of $G$.
+Let $A = (a_1, \ldots, a_m)$ and $B = (b_1, \ldots, b_m)$ be sets of torsion elements in $G$. If $A$ and $B$ are conjugate then there exists a word $x$ with \[ |x|_G \le (2k+5)^{4\delta+2}(\mu+2\delta) + Q^{2Q^2} \] where $\mu$ is the maximum length of an element in either list and $k$ is the number of generators of $G$.
 \end{proposition}
 
-Again, the statement in \cite{bridson2005conjugacy} uses $(2k)^{8 \delta}$ in place of $Q^2$, but the proof is sufficient to prove the statement here.
+Again, the statement in \cite{bridson2005conjugacy} uses $(2k)^{8 \delta}$ in place of $Q^2$, but the proof is sufficient to prove the statement here. Thus by simply checking each element under the length above, we have an algorithm \textsc{TestConjugacyExp} which takes as input two lists of $m$ words whose elements have length less than $\mu$ and returns a word $w$ with $A^w =_G B$ if one exists in time exponential in $\mu$.
 
+\subsection{Ensuring distinct elements}
+
+Notice that to apply Corollary \ref{cor:short_cent} to a list $A = (a_1, \ldots, a_m)$ we must ensure that all of the elements of our input list are distinct. We will be applying the corollary to a list of length $n=Q^2 + 1$ which has been returned by \textsc{ShortenList}, so we need to ensure that the $a_i \cdots a_n$ are pairwise distinct group elements for each $i$.
+
+Notice that if $a_i \cdots a_n =_G a_{j+1} \cdots a_n$ for some $i \le j < n$ then $a_i \cdots a_j$ is equal to the identity in $G$. We thus need to ensure that $a_i \cdots a_j$ is never the identity.
+
+If $B = (b_1, \ldots, b_m)$ then we may replace $a_i$ with $a_i' := a_i \cdots a_j$ and replace $b_i$ with $b_i' := b_i \cdots b_j$ without changing the conjugacy problem between $A$ and $B$. If one of $a_i'$ and $b_i'$ is the identity and the other is not, the lists cannot therefore be conjugate. If both are the identity, they may be removed from their lists without altering the conjugacy problem.
+
+Thus the aim of this subsection is to produce a list of indices $i$ for which $a_i$ which may be removed from $A$ using the above reasoning, and by doing so either shorten $A$ to less than $n$ elements or replace $A$ with a list for which $a_j \cdots a_n$ are distinct group elements. To do this efficiently, we will need a real-time solution to the word problem.
+
+A \textbf{real-time Turing machine} has $k$ two-way infinite work tapes (for some integer $k$), one input tape and a finite set of states including a start state and a list of accepting states. It must read the word on the input tape by reading one letter, then for each work tape it may write a symbol to the current location and then move that tape's head one unit either left or right. The word is accepted if the machine is in an accept state at the end of input.
+
+The word-problem in $G$ is \textbf{real-time} if there is a real-time Turing machine which accepts exactly those words which are equal to the identity in $G$. In \cite{holt2000word} it is proved that the word problem for a word-hyperbolic group is indeed real-time.
+
+We will create $n$ copies $T_1, \ldots, T_n$ of this Turing machine and attach to each $T_i$ to a ``logging machine'' $R_i$ which records a log of the machine's behaviour which is sufficient to ``rewind'' $T_i$. That is, it stores for each input letter the directions which the work heads moved, the symbols which were under each work tape's head and the original state of the machine. One can thus rewind each $T_i$ in constant time by setting its state, moving each of its work heads in reverse, rewriting the stored symbol for that tape and moving the input tape's head back one unit. When doing so we move the head on $R_i$'s tape so that it is ready to rewind $T_i$ once more if required.
+
+We let $l = 0$ and $k = 1$ and start each $T_i$ with a blank input tape. At step $k$ we perform the following actions: \begin{enumerate}
+\item Increment $l$.
+\item Copy $a_k$ to the end of the input tapes of $T_1, \ldots, T_l$.
+\item Advance $T_1, \ldots, T_l$ by $|a_k|$ letters.
+\item If some $T_i$ is in an accepting state for $i \le l$, then: \begin{enumerate}
+	\item Rewind each $T_1, \ldots, T_l$ by $|a_k|$ letters.
+	\item Clear $a_k$ from the end of the input tapes of $T_1, \ldots, T_l$.
+	\item Mark $a_k$ as an element which should be removed.
+	\item Decrement $l$.
+\end{enumerate}
+\item Increment $k$.
+\item If $l \le n$ or $k > m$ then stop.
+\end{enumerate}
+
+Thus at step $k$, we at worst read $a_k$ into and then rewind at most $n$ real-time Turing machines, which takes time $O(|a_k|)$. We stop after at most $m$ steps, so the algorithm runs in time $O(m\mu)$.
+
+After step $k$, each $T_i$ holds a the word $a_i' \cdots a_l'$ where the list $(a_1', \ldots, a_l')$ is the list $(a_1, \ldots, a_k)$ with the elements marked above skipped. $T_i$ was not in an accept state immediately after reading $a_i' \cdots a_j'$ for each $i < j \le l$ so none of these words is equal to the identity and we have the desired algorithm. Name this algorithm \textsc{DetectIdentity}. 
+
+We now describe a second algorithm. Given lists $A$ and $B$ of the same length, execute \textsc{DetectIdentity} on each list in turn. If the same set of element indices is marked to be removed for both lists, remove those elements from both lists to create lists $A'$ and $B'$, which are immediately returned. By the discussion above, if $w \in G$ then $A^w =_G B$ if and only if $A'^w =_G B'$ so we may replace $A$ with $A'$ and $B$ with $B'$ without changing the set of conjugating elements.
+
+If the marked indices differ, return $null$. In this case we know that $A$ is not conjugate to $B$. Name this algorithm \textsc{EnsureUniqueness}.
+
 \subsection{Solving the conjugacy problem}
 
 \label{section:solve_conj}
 
-Suppose $A = (a_1, \ldots, a_m)$ and $B = (b_1, \ldots, b_m)$ with each $a_i$ and $b_i$ a word which represents a finite order element of $G$ and we wish to test if one list is a conjugate of the other and return a regular language which is exactly the set of conjugating elements.
+We are now ready to solve the conjugacy problem in the general case.
 
-We first replace $A$ and $B$ with $\slex(A)$ and $\slex(B)$. If for some $i$ we now find that $a_i = b_i$, we remove these elements in the lists, replacing them with later elements (this is reasonable since $a_i^g = b_i^g$ for any element $g \in G$). If for some $i$ we find that $a_i$ is the empty word but $b_i$ is not or vice versa, we declare the lists not conjugate (again, this is reasonable as the identity is conjugate only to itself).
+Suppose $A = (a_1, \ldots, a_m)$ and $B = (b_1, \ldots, b_m)$ with each $a_i$ and $b_i$ a word which represents a finite order element of $G$ and we wish to test if one list is a conjugate of the other and return a regular language which is exactly the set of conjugating elements. Let $\mu$ be the maximum length of all elements in $A$ and $B$.
 
-We are left with two lists $A$ and $B$, each of \textit{distinct} finite order short-lex least words all of length at least $1$. Let $\mu$ be the total length of all elements in $A$ and $B$.
+First, execute \textsc{EnsureUniqueness}$(\slex(A), \slex(B))$. If the algorithm returns $null$ then stop and declare the lists not conjugate. If not, replace $A$ and $B$ with the lists returned by this algorithm. This step takes time $O(m\mu)$.
 
-If these lists contain more than $Q^2$ elements, let $A'$ and $B'$ be the sublists of $A$ and $B$ respectively containing the first $n := Q^2+1$ elements, otherwise lie $A' = A$ and $B' = B$.
+We now have two lists $A$ and $B$, each of short-lex least words all of length at least $1$, and such that for $n := \min\{Q^2+1, m\}$ the group elements represented by $a_i \cdots a_n$ are distinct for all $i < n$.
 
-Now apply \textsc{ShortenList} to $A'$ and $B'$; this takes time at worst $O(n^2\mu) = O(\mu)$.
+Let $A'$ and $B'$ be the sublists of $A$ and $B$ respectively containing the first $n$ elements.
 
-If the algorithm returns an infinite order element $a_i \cdots a_j$ or $b_i \cdots b_j$ for some $i \le j$ then add $a_i \cdots a_j$ to the start of $A$ and add $b_i \cdots b_j$ to the start of $B$ to get new lists $\tilde{A}$ and $\tilde{B}$, and test conjugacy of $\tilde{A}$ and $\tilde{B}$ using \textsc{FindConjugatingElementsInf}, noting that the return value is already a regular language. This takes time $O(m\mu)$. Notice that for $g \in G$ we have $\tilde{A}^g =_G \tilde{B}$ if and only if $A^g =_G B$, so we have solved the conjugacy problem for $A$ and $B$, thus the conjugacy problem has been solved in time $O(m\mu)$.
+Apply \textsc{ShortenList} to $A'$ and $B'$; this takes time $O(n^2\mu) = O(\mu)$.
 
-If instead we get conjugating elements $c_A$ and $c_B$ then let $\tilde{A'} := (a_1', \ldots, a_n')$ where $a_i' = \slex((a_i \cdots a_n)^{c_A})$ and define $\tilde{B'}$ in the same way using $c_B$. Computing these lists takes time at worst $O(n\mu) = O(\mu)$.
+If the algorithm returns an infinite order element $a_i \cdots a_j$ or $b_i \cdots b_j$ for some $i \le j$ then add $a_i \cdots a_j$ to the start of $A$ and add $b_i \cdots b_j$ to the start of $B$ (notice that the set of conjugating elements if unchanged by this action). Now apply \textsc{FindConjugatingElementsInf}, noting that the return value is already a regular language, so we are done. The maximum length of an element of in lists is now $(j-i+1)\mu \le n\mu$, so this takes time $O(mn\mu) = O(m\mu)$.
 
-We must now check that each element $a_i'$ and $b_i'$ is indeed of finite order (we only at this point know that they are \textit{short}). Suppose that $x$ is such an element. Then compute $x' := \slex(\slex(x_C)^M)$. By Proposition \ref{prop:shorten_list} we know that $|\slex(x_C)| \le 2L$, so by Proposition \ref{prop:make_long} we have $\slex(x'_C) > 2L$ if $x$ is of infinite order. On the other hand, $\slex(x'_C) \le 2L$ if $x$ is of finite order. Each check requires reducing 2 words of length at most $3^n(7L+\delta+\frac{1}{2})$ so can perform all of these checks in time which depends only on $G$. If some element $a_i'$ is of infinite order, proceed just as if \textsc{ShortenList} had returned the integers $i$ and $n$.
+Check, for each $i \le n$ if \textsc{CheckInfOrder}($a_i$) returns true. If so, let $j = n$ and continue as if \textsc{ShortenList} had declared $a_i \cdots a_j$ to be of infinite order. Again, this step takes time $O(m\mu)$.
 
-By Proposition \ref{prop:short_conj}, if $\tilde{A'}$ and $\tilde{B'}$ are conjugate, there exists a word $u$ of length at most $K_2 := (2k + 5)^{4\delta+2}(3^n(7L+\delta+\frac{1}{2}) + 2\delta) + Q^{2Q^2}$ with $\tilde{A'}^u =_G \tilde{B'}$, so test every word up to this length to see if this is the case. Again, the time to do this depends only on $G$. If no such $u$ is found then $\tilde{A'}$ and $\tilde{B'}$ are not conjugate so neither are $A$ and $B$, and we may return. If some $u$ is found we continue.
+If we have not yet stopped, we have conjugating elements $c_A$ and $c_B$ which were returned by \textsc{ShortenList}. Let $A' := (a_1', \ldots, a_n')$ where $a_i' = \slex((a_i \cdots a_n)^{c_A})$ and define $B'$ in the same way using $c_B$. Computing these lists takes time $O(n^2\mu) = O(\mu)$.
 
-Suppose $m > n$. By Proposition \ref{prop:shorten_list}, all elements of $\tilde{A'}$ have length at most $3^n(7L+\delta+\frac{1}{2})$ and so by Proposition \ref{proposition:small_cent} every element of the centraliser of $\tilde{A'}$ has length at most $K_1 := (2k + 5)^{4\delta+2}(3^n(7L+\delta+\frac{1}{2}) + 2\delta)$. Let $C$ be the set of all words $w$ with $|w| \le K_1$ and $\tilde{A'}^w =_G \tilde{A'}$. Then $C$ is the centraliser of $\tilde{A'}$ and the time taken to compute $C$ depends only on $G$.
+Use \textsc{TestConjugacyExp} to find an $X$-word $w$ with $A'^w =_G B'$. If no $w$ is found, $A$ and $B$ were not conjugate, so we may stop. The time taken for this step is dependent only on $X$.
 
-Now check if $A^{c_Awu} = B^{c_B}$ for each $w \in C$. Each check takes time $O(\mu)$ and the number of checks depends only on $G$, so this part executs in time $O(\mu)$. Now return the set of all $c_Awuc_B^{-1}$ for which this check succeeds. As this is a finite set, it is a regular language. If it fails for all elements of $C$ then $A$ and $B$ were not conjugate. Either way, we are done.
+Suppose $m > n$. Since $A$ was processed by \textsc{EnsureUniqueness} and $A'$ with \textsc{TestInfOrder} all elements of $A'$ are distinct finite order elements. We may therefore execute \textsc{FindCentraliserExp} to find a finite set $C$ which is the centraliser of $A$. Again the time taken depends only on $X$.
 
-Finally, suppose that $n = m$. Let $C$ be the centraliser of $A'$ found using \textsc{FindCentraliserRational}. We have that $A^{c_Awuc_B^{-1}} =_G B$ for any $w \in C$, so we need simply return the set $\{c_Awuc_B^{-1} : w \in C\}$. This is a regular language since it is the concatenation of the two finite sets $\{c_A\}$ and $\{uc_B^{-1}\}$ and a regular langauge. Thus all cases are covered and we are done.
+Now check if $A^{c_Awu} = B^{c_B}$ for each $w \in C$. Each check takes time $O(\mu)$ and the number of checks depends only on $G$, so this part executes in time $O(\mu)$. Return the set of all $c_Awuc_B^{-1}$ for which this check succeeds. As this is a finite set, it is a regular language. In fact, it is a concatenation of the languages $\{c_A\}$, $C'$ and $\{uc_B\}$ where $C' \subset C$.
 
+By Proposition \ref{prop:regular}, the first and last languages are accepted by $X^{\pm 1}$-FSAs with $O(n\mu) = O(\mu)$ states, and the middle one is accepted by an $X^{\pm 1}$-FSA with maximum number of states depending only on $X$. The concatenation is accepted by an FSA whose number of states is the sum of this, which is in $O(\mu)$.
 
-This implies that we can find a much more efficient set $C$ for the centraliser in the finite case than the one described above.
+Finally, suppose that $n = m$. Let $C$ be the centraliser of $A'$ found using \textsc{FindCentraliserRational}. We have that $A^{c_Awuc_B^{-1}} =_G B$ for any $w \in C$, so we need simply return the set $O := \{c_Awuc_B^{-1} : w \in C\}$. Notice that $C$ is recognised by an FSA with number of states depending only on $X$. Then as before $O$ is the language of an FSA with $O(\mu)$ states and we are done.
 
-\section{The Complete Algorithm}
+This concludes the proof of Theorem \ref{thm:linear_conj}.
 
-This section contains pseudocode for the main part of the algorithm, given input of two lists $A$ and $B$ of $m$ words. We denote the centraliser and conjugation searching steps from Section \ref{section:solve_conj} by \textsc{FindCentraliserExp} and \textsc{TestConjugacyExp} respectively. The centraliser computing algorithm from \cite{gersten1991rational} is denoted \textsc{FindCentraliserRational}. The call \textsc{RemoveDuplicates} removes duplicate words from the lists.
+\section{The final algorithm}
 
+This section contains pseudocode for the main part of the algorithm, given input of two lists $A$ and $B$ of $m$ words.
+
+\begin{algorithm}
+\label{algorithm:testconjugacy}
+Solve the list conjugacy problem.
 \begin{algorithmic}[1]
 \Function{TestConjugacy}{$A:=[a_1, \ldots, a_m], B:=[b_1, \ldots, b_m]$}
-\State $A, B \gets$ \Call{RemoveDuplicates}{$\slex(A), \slex{B}$}
-\If{$m > Q^2$}
-	\State $n \gets Q^2+1$
+\Statex \textbf{Input:} Two equal length lists of $X$-words with maximum element length $\mu$.
+\Statex \textbf{Output:} A regular set $L$ for which $\slex(L) = \{ \slex(w) : w \in G, A^w =_G B \}$.
+\State $A, B \gets$ \Call{EnsureUniqueness}{$\slex(A), \slex{B}$}
+\If{$A = null$}
+	\State \textbf{return} $\{\}$
+\EndIf
+\State $n \gets \min\{Q^2+1, m\}$
+\State $i \gets null$
+\State $j \gets null$\Comment{These save indices for which $a_i \cdots a_j$ is of infinite order}
+\State $A_0 \gets [a_1, \ldots a_n]$
+\State $c_a, i', j' \gets$ \Call{ShortenList}{$A_0$}
+\If{$i' \ne null$}
+	\State $i \gets i'$
+	\State $j \gets j'$
 \Else
-	\State $n \gets m$
+	\For{$i' \in \{ 1, \ldots, n \}$}
+		\If{\Call{TestInfOrder}{$a_{i'} \cdots a_n$}}
+			\State $i \gets i'$
+			\State $j \gets n$
+		\EndIf
+	\EndFor
 \EndIf
-\State $A_0 \gets [a_1, \ldots a_n]$
-\State $c_a, i, j \gets$ \Call{ShortenList}{$A_0$}
-\If{$i \ne null$}
-	\State $A'\gets[a_i \cdots a_j, a_1, \ldots, a_{i-1}, a_{i+1}, \ldots, a_m]$
-	\State $B'\gets[b_i \cdots b_j, b_1, \ldots, b_{i-1}, b_{i+1}, \ldots, b_m]$
-	\State \textbf{return} \Call{TestConjugacyInf}{$A',B'$}
-\EndIf	
 \State $B_0 \gets [b_1, \ldots b_n]$
-\State $c_b, i, j \gets$ \Call{ShortenList}{$B_0$}
+\State $c_b, i', j' \gets$ \Call{ShortenList}{$B_0$}
+\If{$i' \ne null$}
+	\State $i \gets i'$
+	\State $j \gets j'$
+\EndIf
 \If{$i \ne null$}
-	\State $A'\gets[a_i \cdots a_j, a_1, \ldots, a_{i-1}, a_{i+1}, \ldots, a_m]$
-	\State $B'\gets[b_i \cdots b_j, b_1, \ldots, b_{i-1}, b_{i+1}, \ldots, b_m]$
+	\State $A' \gets [a_i \cdots a_j, a_1, \ldots, a_{i-1}, a_{i+1}, \ldots, a_m]$
+	\State $B' \gets [b_i \cdots b_j, b_1, \ldots, b_{i-1}, b_{i+1}, \ldots, b_m]$
 	\State \textbf{return} \Call{TestConjugacyInf}{$A',B'$}
 \EndIf
+\Statex \Comment{$A'$ must contain only distinct finite order elements of bounded length} 
 \State $A' \gets [c_a^{-1}a_1a_2\cdots a_nc_a, c_a^{-1}a_2a_3\cdots a_nc_a, \ldots, c_a^{-1}a_nc_a]$
+\Statex \Comment{$B'$ must contain only elements of bounded length} 
 \State $B' \gets [c_b^{-1}b_1b_2\cdots b_nc_b, c_b^{-1}b_2b_3\cdots b_nc_b, \ldots, c_b^{-1}b_nc_b]$
 \State $g \gets$ \Call{TestConjugacyExp}{$A', B'$}
 \If{$g = null$}
@@ -1532,8 +1599,9 @@
 \EndIf
 \EndFunction
 \end{algorithmic}
+\end{algorithm}
 
-This algorithm runs in time $O(m\mu)$ and returns either a single element which conjugates $A$ to $B$, leaving open the question of whether more such elements exist, or returns a set containing every conjugating element. We once again remark that the single element case 
+Once again, we note that the centraliser of $A$ is returned by \textsc{TestConjugacy}($A, A$).
 
 \chapter{Conjugacy and quasiconvex subgroups}
 
@@ -1556,17 +1624,25 @@
 
 It is impossible to determine whether a list of elements in a general word-hyperbolic group generate a quasiconvex subgroup (again due to \cite{rips1982subgroups}). We will therefore assume that $\epsilon$ has already been computed
 
-It may seem that quasiconvexity depends on the particular generating set $X$ chosen for $G$. This is not the case, however: while the constant $\epsilon$ may change under change of generating set, the existence of such a constant does not.
+It may seem that quasiconvexity depends on the particular generating set $X$ chosen for $G$. This is not the case, however: while the constant $\epsilon$ may change under change of generating set, the existence of such a constant does not (see Proposition 2.6 of \cite{gersten1991rational} for instance).
 
-Throughout this chapter, we will assume that $G$ is a hyperbolic group generated by some set $X$, that $\Gamma$ is its Cayley graph which has base vertex $\vertex{a}$ and is $\delta$-vertex-hyperbolic and that $H$ is an $\epsilon$-quasiconvex subgroup with coset Cayley graph $\Gamma'$ with respect to $X$. We will also assume that an $X^{\pm 1}$-DFA $M$ has been computed which accepts all short-lex least words in $H$. Finally, recall from Lemma \ref{lemma:short_lex} that the map $\slex$ which reduces words to their short-lex least representatives can be computed in time linear in input length.
+Throughout this chapter, we will assume that $G$ is a hyperbolic group generated by some set $X$, that $\Gamma$ is its Cayley graph which has base vertex $\vertex{a}$ and is $\delta$-vertex-hyperbolic and that $H$ is an $\epsilon$-quasiconvex subgroup with coset Cayley graph $\Gamma'$ with respect to $X$.
 
-\section{Extending geodesics}
+Recall from Lemma \ref{lemma:short_lex} that the map $\slex$ which reduces words to their short-lex least representatives can be computed in time linear in input length. We will finally assume that an $X^{\pm 1}$-DFA $HA$ has been computed which accepts all short-lex least words in $H$ so that a word $w$ can be tested for membership of $H$ in time $O(|w|)$ by testing if $HA$ accepts $\slex(w)$.
 
-Recall that $\canc{w}{u} = (\vertex{a} \cdot u, \vertex{a} \cdot v)_{\vertex{a}}$ is independent of $\vertex{a}$. A useful tool used throughout this chapter is the following one, which says that if $w$ is a long enough $\Gamma'$ geodesic word at $H$ and $u$ is a $\Gamma$-geodesic word for which $\canc{w}{u}$ is small, then $wu$ is close to being a $\Gamma'$-geodesic at $H$. The bounds can be slightly improved in the case where $\canc{w}{u} = 0$ (that is, it is a $\Gamma$-geodesic), but the factor of $\epsilon$ is unchanged so we will simply prove the more general statement.
+\section{Useful results}
 
+We begin by providing some basic results in order to avoid districting the reader from the main results in each section.
+
+\subsection{Extending geodesics}
+
+Recall that $\canc{w}{u} = (\vertex{a} \cdot u, \vertex{a} \cdot v)_{\vertex{a}}$ and is independent of $\vertex{a}$.
+
+A useful tool used throughout this chapter is the following one, which says that if $w$ is a long enough $\Gamma'$ geodesic word at $H$ and $u$ is a $\Gamma$-geodesic word for which $\canc{w}{u}$ is small, then $wu$ is close to being a $\Gamma'$-geodesic at $H$. The bounds can be slightly improved in the case where $\canc{w}{u} = 0$ (that is, $wu$ is a $\Gamma$-geodesic), but the factor of $\epsilon$ is unchanged so we will simply prove the more general statement.
+
 \begin{lemma}
 \label{lemma:extend_long_coset}
-Suppose that $w_1$ and $w_2$ are $\Gamma$-geodesics. Let $k := \canc{w_1}{w_2}$, and let $w_1'$ and $w_2'$ be $\Gamma'$-geodesics connecting $H$ to $Hw_1$ and $Hw_1w_2$ respectively. If $|w_1'| \ge 3\delta + \epsilon + k + 1$ then $|w_2'| \ge |w_1'| + |w_2| - 2k - 3\delta - \epsilon - 1$.
+Suppose that $w_1$ and $w_2$ are $\Gamma$-geodesics. Let $k := \canc{w_1^{-1}}{w_2}$, and let $w_1'$ and $w_2'$ be $\Gamma'$-geodesics connecting $H$ to $Hw_1$ and $Hw_1w_2$ respectively. If $|w_1'| \ge 3\delta + \epsilon + k + 1$ then $|w_2'| \ge |w_1'| + |w_2| - 2k - 3\delta - \epsilon$.
 \end{lemma}
 
 \begin{figure}
@@ -1598,11 +1674,11 @@
   = & |w_1'| + s_1 - d_1 + |w_2| - 2k + d_2 - s_2 \label{eqn:s1_bound}
 \end{align} so recalling that $d_2$ is bounded, we need only show that $s_2$ is not much larger than $s_1$ to find a lower bound on $|w_2'|$.
 
-Notice that $(\vertex{b}, \vertex{c})_{\vertex{a}} = |w_1| - (\vertex{a}, \vertex{c})_{\vertex{b}} = |w_1| - k$. Since $|w_1| = |w_1'| - d_1 + s_1$, using $|w_1'| \ge 3\delta + \epsilon + k + 1$ from the hypothesis, we see that \begin{equation} \label{eqn:canc_far}
+By definition, $(\vertex{b}, \vertex{c})_{\vertex{a}} = |w_1| - (\vertex{a}, \vertex{c})_{\vertex{b}} = |w_1| - k$. Since $|w_1| = |w_1'| - d_1 + s_1$, using $|w_1'| \ge 3\delta + \epsilon + k + 1$ from the hypothesis, we see that \begin{equation} \label{eqn:canc_far}
 (\vertex{b}, \vertex{c})_{\vertex{a}} \ge s_1 + 3\delta + \epsilon - d_1 + 1.
 \end{equation}
 
-Now suppose for a contradiction that $j := s_1 + 3\delta + \epsilon - d_1 + 1 \le s_2$. Notice $s_1 - d_1 \in \mathbb{Z}$ so that $j$ is an integer. Let $\vertex{z} := \vertex{a} \cdot h_2(j)$ and since $j \le s_2$ we see $\vertex{z}$ corresponds to a vertex on $\path{\vertex{a}}{\vertex{c}}$. By (\ref{eqn:canc_far}) we know that $j \le (\vertex{b}, \vertex{c})_{\vertex{a}}$, so this vertex in turn corresponds to a vertex on $\path{\vertex{a}}{\vertex{b}}$. Finally, (\ref{eqn:d1_short}) implies that $j \ge s_1 + 2\delta + 1 \ge s_1$, so $\vertex{z}$ $3$-corresponds to a vertex $\vertex{p}$ on $\path{\vertex{d}}{\vertex{b}}$. Notice that $d(\vertex{d}, \vertex{p}) = j - s_1 + d_1 = 3\delta + \epsilon + 1$.
+Now suppose for a contradiction that $j := s_1 + 3\delta + \epsilon - d_1 + 1 \le s_2$. Notice $s_1 - d_1 \in \mathbb{Z}$ so that $j$ is an integer. Let $\vertex{z} := \vertex{a} \cdot h_2(j)$ and since $j \le s_2$ we see $\vertex{z}$ corresponds to a vertex on $\path{\vertex{a}}{\vertex{c}}$. By (\ref{eqn:canc_far}) we know that $j \le (\vertex{b}, \vertex{c})_{\vertex{a}}$, so this vertex in turn corresponds to a vertex on $\path{\vertex{a}}{\vertex{b}}$. Finally, (\ref{eqn:d1_short}) implies that $j \ge s_1 + 2\delta + 1 \ge s_1$, so $\vertex{z}$ $3$-corresponds to a vertex $\vertex{p}$ on $\path{\vertex{d}}{\vertex{b}}$. Notice that $d(\vertex{d}, \vertex{p}) = j - s_1 + d_1 = 3\delta + \epsilon + 1$ so that $d(\vertex{p}, \vertex{b}) = |w_1'| - 3\delta - \epsilon - 1$.
 
 Since $\vertex{z}$ lies on $\path{\vertex{a}}{\vertex{e}}$, it lies within $\epsilon$ of some other vertex $\vertex{q}$ representing an element of $H$ and we have \begin{eqnarray*}
         d(H, Hw_1')
@@ -1619,25 +1695,12 @@
 \end{eqnarray*} and $|w_2'| \ge |w_1'| + |w_2| - 2k - 3\delta - \epsilon$ as required.
 \end{proof}
 
-This lemma in particular implies that if a $\Gamma$-geodesic labels a path starting at $H$ which strays too far from $H$, it can never go back. This fact is especially useful in the next section.
+This lemma in particular implies that if a $\Gamma$-geodesic labels a path starting at $H$ which strays too far from $H$, it can never go back. This fact is especially useful in the next sections.
 
-Another result in which is useful in this chapter is Lemma \ref{lemma:conj_quadrilateral} which will be proved in the next chapter. We provide a special case of that lemma here.
+\subsection{Other useful results}
 
-\begin{lemma}
-\label{lemma:conj_quadrilateral_gp}
-Suppose that $w$ labels a geodesic in $\Gamma'$ starting at $H$, that $u$ is labels a geodesic in $\Gamma$ and that $Hwu = Hw$. Let $v = \slex(wuw^{-1})$. Then either
+The next two results relate to words of minimal length under conjugation.
 
-\begin{enumerate}
-\item $2|w| \le |u| - |v| + 6\delta + 4\epsilon + 2$ and $2|w| \le |u| + 3\delta + 2\epsilon + 1$, or
-\item $|v| \le 3\delta + 2\epsilon + 1$
-\end{enumerate}
-\end{lemma}
-
-
-\section{An upper bound on minimal powers}
-
-In this section, we demonstrate that there is number $U$ such that if $h \in H$ and $h = g^n$ for some $g \in G$ then $n \le U$. We begin by showing some general properties of minimal conjugates (these are in fact true in general).
-
 \begin{lemma}
 \label{lemma:min_small_canc}
 Suppose that $g \in G$, that $|g^a|_G \ge l$ for all $X$-words $a$, that $w$ is an $X$-word such that $|g^w|_G = l$ and that $w$ has minimal length over all $X$-words with this property. Then $\floor{\canc{g^w}{w^{-1}}} \le \delta$.
@@ -1669,8 +1732,22 @@
 Suppose not. Then there exists a straight word $w$ and another $X$-word $a$ such that $|w^a|_G \le |w| - 1$. But then $|w^3|_G = |a(w^a)^3a^{-1}|_G \le 1 + 3(|w| - 1) + 1 < |w^3|$ and $w$ was not straight, a contradiction which proves the lemma.
 \end{proof}
 
-We now prove the main result for this section. Recall $M$ and $Q$ from Section \ref{section:conj_const}.
+Lemma \ref{lemma:conj_quadrilateral}, which will be proved in the next chapter, is useful for conjugacy testing. We provide a special case of that lemma here.
 
+\begin{lemma}
+\label{lemma:conj_quadrilateral_gp}
+Suppose that $w$ labels a geodesic in $\Gamma'$ starting at $H$, that $u$ is labels a geodesic in $\Gamma$ and that $Hwu = Hw$. Let $v = \slex(wuw^{-1})$. Then either
+
+\begin{enumerate}
+\item $2|w| \le |u| - |v| + 6\delta + 4\epsilon + 2$ and $2|w| \le |u| + 3\delta + 2\epsilon + 1$, or
+\item $|v| \le 3\delta + 2\epsilon + 1$
+\end{enumerate}
+\end{lemma}
+
+\section{An upper bound on minimal powers}
+
+In this section, we demonstrate that there is an upper bound depending only on $G$ on the numbers $n$ with $h \in H$ and $h = g^n$. Recall $M$ and $Q$ from Section \ref{section:conj_const}.
+
 \begin{theorem}
 \label{theorem:max_power}
 Suppose that $g \in G$ with $g^n \in H$ for some $n \in \mathbb{N}$. Then $g^l \in H$ for some $l \le MQ^2R$ where $R$ is the number of vertices in $B^{\Gamma'}_{6\delta + \epsilon}(H)$.
@@ -1679,25 +1756,35 @@
 \begin{proof}
 Suppose $g$ has finite order. Then $g$ generates a finite subgroup $K$ which, by Proposition \ref{proposition:finite_small_ball}, can be conjugated into a ball in $\Gamma$ of radius at most $4\delta + 2$. As $Q$ is the number of vertices in the $4\delta$ ball in $\Gamma$ we find that $K$ has less than $Q^2$ elements. But then $g^n$ is the identity for some $n \le Q^2 \le MQ^2R$. Since the identity is necessarily in $H$, we are done.
 
-We may therefore assume that $g$ is of infinite order, so that $g^m$ has a short-lex straight conjugate for some $0 < m \le MQ^2$ by Corollary \ref{cor:find_sls_and_conj_form}. Pick an $X$-word $a$ such that $\slex(ag^ma^{-1})$ is short-lex straight and the length of $a$ is minimal over all words with this property. Let $x := \slex(ag^ma^{-1})$. Notice that $x^k$ has minimal length under conjugation for any $k \ge 1$ by Lemma \ref{lemma:s_min}, and so Lemma \ref{lemma:min_small_canc} implies that $\floor{\canc{x^k}{a}} \le \delta$ and $\floor{\canc{x^{-k}}{a}} \le \delta$ for any $k \ge 1$.
+We may therefore assume that $g$ is of infinite order, so that $g^m$ has a short-lex straight conjugate for some $0 < m \le MQ^2$ by Corollary \ref{cor:find_sls_and_conj_form}. Pick an $X$-word $a$ such that $\slex(ag^ma^{-1})$ is short-lex straight and the length of $a$ is minimal over all words with this property. Let $x := \slex(ag^ma^{-1})$. We aim to bound $\canc{x^{-i}a}{x^ja}$ for large $i$ and $j$ in order to apply Lemma \ref{lemma:extend_long_coset}.
 
-Suppose that $i \ge 4\delta + 2$, that $j \ge 4\delta + 2$ and that $\canc{x^{-i}a^{-1}}{x^ja^{-1}} \ge \frac{3}{2}\delta + 1$. Let $\vertex{b} := \vertex{a} \cdot x^j$, $\vertex{c} := \vertex{b} \cdot a^{-1}$, $\vertex{e} := \vertex{a} \cdot x^{-i}$ and $\vertex{d} := \vertex{e} \cdot a^{-1}$. Then we have a geodesic pentagon in $\Gamma$ as illustrated in Figure ??.%\ref{figure:big_sls_powers_canc}.
+Notice that $x^k$ has minimal length under conjugation for any $k \ge 1$ by Lemma \ref{lemma:s_min}, and so Lemma \ref{lemma:min_small_canc} implies that $\floor{\canc{x^k}{a}} \le \delta$ and $\floor{\canc{x^{-k}}{a}} \le \delta$ whenever $k \ge 1$.
 
-Let $\vertex{x} := \vertex{a} \cdot x^i(l)$ and $\vertex{y} := \vertex{a} \cdot x^{-i}(l)$ where $l := \floor{\frac{3}{2}\delta} + 1$. Then $\canc{x^j}{x^ja^{-1}} = |x^j| - \canc{x^j}{a^{-1}} \ge j|x| - \delta - 1 \ge 3\delta + 1$, so $i \le \canc{x^j}{x^ja^{-1}} = (\vertex{b}, \vertex{c})_{\vertex{a}}$ and $\vertex{x}$ corresponds to a vertex $\vertex{x'}$ on $\path{\vertex{a}}{\vertex{c}}$. A similar argument shows that $\vertex{y}$ corresponds to a vertex $\vertex{y'}$ on $\path{\vertex{a}}{\vertex{d}}$. Since $\canc{x^{-i}a^{-1}}{x^ja^{-1}} \ge \frac{3}{2}\delta + 1$ we know that $i \le \canc{x^{-i}a^{-1}}{x^ja^{-1}} = (\vertex{c}, \vertex{d})_{\vertex{a}}$, so $\vertex{x'}$ corresponds to $\vertex{y'}$. In particular, $d(\vertex{x}, \vertex{y}) \le 3\delta$ so \begin{eqnarray*}
+Suppose for a contradiction that $i \ge 4\delta + 2$, that $j \ge 4\delta + 2$ and that $\canc{x^{-i}a}{x^ja} \ge \frac{3}{2}\delta + 1$. Let $\vertex{b} := \vertex{a} \cdot x^j$, $\vertex{c} := \vertex{b} \cdot a$, $\vertex{e} := \vertex{a} \cdot x^{-i}$ and $\vertex{d} := \vertex{e} \cdot a$. Then we have a geodesic pentagon in $\Gamma$ as illustrated in Figure \ref{figure:sls_power_canc}.
+
+\begin{figure}
+\begin{center}
+\input sls_power_canc.pstex_t
+\caption{A large power of $x$}
+\label{figure:sls_power_canc}
+\end{center}
+\end{figure}
+
+Let $\vertex{x} := \vertex{a} \cdot x^i(l)$ and $\vertex{y} := \vertex{a} \cdot x^{-i}(l)$ where $l := \floor{\frac{3}{2}\delta} + 1$. Then $\canc{x^j}{x^ja} = |x^j| - \canc{x^{-j}}{a} \ge j|x| - \delta - 1 \ge 3\delta + 1$, so $i \le \canc{x^j}{x^ja} = (\vertex{b}, \vertex{c})_{\vertex{a}}$ and $\vertex{x}$ corresponds to a vertex $\vertex{x'}$ on $\path{\vertex{a}}{\vertex{c}}$. A similar argument shows that $\vertex{y}$ corresponds to a vertex $\vertex{y'}$ on $\path{\vertex{a}}{\vertex{d}}$. Since $\canc{x^{-i}a}{x^ja} \ge \frac{3}{2}\delta + 1$ we know that $i \le \canc{x^{-i}a}{x^ja} = (\vertex{c}, \vertex{d})_{\vertex{a}}$, so $\vertex{x'}$ corresponds to $\vertex{y'}$. In particular, $d(\vertex{x}, \vertex{y}) \le 3\delta$ so \begin{eqnarray*}
         |w^{i+j}|
 &  =  & d(\vertex{e}, \vertex{b}) \\
 & \le & d(\vertex{e}, \vertex{x}) + d(\vertex{x}, \vertex{y}) + d(\vertex{y}, \vertex{b}) \\
 & \le & |w^i| - l + 3\delta + |w^j| - l \\
 & \le & |w^{i+j}| - 1.
-\end{eqnarray*} This is a clear contradiction, so $(ax^i, x^ja^{-1})_1 \le \frac{3}{2}\delta + \frac{1}{2}$ whenever both $i$ and $j$ are at least $4\delta + 2$.
+\end{eqnarray*} This is a clear contradiction, so $\canc{x^{-i}a}{x^ja} \le \frac{3}{2}\delta + \frac{1}{2}$ whenever both $i$ and $j$ are at least $4\delta + 2$.
 
-Suppose $w$ is a $\Gamma'$-geodesic connecting $H$ to $Hax^i$ for some $i \ge 4\delta + 2$, and that $|w| > 6\delta + \epsilon + 1$. Then Lemma \ref{lemma:extend_long_coset} applies with $w_1 = ax^i$ and $w_2 = x^ja^{-1}$ for any $j \ge 4\delta + 2$, and implies that \begin{eqnarray*}
+Suppose that $d(H, Hax^i) \ge 6\delta + \epsilon + 1$ for some $i \ge 4\delta + 2$. Then Lemma \ref{lemma:extend_long_coset} applies with $w_1 = ax^i$ and $w_2 = x^ja^{-1}$ for any $j \ge 4\delta + 2$, and implies that \begin{eqnarray*}
         d(H, Hg^{i+j})
 &  =  & d(H, Hax^{m(i+j)}a^{-1}) \\
-& \ge & |w| + |x^ja^{-1}|_G - 6\delta - \epsilon - 2
-\end{eqnarray*} for large $j$. Since this implies $Hg^t$ is far from $H$ for any large values of $t$, if $d(H, Hax^i) > 6\delta + \epsilon + 1$ for some $i \ge 4\delta + 2$ then no power of $g$ can be in $H$.
+& \ge & d(H, Hax^i) + |x^ja^{-1}|_G - 6\delta - \epsilon - 2
+\end{eqnarray*} for large $j$. Since this implies $Hg^t$ is far from $H$ for any large values of $t$, if $d(H, Hax^i) \ge 6\delta + \epsilon + 1$ for some $i \ge 4\delta + 2$ then no power of $g$ can be in $H$.
 
-We therefore find that $d(H, Hax^i) \le 6\delta + \epsilon + 1$ for all $i \ge 4\delta + 2$. If $Hax^i = Hax^j$ for some integers $0 \le i < j$ then $x^{j-i}$ labels a loop at $Hax^i$ and so $Hax^p = Hax^{p+(j-i)}$ for any integer $p$. Setting $p = 0$ we find that $Hax^{j-i} = Ha$ so that $g^{m(j-i)} =_G ax^{j-i}a^{-1}$ is an element of $H$.
+We therefore find that $d(H, Hax^i) \le 6\delta + \epsilon$ for all $i \ge 4\delta + 2$. If $Hax^i = Hax^j$ for some integers $0 \le i < j$ then $Hax^{i+p} = Hax^{j+p}$ for any integer $p$. Setting $p = -i$ we find that $Hax^{j-i} = Ha$ so that $g^{m(j-i)} =_G ax^{j-i}a^{-1}$ is an element of $H$.
 
 As there are at most $R$ elements in $B_{6\delta+\epsilon+1}(H)$, we can assume that $j - i \le R$ and we are done.
 \end{proof}
@@ -1735,58 +1822,71 @@
 \begin{proof}
 Let us first suppose that $|g_C|_G \le 2L$. Let $w := g_L$ and apply Proposition \ref{prop:short_conj_in_H} to $x := \slex(g_C)$. We find that if $a^{-1}$ labels a geodesic in $\Gamma'$ starting at $H$ and $g^{wa} =_G x^a \in H$ then either $|a| \le \frac{|x|+3\delta + 2\epsilon + 1}{2} \le L + 3\delta + 2\epsilon + 1$ or $|x^a|_G \le 3\delta + 2\epsilon + 1$.
 
-Let us instead suppose that $|g_C|_G > 2L$. Propositions \ref{prop:short_conj}, \ref{prop:nice_qgeo} and \ref{prop:long_conj_slex} imply that we can find a word $w$ of length $O(|g|)$ and an integer $m \le MQ^2$ where $x =_G w^{-1}g^mw$ is short-lex straight in $\Gamma$, and that this operation takes time $O(|g|)$. Applying Proposition \ref{prop:short_conj_in_H} to $x$ (which is of minimal length under conjugation by Lemma \ref{lemma:s_min}), we find that if $a^{-1}$ labels a geodesic in $\Gamma'$ starting at $H$ and $g^{wa} \in H$ then $(g^m)^{wa} =_G x^a \in H$ and either $|a| \le 3\delta + 2\epsilon + 1$ or $|x^a|_G \le 3\delta + 2\epsilon + 1$.
+Let us instead suppose that $|g_C|_G > 2L$ so that $g$ is of infinite order by \ref{prop:short_conj}. Corollary \ref{cor:find_sls_and_conj_form} implies that we can find a word $w$ of length $O(|g|)$ and an integer $m \le MQ^2$ where $x =_G w^{-1}g^mw$ is short-lex straight in $\Gamma$, and that this operation takes time $O(|g|)$. Applying Proposition \ref{prop:short_conj_in_H} to $x$ (which is of minimal length under conjugation by Lemma \ref{lemma:s_min}), we find that if $a^{-1}$ labels a geodesic in $\Gamma'$ starting at $H$ and $g^{wa} \in H$ then $(g^m)^{wa} =_G x^a \in H$ and either $|a| \le 3\delta + 2\epsilon + 1$ or $|x^a|_G \le 3\delta + 2\epsilon + 1$.
 
-Thus in either case, if $a^{-1}$ labels a geodesic in $\Gamma'$ starting at $H$ and $g^{wa} \in H$ then either $|a| \le L + 3\delta + 2\epsilon + 1$ or $|x^a|_G \le 3\delta + 2\epsilon + 1$. Also both $|x|$ and $|w|$ are in $O(|g|)$.
+Thus in either case, if $a^{-1}$ labels a geodesic in $\Gamma'$ starting at $H$ and $g^{wa} \in H$ then either $|a| \le L + 3\delta + 2\epsilon + 1$ or $|x^a|_G \le 3\delta + 2\epsilon + 1$. Also, $|x|$ and $|w|$ are in $O(|g|)$. The algorithm can therefore be implemented as follows.
 
 For each $X$-word $a$ of length at most $L + 3\delta + 2\epsilon + 1$, test if $g^{wa} \in H$. If this check succeeds for some $a$ then $wa$ is a suitable conjugating element and can be returned. If all checks here fail then continue to the next part. Each check can be performed in time $O(|g|)$ and the number of checks depends only on $X$ and $H$ so this case can be tested for in time $O(|g|)$.
 
-For all $X$-words $h$ with $|h| \le 3\delta + 2\epsilon + 1$, test if $h \in H$ and $x^a =_G h$ for some element $a \in G$. If such a $a$ is found then $wa$ is a suitable conjugating element and can be returned. If not then no conjugating element exits and we may return. Again, each check can be performed in time $O(|g|)$ by Theorem \ref{thm:linear_conj}, and the number of checks depends only on $X$ and $H$ so this case can also be tested for in time $O(|g|)$.
+For all $X$-words $h$ with $|h| \le 3\delta + 2\epsilon + 1$, test if $h \in H$ and $x^a =_G h$ for some element $a \in G$. If such a $a$ is found then $wa$ is a suitable conjugating element and can be returned. If not then no conjugating element exists and we may return. Again, each check can be performed in time $O(|g|)$ by Theorem \ref{thm:linear_conj}, and the number of checks depends only on $X$ and $H$ so this case can also be tested for in time $O(|g|)$.
 \end{proof}
 
-We remark that this method can of course be modified to return a rational language which contains all such conjugating elements as in Chapter \ref{chapter:conjugacy} without affecting the bound on its running time, and that it can likely be modified to test if a list of elements can be simultaneously conjugated into the subgroup. This latter result would provide a method of testing whether one quasiconvex subgroup is a subgroup of another.
+We remark that this method can of course be modified to return a rational language which contains all such conjugating elements as in Chapter \ref{chapter:conjugacy}, and that it can likely be modified to test if a list of elements can be simultaneously conjugated into the subgroup. This latter result would provide a method of testing whether or not one quasiconvex subgroup is a conjugate of a subgroup of another.
 
 \section{Checking equality of double cosets}
 
-In this section, we demonstrate that it is possible to efficiently determine if two double cosets of quasiconvex subgroups are equal. We begin by showing it's possible to find a double coset representative that's ``nearly optimal'' in both directions.
+In this section, we demonstrate that it is possible to efficiently determine if two double cosets of quasiconvex subgroups are equal. We begin by showing that it's possible to find a double coset representative that's ``nearly optimal'' in both directions.
 
 \begin{proposition}
 \label{prop:shorten_coset_rep}
-Given a $\Gamma$-geodesic $w$ one can find an $X$-word $u$ such that $|u| \le |w|$, $Hw = Hu$ and $d(H, Hw) \ge |u| - 3\delta - \epsilon$ in time $O(|w|)$.
+Given an $X$-word $w$ one can find an $X$-word $u$ such that $|u| \le |w|$, $Hw = Hu$ and $d(H, Hw) \ge |u| - 3\delta - \epsilon$ in time $O(|w|)$.
 
-Suppose additionally that $K$ is a given $\zeta$-quasiconvex subgroup. Then one can find a $\Gamma$-geodesic $v$ with $HwK = HvK$ such that $d(K, Kv^{-1}) \ge |v| - 3\delta - \zeta - 1$ and $d(H, Hv) \ge |v| - 8\delta - 2\epsilon - \zeta$ in time $O(|w|)$.
+Suppose additionally that $K$ is a given $\zeta$-quasiconvex subgroup. Then one can find an $X$-word $v$ with $HwK = HvK$ such that $d(K, Kv^{-1}) \ge |v| - 3\delta - \zeta$ and $d(H, Hv) \ge |v| - 8\delta - 2\epsilon - \zeta$ in time $O(|w|)$.
 \end{proposition}
 
 \begin{proof}
-Suppose $d(H, Hw(i)) \ge 3\delta + \epsilon + 1$ for some $i \le |w|$. By Lemma \ref{lemma:extend_long_coset} with $w_1 = w(i)$ and $w_2 = w(i:|w|)$ we have $d(H, Hw) \ge d(H, Hw(i)) + |w(i:|w|)| - 3\delta - \epsilon$. We need only therefore find such an $i$ (or show that none exists).
+Begin by replacing $w$ with $\slex(w)$ so that $w$ labels a geodesic in $\Gamma$.
 
-Thus, for each $i \lw |w|$ let $R_i = \{ \slex(a) : |a| \le 3\delta + \epsilon, w(i)a^{-1} \in H \}$. These sets can be computed in time $O(|w|)$ as each $|wa| \le |w| + 3\delta + \epsilon$ for each $a$, and the number of $a$ depends only on $X$ and $H$.
+Suppose $d(H, Hw(i)) \ge 3\delta + \epsilon + 1$ for some $i \le |w|$. By Lemma \ref{lemma:extend_long_coset} with $w_1 = w(i)$ and $w_2 = w(i:|w|)$ we have $d(H, Hw) \ge d(H, Hw(i)) + |w(i:|w|)| - 3\delta - \epsilon - 1$. We need only therefore find such an $i$ (or show that none exists).
 
+Thus, for each $1 \le i \le |w|$ let $R_i = \{ \slex(a) : |a| \le 3\delta + \epsilon, b_{i-1}w[i]a^{-1} \in H \}$ where $b_{i-1}$ is the shortest element of $R_{i-1}$ and $b_0$ is the empty word. Stop once $R_i$ becomes empty. These sets can be computed in time $O(|w|)$ as $|b_{i-1}a| \le 2(3\delta + \epsilon)$ for each $a$, and the number of $a$ depends only on $X$ and $H$.
+
 If $R_{|w|}$ is non-empty, let $u$ be the short-lex least element of $R_{|w|}$ and we have $|u| \le |w|$, $Hu = Hw$ and $d(H, Hw) = |u|$ so we are done.
 
-Otherwise, pick the largest value of $i$ such that $R_i$ is nonempty. Let $w_0$ be any element of $R_i$ and notice that $d(H, Hw_0w[i]) = 3\delta + \epsilon + 1$. Let $u := \slex(w_0w(i:|w|))$ and we see that $Hu = Hw$ and \begin{eqnarray*}
+Otherwise, pick the largest value of $i$ such that $R_i$ is nonempty. Let $w_0$ be any element of $R_i$ and notice that $|w_0| = 3\delta + \epsilon$ and $Hw_0w[i] = Hw(i)$, so $d(H, Hw_0w[i]) = 3\delta + \epsilon + 1$.
+
+Let $u := \slex(w_0w(i:|w|))$ and we see that $|u| \le |w|$ and $Hu = Hw$. By Lemma \ref{lemma:extend_long_coset} we have \begin{eqnarray*}
         d(H, Hw)
-& \ge & d(H, Hw_0) + |w(i+1:|w|)| - 3\delta - \epsilon \\
-& \ge & |w(i+1:|w|)| + 1 \\
-& \ge & |u| - |w_0| + 1 \\
-&  =  & |u| - 3\delta - \epsilon
-\end{eqnarray*}, so $u$ satisfies the requirements of the hypothesis and is computed in time $O(|w|)$ as required for the first part.
+& \ge & d(H, Hw_0w[i]) + |w(i+1:|w|)| - 3\delta - \epsilon - 1 \\
+& \ge & |w(i+1:|w|)| \\
+& \ge & |u| - |w_0| \\
+&  =  & |u| - 3\delta - \epsilon,
+\end{eqnarray*} so $u$ satisfies the requirements of the hypothesis and is computed in time $O(|w|)$ as required for the first part.
 
-For the second part, apply the first part again; this time using the subgroup $K$ instead of $H$ and the word $u^{-1}$ instead of $w$ as input to get an integer $i$, an $X$-word $u_0$ satisfying $|u_0| \le 3\delta + \zeta$ and an $X$-word $v' = \slex(u_0u^{-1}(i:|u|))$ with $d(K, Kv') \ge |v'| - 3\delta - \zeta$. Let $v := v'^{-1}$ and we find that $d(K, Kv^{-1}) \ge |v| - 3\delta - \zeta$ so it remains to show that $d(H, Hv)$ is sufficiently large.
+For the second part, apply the first part again; this time using the subgroup $K$ instead of $H$ and the word $u^{-1}$ instead of $w$ as input to get an integer $i$, an $X$-word $u_0$ satisfying $|u_0| = 3\delta + \zeta$ and an $X$-word $v' = \slex(u_0u^{-1}(i:|u|))$ with $d(K, Kv') \ge |v'| - 3\delta - \zeta$.
 
-Note that if $|v| \le 8\delta + 2\epsilon + \zeta$ then we are done so suppose that $|v| \ge 8\delta + 2\epsilon + \zeta + 1$. Since $|v| \le |u|$, we may assume that $|u| \ge 8\delta + 2\epsilon + \zeta + 1$ also.
+Let $v := v'^{-1}$ and we find that $d(K, Kv^{-1}) \ge |v| - 3\delta - \zeta$ as required, so it remains to show that $d(H, Hv)$ is sufficiently large.
 
+Note that if $|v| \le 8\delta + 2\epsilon + \zeta$ then we are done, so suppose that $|v| \ge 8\delta + 2\epsilon + \zeta + 1$. Since $|v| \le |u|$, we therefore have $|u| \ge 8\delta + 2\epsilon + \zeta + 1$ as well.
+
 Let $t$ label a geodesic in $\Gamma'$ connecting $H$ to $Hv$. If $|v| - |t| \le 5\delta + 2\epsilon$ then $d(H, Hv) \le |v| - 5\delta - 2\epsilon$ so we are done. Thus assume that $|v| - |t| \ge 5\delta + 2\epsilon + 1$. Let $j := 5\delta + 2\epsilon + 1$.
 
-Construct a geodesic triangle in $\Gamma$ with corners $\vertex{a}$, $\vertex{b} := \vertex{a} \cdot u(|u|-i)$ and $\vertex{c} := \vertex{a} \cdot v$ as in Figure ??. %\ref{figure:blah}
-Noting that $u(|u|-i) =_G u^{-1}(i:|u|) =_G u_0^{-1}v'$ we may take the side labels to be $u(|u|-i)$, $v$ and $u_0$. Then \begin{eqnarray*}
+\begin{figure}
+\begin{center}
+\input short_coset_rep.pstex_t
+\caption{The double coset representatives}
+\label{figure:short_coset_rep}
+\end{center}
+\end{figure}
+
+Construct a geodesic triangle in $\Gamma$ with corners $\vertex{a}$, $\vertex{b} := \vertex{a} \cdot u(|u|-i)$ and $\vertex{c} := \vertex{a} \cdot v$ as in Figure \ref{figure:short_coset_rep}. Noting that $u(|u|-i) =_G u^{-1}(i:|u|) =_G u_0^{-1}v'$ we may take the side labels to be $u(|u|-i)$, $v$ and $u_0$. Then \begin{eqnarray*}
         (\vertex{b}, \vertex{c})_{\vertex{a}}
 & \ge & d(\vertex{a}, \vertex{b}) - d(\vertex{b}, \vertex{c}) \\
 &  =  & |u| - |u_0| \\
 & \ge & 5\delta + 2\epsilon + 1
 \end{eqnarray*} and $\vertex{p} := \vertex{a} \cdot u(j)$ corresponds to a point $\vertex{q}$ on $\path{\vertex{a}}{\vertex{c}}$.
 
-Construct a second geodesic triangle with corners $\vertex{a}$, $\vertex{b}$ and $\vertex{d} := \vertex{a} \cdot t$, picking $\slex(vt^{-1})$ as the side label for $\path{\vertex{a}}{\vertex{d}}$. Then \begin{eqnarray*}
+Construct a second geodesic triangle with corners $\vertex{a}$, $\vertex{c}$ and $\vertex{d} := \vertex{a} \cdot t$, picking $\slex(vt^{-1})$ as the side label for $\path{\vertex{a}}{\vertex{d}}$. Then \begin{eqnarray*}
         (\vertex{b}, \vertex{d})_{\vertex{a}}
 & \ge & d(\vertex{a}, \vertex{c}) - d(\vertex{c}, \vertex{d}) \\
 &  =  & |v| - |t| \\
@@ -1810,7 +1910,17 @@
 
 If $HuK = HvK$ then there exist elements $h \in H$ and $k \in K$ with $uk =_G hv$. We may assume that $h$ and $k$ are picked to minimize $|h| + |k|$ and are therefore label geodesics in $\Gamma$. Let $\vertex{a}$ be the vertex representing the identity element of $G$. Let $\vertex{b} := \vertex{a} \cdot h$, $\vertex{c} := \vertex{b} \cdot v$ and $\vertex{d} := \vertex{a} \cdot u$. Then we have a geodesic quadrilateral in $\Gamma$ with side labels $h$, $v$, $k$ and $u$. Pick some geodesic connecting $\vertex{a}$ to $\vertex{c}$ to split this quadrilateral into two geodesic triangles.
 
-Suppose some vertex $\vertex{p}$ on $\path{\vertex{b}}{\vertex{c}}$ $2$-corresponds to a vertex on $\path{\vertex{c}}{\vertex{d}}$. Then since $K$ is $\zeta$-quasiconvex and $k$ is a $\Gamma$-geodesic element of $K$ we have some vertex $\vertex{q}$ in $\Gamma$ which represents and element of $K$ with $d(\vertex{p}, \vertex{q}) \le 2\delta + \zeta$. In particular, \begin{eqnarray*}
+This quadrilateral is illustrated in Figure \ref{figure:double_coset_reps}. The next part of the proof is to demonstrate that each corner has a meeting point close to it. This will either give a bound on the lengths of $h$ and $k$, or a bound on the lengths of $u$ and $v$. In the latter case, we will prove that the number of vertices on $\path{\vertex{d}}{\vertex{c}}$ which $2$-correspond to vertices on $\path{\vertex{a}}{\vertex{b}}$ is also bounded to give a bound once again on the lengths of $h$ and $k$.
+
+\begin{figure}
+\begin{center}
+\input double_coset_reps.pstex_t
+\caption{The double coset representatives}
+\label{figure:double_coset_reps}
+\end{center}
+\end{figure}
+
+Suppose that some vertex $\vertex{p}$ on $\path{\vertex{b}}{\vertex{c}}$ $2$-corresponds to a vertex on $\path{\vertex{c}}{\vertex{d}}$. Then since $K$ is $\zeta$-quasiconvex and $k$ labels a geodesic in $\Gamma$ and $K$ is $\zeta$-quasiconvex, we have some vertex $\vertex{q}$ in $\Gamma$ which represents and element of $K$ with $d(\vertex{p}, \vertex{q}) \le 2\delta + \zeta$. In particular, \begin{eqnarray*}
         d(K, Kv^{-1})
 & \le & d(\vertex{q}, \vertex{p}) + d(\vertex{p}, \vertex{b}) \\
 & \le & |v| - d(\vertex{p}, \vertex{c}) + 2\delta + \zeta \\
@@ -1827,15 +1937,23 @@
 
 Suppose that for some integer $i$, the vertex $\vertex{p_i} := \vertex{d} \cdot k(i)$ $2$-corresponds to the vertex $\vertex{q_i} := \vertex{a} \cdot h(j)$ where $j := (\vertex{c}, \vertex{d})_{\vertex{a}} - (\vertex{a}, \vertex{c})_{\vertex{d}} - i$.
 
-There is a vertex $\vertex{r_i} \in \Gamma$ representing an element of $K$ such that $d(\vertex{p_i}, \vertex{r_i}) \le \zeta$ and similarly there is a vertex $\vertex{s_i} \in \Gamma$ representing an element of $H$ such that $d(\vertex{q_i}, \vertex{s_i}) \le \epsilon$. Let $w_i$ label a geodesic in $\Gamma$ connecting $\vertex{r_i}$ to $\vertex{s_i}$ and observe that $|w_i| = d(\vertex{r_i}, \vertex{s_i}) \le 2\delta + \epsilon + \zeta$.
+There is a vertex $\vertex{r_i} \in \Gamma$ representing an element of $K$ such that $d(\vertex{p_i}, \vertex{r_i}) \le \zeta$ and similarly there is a vertex $\vertex{s_i} \in \Gamma$ representing an element of $H$ such that $d(\vertex{q_i}, \vertex{s_i}) \le \epsilon$. Let $w_i$ label a geodesic in $\Gamma$ connecting $\vertex{s_i}$ to $\vertex{r_i}$ and observe that $|w_i| = d(\vertex{s_i}, \vertex{r_i}) \le 2\delta + \epsilon + \zeta$. See Figure \ref{figure:double_coset_h_k_long} for a complete picture.
 
-Suppose that more than $P(\epsilon + \zeta)$ vertices on $\path{\vertex{d}}{\vertex{c}}$ correspond to vertices on $\path{\vertex{a}}{\vertex{b}}$ so that there exist integers $x < y - \epsilon - \zeta$ with $w_x = w_y$. Let $k_1$, $k_2$ and $k_3$ be label geodesics in $\Gamma$ connecting $\vertex{d}$ to $\vertex{r_x}$, $\vertex{r_x}$ to $\vertex{r_y}$ and $\vertex{r_y}$ to $\vertex{c}$ respectively. Define $h_1$, $h_2$ and $h_3$ to label geodesics connecting $\vertex{a}$, $\vertex{s_x}$, $\vertex{s_y}$ and $\vertex{b}$ similarly.
+\begin{figure}
+\begin{center}
+\input double_coset_h_k_long.pstex_t
+\caption{Finding a shorter $h$ and $k$}
+\label{figure:double_coset_h_k_long}
+\end{center}
+\end{figure}
 
-Then $w_x =_G h_2w_y^{-1}k_2^{-1} = h_2w_x^{-1}k_2^{-1}$ and $w_x =_G h_3vk_3^{-1}$ so that \begin{eqnarray*}
+Suppose that more than $P(\epsilon + \zeta)$ vertices on $\path{\vertex{d}}{\vertex{c}}$ correspond to vertices on $\path{\vertex{a}}{\vertex{b}}$ so that there exist integers $i < j - \epsilon - \zeta$ with $w_i = w_j$. Let $k_1$, $k_2$ and $k_3$ label geodesics in $\Gamma$ connecting $\vertex{a}$ to $\vertex{r_i}$, $\vertex{r_i}$ to $\vertex{r_j}$ and $\vertex{r_j}$ to $\vertex{c}$ respectively. Define $h_1$, $h_2$ and $h_3$ to label geodesics connecting $\vertex{a}$, $\vertex{s_i}$, $\vertex{s_j}$ and $\vertex{b}$ similarly.
+
+Then $w_i =_G h_2w_jk_2^{-1} = h_2w_ik_2^{-1}$ and $w_i =_G h_3vk_3^{-1}$ so that \begin{eqnarray*}
         hvk^{-1}
 & =_G & h_1h_2h_3vk_3^{-1}k_2^{-1}k_1^{-1} \\
-& =_G & h_1h_2w_xk_2^{-1}k_1^{-1} \\
-& =_G & h_1w_xk_1^{-1} \\
+& =_G & h_1h_2w_ik_2^{-1}k_1^{-1} \\
+& =_G & h_1w_ik_1^{-1} \\
 & =_G & h_1h_3vk_3^{-1}k_1^{-1},
 \end{eqnarray*} but then $|h_1h_3| + |k_1k_2| \le |h| + 2\epsilon + |k| + 2\zeta - 2(y-x) < |h| + |k|$ but $h_1h_3v =_G uk_1k_3$ which contradicts minimality of $|h| + |k|$. Thus at most $P(\epsilon + \zeta)$ vertices on $\path{\vertex{d}}{\vertex{c}}$ can correspond to vertices on $\path{\vertex{a}}{\vertex{b}}$ and by counting corresponding vertices we have $|h| \le 19\delta + 4\epsilon + 2\zeta + P(\epsilon + \zeta) + 1$ and $|k| \le 9\delta + 2\zeta + P(\epsilon + \zeta) + 1$. But then $|h| + |k| \le 28\delta + 4\epsilon + 4\zeta + 2P(\epsilon + \zeta) + 2 = B$ as required and the claim is proved.
 
@@ -1848,8 +1966,27 @@
 
 \section{Introduction}
 
-This chapter is largely based on work by Foord in his PhD thesis \cite{foord2000thesis}. Foord studies some properties about various graphs relating to hyperbolic groups and their subgroups. The work here slightly generalises this as well as providing some improved constants relating to these results. We will work with $X$-graphs, as detailed in Section \ref{section:xgraph}. We invite the reader to recap that section before continuing as many of the definitions there have been neglected until now.
+This chapter is largely based on work by Foord in his PhD thesis \cite{foord2000thesis}. Foord studies some properties about coset Cayley graphs of quasiconvex subgroups of word-hyperbolic groups. The work here slightly generalises this as well as providing some improved constants relating to these results. We will work with $X$-graphs, as detailed in Section \ref{section:xgraph}. We invite the reader to recap that section before continuing as some of the definitions there have been neglected until now.
 
+We first show that $X$-maps $f$ which have quasiconvex $f^{-1}(f(\vertex{e}))$ preserve hyperbolicity. We define a concept of ``eventually isomorphic balls'' and show that this is preserved under certain conditions, then prove that if this is true for reasonably large balls it is true for all balls. These statements will be made rather more precise in the next section.
+
+We then give a bound on the ``eventually isomorphic balls'' distance in the case of coset Cayley graphs of hyperbolic groups relative to quasiconvex subgroups. Finally, we demonstrate a simple implication of having ``eventually isomorphic balls.''
+
+\section{Definitions}
+
+In this section, we define the constructions that we will be working with later.
+
+\begin{definition}
+\label{def:connected}
+Given a set of vertices $\Gamma'$ in a graph $\Gamma$, the \textbf{subgraph of $\Gamma$ induced by $\Gamma'$} is $\Gamma'$ together with every edge in $\Gamma$ which connects two vertices in $\Gamma'$.
+
+A set $\Gamma'$ of vertices in a $X$-graph $\Gamma$ is a \textbf{connected vertex subset} or \textbf{CVS} if the subgraph of $\Gamma$ induced by $\Gamma'$ is connected. Where we are not concerned with the full $X$-graph $\Gamma$, we will simply say that $\Gamma'$ is an $X$-CVS.
+
+If $\Gamma'$ is an $X$-CVS, $\vertex{p} \in \Gamma'$ and $w$ is an $X$-word, $w$ is a \textbf{$\Gamma'$-word} at $p$ if $p \cdot w(i) \in \Gamma'$ for each $i \in \{ 1, \ldots, |w| \}$.
+\end{definition}
+
+That is, a $\Gamma'$-word at $\vertex{p}$ is a word labelling a path starting at $\vertex{p}$ whose vertices are all inside $\Gamma'$, and a CVS is a set of vertices which are pairwise connected by $\Gamma'$-words. Notice that a finite ball is in particular a CVS.
+
 Much of this section concerns the similarity of CVSs, which we define in terms of graph morphisms.
 
 \begin{definition}
@@ -1861,7 +1998,7 @@
 
 \begin{proposition}
 \label{proposition:xmap_defined_by_point}
-Suppose that both $\Gamma_1$ and $\Gamma_2$ are $X$-CVSs and let $f : \Gamma_1 \to \Gamma_2$ be any function. Then $f$ is an $X$-map if and only if for all $\Gamma_1$-words $w$ and vertices $\vertex{p}$ in $\Gamma_1$ we have $f(\vertex{p} \cdot w) = f(\vertex{p}) \cdot w$.
+Suppose that both $\Gamma_1$ and $\Gamma_2$ are $X$-CVSs and let $f : \Gamma_1 \to \Gamma_2$ be any function which sends edges to edges and vertices to vertices. Then $f$ is an $X$-map if and only if for all $\Gamma_1$-words $w$ and vertices $\vertex{p}$ in $\Gamma_1$ we have $f(\vertex{p} \cdot w) = f(\vertex{p}) \cdot w$.
 
 In particular, if $f : \Gamma_1 \to \Gamma_2$ and $g : \Gamma_1 \to \Gamma_2$ are $X$-maps and $\vertex{q}$ is a vertex in $\Gamma_1$, then $f = g$ if and only $f(\vertex{q}) = g(\vertex{q})$.
 \end{proposition}
@@ -1869,14 +2006,14 @@
 \begin{proof}
 Suppose $f$ is an $X$-map and let $\tilde{f}$ be the extension of $f$ to the subgraphs induced by $\Gamma_1$ and $\Gamma_2$.
 
-Since $\tilde{f}$ preserves edge labels and directions, given a vertex $\vertex{p}$ in $\Gamma_1$ and element $x \in X$, if there is an edge $e$ which is labelled $x$ and starts at $\vertex{p}$, then $\tilde{f}(e)$ is labelled $x$, starting at $f(\vertex{p})$ and ends at $f(\vertex{p}) \cdot x$. This implies that $f(\vertex{p} \cdot x) = f(\vertex{p}) \cdot x$. The same is true for edges labelled $x$ which end at $\vertex{p}$, so $f(\vertex{p} \cdot u) = f(\vertex{p}) \cdot u$ for any word $u$ of length $1$. Now for any $X$-word $w$, \begin{eqnarray*}
+Since $\tilde{f}$ preserves edge labels and directions, given a vertex $\vertex{p}$ in $\Gamma_1$ and element $x \in X$, if there is an edge $e$ which is labelled $x$ and starts at $\vertex{p}$, then $\tilde{f}(e)$ is labelled $x$, starts at $f(\vertex{p})$ and ends at $f(\vertex{p}) \cdot x$. This implies that $f(\vertex{p} \cdot x) = f(\vertex{p}) \cdot x$. The same is true for edges labelled $x$ which end at $\vertex{p}$, so $f(\vertex{p} \cdot u) = f(\vertex{p}) \cdot u$ for any $X$-word $u$ of length $1$. Now for any $X$-word $w$, \begin{eqnarray*}
       f(\vertex{p} \cdot w)
 & = & f((\ldots((\vertex{p} \cdot w[1]) \cdot w[2]) \ldots ) \cdot w[|w|] ) \\
 & = & (\ldots((f(\vertex{p}) \cdot w[1]) \cdot w[2]) \ldots ) \cdot w[|w|] \\
 & = & f(\vertex{p}) \cdot w,
 \end{eqnarray*} as required.
 
-Now we must prove the converse. Suppose that for all $\Gamma_1$-words $w$ and vertices $\vertex{p}$ in $\Gamma_1$ we have $f(\vertex{p} \cdot w) = f(\vertex{p}) \cdot w$. Notice that for any $x \in X$, since $x$ and $x^{-1}$ are $X$-words, the endpoints and directions of any edges pointing into and out of $\vertex{p}$ with label $x$ are preserved, thus $f$ can be extended to a graph morphism and is therefore an $X$-map.
+We now prove the converse. Suppose that for all $\Gamma_1$-words $w$ and vertices $\vertex{p}$ in $\Gamma_1$ we have $f(\vertex{p} \cdot w) = f(\vertex{p}) \cdot w$. Notice that for any $x \in X$, since $x$ and $x^{-1}$ are $X$-words, the endpoints and directions of any edges pointing into and out of $\vertex{p}$ with label $x$ are preserved, thus $f$ can be extended to a graph morphism and is therefore an $X$-map.
 
 For the last part, it is clear that $f \ne g$ if $f(\vertex{q}) \ne g(\vertex{q})$. Suppose that $f(\vertex{q}) = g(\vertex{q})$. For any vertex $\vertex{r} \in \Gamma_1$ there is a $\Gamma_1$ word, say $w$, with $\vertex{q} \cdot w = \vertex{r}$. But then \begin{eqnarray*}
       f(\vertex{r})
@@ -1893,13 +2030,15 @@
 
 \begin{proposition}
 \label{proposition:contraction}
-Suppose that $\Gamma_1$ and $\Gamma_2$ are graphs in which all edges have length 1, that $f : \Gamma_1 \to \Gamma_2$ is a morphism of graphs and that $a$ and $b$ are vertices in $\Gamma$. Then $d(f(a), f(b)) \le d(a, b)$.
+Suppose that $\Gamma_1$ and $\Gamma_2$ are graphs in which all edges have length 1, that $f : \Gamma_1 \to \Gamma_2$ is a morphism of graphs and that $\vertex{a}$ and $\vertex{b}$ are vertices in $\Gamma$. Then $d(f(\vertex{a}), f(\vertex{b})) \le d(\vertex{a}, \vertex{b})$.
 \end{proposition}
 
 \begin{proof}
-Note that any geodesic path connecting $a$ to $b$ must be mapped to a path connecting $f(a)$ to $f(b)$.  Since edges are sent to edges and vertices are sent to vertices, there is a path in $\Gamma_2$ connecting $f(a)$ to $f(b)$ of length $d(a, b)$, so $d(f(a), f(b)) \le d(a, b)$.
+Note that any geodesic path connecting $\vertex{a}$ to $\vertex{b}$ must be mapped to a path connecting $f(\vertex{a})$ to $f(\vertex{b})$.  Since edges are sent to edges and vertices are sent to vertices, there is a path in $\Gamma_2$ connecting $f(\vertex{a})$ to $f(\vertex{b})$ of length $d(\vertex{a}, \vertex{b})$, so $d(f(\vertex{a}), f(\vertex{b})) \le d(\vertex{a}, \vertex{b})$.
 \end{proof}
 
+Again, we will use this proposition often without reference.
+
 When determining whether two balls are the same, it is convenient to ensure that not only is there a bijective $X$-map between them, but that this map preserves the centres.
 
 \begin{definition}
@@ -1918,9 +2057,9 @@
 \end{proposition}
 
 \begin{proof}
-Suppose that $\Gamma_1$ is an $X$-graph. Pick any vertex $\vertex{q}$ in $\Gamma_1$. Since $X$-graphs are connected, given any vertex $\vertex{r}$ in $\Gamma_2$, there is an $\Gamma_2$-word at $f(\vertex{q})$, say $w$, with $f(\vertex{q}) \cdot w = \vertex{r}$. Then $w$ is a $\Gamma_1$-word at $\vertex{q}$ (as any $X$-word is), so $f(\vertex{q}) \cdot w = f(\vertex{q} \cdot w)$ and $\vertex{q} \cdot w$ is a vertex in $\Gamma_1$ which maps to $\Gamma_2$ and $f$ is surjective.
+Suppose that $\Gamma_1$ is an $X$-graph. Pick any vertex $\vertex{q}$ in $\Gamma_1$. Since $X$-graphs are connected, given any vertex $\vertex{r}$ in $\Gamma_2$, there is an $\Gamma_2$-word at $f(\vertex{q})$, say $w$, with $f(\vertex{q}) \cdot w = \vertex{r}$. Then $w$ is a $\Gamma_1$-word at $\vertex{q}$ (as any $X$-word is), so $f(\vertex{q}) \cdot w = f(\vertex{q} \cdot w)$ and $\vertex{q} \cdot w$ is a vertex in $\Gamma_1$ which maps to $\Gamma_2$ and we have shown that $f$ is surjective.
 
-Similarly, suppose that $\Gamma_1$ and $\Gamma_2$ are balls of the same radius, $r$ say, that $f$ is a ball morphism, that $\vertex{q}$ is the centre of $\Gamma_1$ and that $\vertex{r} \in \Gamma_2$. Then since $f$ is a ball morphism, $f(\vertex{q})$ is the centre of $\Gamma_2$ so there is a $\Gamma_2$-word at $f(\vertex{q})$, say $w$, of length at most $r$ which satisfies $f(\vertex{q}) \cdot w = \vertex{r}$. But then $w$ is a $\Gamma_1$-word (as any $X$-word of length at most $r$ is), so once again $f(\vertex{q}) \cdot w = f(\vertex{q} \cdot w)$ and $f$ is surjective.
+Similarly, suppose that $\Gamma_1$ and $\Gamma_2$ are balls of the same radius, $R$ say, that $f$ is a ball morphism, that $\vertex{q}$ is the centre of $\Gamma_1$ and that $\vertex{r} \in \Gamma_2$. Then since $f$ is a ball morphism, $f(\vertex{q})$ is the centre of $\Gamma_2$ so there is a $\Gamma_2$-word at $f(\vertex{q})$, say $w$, of length at most $R$ which satisfies $f(\vertex{q}) \cdot w = \vertex{r}$. But then $w$ is a $\Gamma_1$-word (as any $X$-word of length at most $R$ is), so once again $f(\vertex{q}) \cdot w = f(\vertex{q} \cdot w)$ and $f$ is surjective.
 \end{proof}
 
 \begin{figure}
@@ -1934,76 +2073,92 @@
 The restriction that the centre of the ball is preserved is justified since one can produce an example of an $X$-graph where two equal radius balls around different points are equal as sets but not isomorphic as balls, illustrated below.
 
 \begin{example}
-The following construction is illustrated in Figure \ref{figure:ball_not_iso}.
-
 Let $G$ be the free group on the set $\{a, b\}$. Let $H$ be the subgroup of $G$ generated by $ba^{-1}$, $b^2a$, $b^{-2}a$ and $b^{-1}a^2$, and let $\Gamma$ be its coset Cayley graph with respect to $X$, which is illustrated in Figure \ref{figure:ball_not_iso}. The tree structures on the left and right of the illustration represent subgraphs of the Cayley graph of $G$ with respect to $\{a, b\}$.
 
 Notice that if $\vertex{x}$ is a vertex in $\Gamma$ which is neither $H$ nor $Ha$ then $d(H, \vertex{x}) = d(Ha, \vertex{x})$, so if $k > 0$ then $B_k(H) = B_k(Ha)$ as sets. However, $ab^{-1}$ labels a loop at $H$ but not $Ha$, so there is no $X$-map from $B_k(H)$ which sends $H$ to $Ha$. In particular, these balls are not ball isomorphic.
 \end{example}
 
-We now define a concept of ``mostly homogeneous''.
+We now define a concept of ``mostly homogeneous''. The GIB property and IB property for a single graph correspond to the definitions by Foord.
 
 \begin{definition}
 Suppose that $\Gamma$ is an $X$-graph with base vertex $\vertex{b}$. Then for non-negative $k \in \mathbb{Z}$ we say:
 
-$\Gamma$ has \textbf{IB($k$)} if there exists some $K$ such that if $\vertex{p}, \vertex{q} \in \Gamma$ are vertices with $d(\vertex{b}, \vertex{p}) \ge K$ and $d(\vertex{b}, \vertex{q}) \ge K$ then $B_k(\vertex{p})$ and $B_k(\vertex{q})$ are ball isomorphic. Thus there is a canonical $k$-ball of $\Gamma$ to which balls of radius $k$ are ball which are sufficiently far from $\vertex{b}$ are isomorphic to. We label this ball \textbf{$\canonicalball{k}{\Gamma}$}.
+$\Gamma$ has \textbf{IB($k$)} if there exists some $K$ such that $B_k(\vertex{p})$ and $B_k(\vertex{q})$ are ball isomorphic for any vertices $\vertex{p}, \vertex{q} \in \Gamma$ with $d(\vertex{b}, \vertex{p}) \ge K$ and $d(\vertex{b}, \vertex{q}) \ge K$. Thus there is a canonical $k$-ball of $\Gamma$ to which balls of radius $k$ are ball which are sufficiently far from $\vertex{b}$ are isomorphic to. We label this ball \textbf{$\canonicalball{k}{\Gamma}$}.
 
 Suppose $S$ is a collection of $X$-graphs which all satisfy $IB(k)$. Then we say $S$ satisfies $IB(k)$ if $\canonicalball{k}{\Gamma_1}$ and $\canonicalball{k}{\Gamma_2}$ are ball isomorphic for any two elements $\Gamma_1$ and $\Gamma_2$ in $S$.
 
-Suppose $G$ is some group generated by $X$ with Cayley graph $\Gamma_G$. Then $\Gamma$ has \textbf{GIB($k$)} if $\{\Gamma, \Gamma_G\}$ has $IB(k)$.
+Suppose $G$ is some group generated by $X$ with Cayley graph $\Gamma_G$. Then $\Gamma$ has \textbf{GIB($k$)} with respect to $G$ if $\{\Gamma, \Gamma_G\}$ has $IB(k)$.
 
 Where the presentation is understood, we will refer to a subgroup of a group as having IB($k$) or GIB($k$) if its associated coset Cayley graph does.
 \end{definition}
 
-In other words, these imply that provided you can't see more than a given finite distance and are sufficiently far from the base point it is impossible to tell where you are, or which graph you are in.
+In other words, these properties imply that provided you can't see more than a given finite distance and are sufficiently far from the base point it is impossible to tell where you are in the graph, or which graph you are in.
 
-The concept of quasiconvexity of subgroups (Definition \ref{def:quasiconvex_sg}) carries over neatly into the case of an $X$-map.
+The concept of quasiconvexity of subgroups (Definition \ref{def:quasiconvex_sg}) is a special case of a similar condition for subsets of a graph. We state this condition in terms of $X$-graphs.
 
 \begin{definition}
-Suppose $\Gamma_1$ and $\Gamma_2$ are $X$-graphs with base points $\vertex{b_1}$ and $\vertex{b_2}$ respectively, that $f:\Gamma_1 \to \Gamma_2$ is an $X$-map and that $\vertex{b_2} = f(\vertex{b_1})$. Then $f$ is $\epsilon$-quasiconvex if whenever $w$ is a $\Gamma_1$-geodesic at some vertex $\vertex{p}$ and $f(\vertex{p}) = f(\vertex{p} \cdot w) = f(\vertex{b})$ then $d(f(\vertex{p} \cdot w(i)), f(\vertex{b})) \le \epsilon$ for all $0 \le i \le |w|$.
+Suppose $\Gamma$ is an $X$-graph. Then a set $S$ of vertices in $\Gamma$ is $\epsilon$-quasiconvex if whenever $w$ is a word labelling a geodesic between two vertices $\vertex{s}$ and $\vertex{t}$ in $S$ and $i \le |w|$ there is an vertex $\vertex{u} \in S$ with $d(\vertex{s} \cdot w(i), \vertex{u}) \le \epsilon$.
 \end{definition}
 
-In \cite{foord2000thesis}, Foord proves that for a quasiconvex subgroup $H$ of a hyperbolic group $G$, the coset Cayley graph with respect to any finite generating set of $G$ is hyperbolic. He also shows that it has GIB($k$) for all non-negative $k \in \mathbb{Z}$ (Foord refers to this as $GIB(\infty)$) if and only if the index $|C_G(h) : C_G(h) \cap H|$ is finite for any $h \in H$. In particular, this is true of any torsion free quasiconvex subgroup. However, the hyperbolicity constant given there is rather inefficient, and no bounds on the constants involved in the GIB result are given. It is the aim of this chapter to generalise this work somewhat by dropping some of the restrictions that one graph be a Cayley graph and providing some rather lower constants.
+We will be studying the case of an $X$-map $f$ where $f^{-1}(\vertex{b})$ is quasiconvex for the base point $\vertex{b}$ of the target $X$-graph.
 
+In \cite{foord2000thesis}, Foord proves that for a quasiconvex subgroup $H$ of a hyperbolic group $G$, the coset Cayley graph with respect to any finite generating set of $G$ is hyperbolic. He also shows that it has GIB($k$) for all non-negative $k \in \mathbb{Z}$ (Foord refers to this as $GIB(\infty)$) if and only if the index $|C_G(h) : C_G(h) \cap H|$ is finite for any $h \in H$. In particular, this is true of any torsion free quasiconvex subgroup. However, the hyperbolicity constant given there is rather large, and no bounds on the constants involved in the GIB result are given.
+
+It is the aim of this chapter to generalise this work somewhat by dropping some of the restrictions that one graph be a Cayley graph, and to provide some rather lower constants.
+
 \section{A Tighter Bound on the Thinness of Triangles}
 
-The aim of this section is to demonstrate that hyperbolicity carries over through quasiconvex $X$-maps, and in particular that coset Cayley graphs of quasiconvex subgroups are themselves hyperbolic. This result is a generalisation of Theorem 4.1.33 %
-in \cite{foord2000thesis}.
+The aim of this section is to demonstrate that hyperbolicity carries over through $X$-maps whose inverse of a single vertex is quasiconvex, and in particular that coset Cayley graphs of quasiconvex subgroups of hyperbolic groups are themselves hyperbolic. This result is a generalisation of Theorem 4.1.33 from \cite{foord2000thesis}, with a rather smaller constant (the constant given there was exponential in $\delta$ and $\epsilon$).
 
-\begin{theorem}
-\label{theorem:xg_h_qc_implies_h}
-Suppose $\Gamma$ is a $\delta$-vertex-hyperbolic $X$-graph with base point $\vertex{e}$, that $\Gamma'$ is an $X$-graph and that $f : \Gamma \to \Gamma'$ is an $\epsilon$-quasiconvex $X$-map. Then $\Gamma'$ is $16\delta+2\epsilon+2$-vertex-hyperbolic.
+We begin by giving a simple condition which implies that a triangle is thin.
 
-If every vertex $\vertex{p}$ on the sides a geodesic triangle in $\Gamma'$ whose corners lie on vertices has $d(f(\vertex{e}), \vertex{p}) > 5\delta + \epsilon$ then that triangle is $12\delta+2$-vertex-thin.
-\end{theorem}
+\begin{definition}
+\label{defn:nearly_thin}
+A triangle in an $X$-graph is \textbf{nearly $\delta$-thin $\epsilon$-relative to $\vertex{a}$} if $\vertex{a}$ is a vertex and given any pair $\vertex{p}$ and $\vertex{q}$ of corresponding points on the triangle, one of the following is true:
+\begin{enumerate}
+\item \label{item:corr} $\vertex{p}$ is within $6\delta$ of $\vertex{q}$,
+\item \label{item:close} $\vertex{p}$ is within $5\delta+\epsilon$ of $\vertex{a}$, or
+\item \label{item:feh} there are corresponding vertices $\vertex{p'}$ and $\vertex{q'}$ on the same sides as $\vertex{p}$ and $\vertex{q}$ such that $d(\vertex{p}, \vertex{p'}) \le 2\delta$.
+\end{enumerate}
+\end{definition}
 
-\begin{proof}
-Suppose we are given a geodesic triangle in $\Gamma'$ with corners $\vertex{A}$, $\vertex{B}$ and $\vertex{C}$. Suppose $f(\vertex{e}) \cdot w = \vertex{A}$, $\vertex{a} \cdot u = \vertex{B}$ and $\vertex{A} \cdot v = \vertex{B} \cdot x = \vertex{C}$, where $w$ is a $\Gamma'$-geodesic at $f(\vertex{e})$, and $u$, $v$ and $x$ are the $\Gamma'$-geodesic side labels of the triangle. The situation in $\Gamma'$ is illustrated in Figure \ref{figure:coset_thin_tri_in_ccay}.
+\begin{lemma}
+\label{lemma:qc_tri}
+Suppose $\Gamma$ is a $\delta$-vertex-hyperbolic $X$-graph with base point $\vertex{e}$, that $\Gamma'$ is an $X$-graph and that $f : \Gamma \to \Gamma'$ is an $X$-map such that $f^{-1}(f(\vertex{e}))$ is $\epsilon$-quasiconvex. If a geodesic triangle is nearly $\delta$-thin $\epsilon$-relative to $f(\vertex{e})$ then it is $14\delta+2\epsilon$-vertex-thin.
 
-We claim that for any such triangle, if $\vertex{P}$ is a vertex on $\path{\vertex{A}}{\vertex{B}}$ which corresponds to a vertex on $\path{\vertex{A}}{\vertex{C}}$, then either \begin{enumerate}
-\item \label{item:corr} $\vertex{P}$ is within $6\delta$ of its corresponding vertex on $\path{\vertex{A}}{\vertex{C}}$,
-\item \label{item:close} $\vertex{P}$ is within $5\delta+\epsilon$ of $f(\vertex{e})$, or
-\item \label{item:feh} $\vertex{P}$ is within $3\delta+1$ of some other vertex on $\path{\vertex{A}}{\vertex{B}}$ with one of the first two properties.
-\end{enumerate} Let us first show that this claim implies the theorem.
+If all vertices on the triangle are further than $5\delta + \epsilon$ from $f(\vertex{e})$ then it is $10\delta$-vertex-thin.
+\end{lemma}
 
-If $\vertex{P}$ satisfies the property \ref{item:feh} then let $\vertex{P'}$ be a vertex on $\path{\vertex{A}}{\vertex{B}}$ which is within $3\delta + 1$ of $\vertex{P}$ and satisfies property \ref{item:corr} or property \ref{item:close}; if not then simply let $\vertex{P'} := \vertex{P}$.
+\begin{proof}
+Suppose that the geodesic triangle has corners $\vertex{A}$, $\vertex{B}$ and $\vertex{C}$ and that $\vertex{P}$ is on $\path{\vertex{A}}{\vertex{B}}$ and correponds to $\vertex{Q}$ on $\path{\vertex{A}}{\vertex{C}}$. If $\vertex{P}$ satisfies property \ref{item:feh} then let $\vertex{P'}$ be a vertex on $\path{\vertex{A}}{\vertex{B}}$ which is within $2\delta$ of $\vertex{P}$ and satisfies property \ref{item:corr} or property \ref{item:close}; if not then simply let $\vertex{P'} := \vertex{P}$.
 
-Suppose that $\vertex{P'}$ satisfies property \ref{item:close}. Since $d(\vertex{P'}, \vertex{e}) \le 5\delta + \epsilon$ we need only prove that $d(\vertex{P}, \vertex{Q}) \le 16\delta + 2\epsilon + 2$. Let $\vertex{Q}$ be the vertex on $\path{\vertex{A}}{\vertex{C}}$ which corresponds to $\vertex{P}$. By swapping $\vertex{B}$ and $\vertex{C}$, we see that $\vertex{Q}$ must also satisfy the claim. Pick the vertex $\vertex{Q'}$ in the same manner as $\vertex{P'}$ so that $d(\vertex{Q}, \vertex{Q'}) \le 3\delta + 1$.
+Suppose that $\vertex{P'}$ satisfies property \ref{item:close}. Since $d(\vertex{P'}, f(\vertex{e})) \le 5\delta + \epsilon$ we need only prove that $d(\vertex{P}, \vertex{Q}) \le 14\delta + 2\epsilon$. By swapping $\vertex{B}$ and $\vertex{C}$, we see that $\vertex{Q}$ must also satisfy the claim. Pick the vertex $\vertex{Q'}$ in the same manner as $\vertex{P'}$ so that $d(\vertex{Q}, \vertex{Q'}) \le 2\delta$.
 
-If $\vertex{Q'}$ satisfies property \ref{item:close} then \begin{eqnarray*}
+If $\vertex{Q'}$ also satisfies property \ref{item:close} then \begin{eqnarray*}
         d(\vertex{P}, \vertex{Q})
 & \le & d(\vertex{P}, \vertex{P'}) + d(\vertex{P'}, f(\vertex{e})) + d(f(\vertex{e}), \vertex{Q'}) + d(\vertex{Q'}, \vertex{Q}) \\
-& \le & 3\delta + 1 + 5\delta + \epsilon + 5\delta + \epsilon + 3\delta + 1 \\
-&  =  & 16\delta + 2\epsilon + 2,
+& \le & 2\delta + 5\delta + \epsilon + 5\delta + \epsilon + 2\delta \\
+&  =  & 14\delta + 2\epsilon,
 \end{eqnarray*} as required. If not, $\vertex{Q'}$ satisfies property \ref{item:corr}; in this case swap $\vertex{P}$ and $\vertex{Q}$ so that the only case left to deal with is the case where $\vertex{P'}$ satisfies property \ref{item:corr}.
 
-To finish off, then, suppose that $\vertex{P'}$ satisfies property \ref{item:corr} so that $\vertex{P'}$ is within $6\delta$ of its corresponding point $\vertex{Q''}$ on $\path{\vertex{A}}{\vertex{C}}$. Notice that $d(\vertex{Q''}, \vertex{Q}) = d(\vertex{P'}, \vertex{P}) \le 3\delta$, so \begin{eqnarray*}
+To finish off, then, suppose that $\vertex{P'}$ satisfies property \ref{item:corr} so that $\vertex{P'}$ is within $6\delta$ of its corresponding point $\vertex{R}$ on $\path{\vertex{A}}{\vertex{C}}$. Notice that $d(\vertex{R}, \vertex{Q}) = d(\vertex{P'}, \vertex{P}) \le 2\delta$, so \begin{eqnarray*}
         d(\vertex{P}, \vertex{Q})
-& \le & d(\vertex{P}, \vertex{P'}) + d(\vertex{P'}, \vertex{Q''}) + d(\vertex{Q''}, \vertex{Q}) \\
-& \le & 3\delta + 1 + 6\delta + 3\delta + 1 \\
-&  =  & 12\delta + 2,
-\end{eqnarray*} which finishes the proof that the claim implies the theorem.
+& \le & d(\vertex{P}, \vertex{P'}) + d(\vertex{P'}, \vertex{R}) + d(\vertex{R}, \vertex{Q}) \\
+& \le & 2\delta + 6\delta + 2\delta \\
+&  =  & 10\delta,
+\end{eqnarray*} which completes the proof.
+\end{proof}
 
+We now prove the main result for this section. The second part of the above result is not required for this proof, but is stated as it may be of interest.
+
+\begin{theorem}
+\label{theorem:xg_h_qc_implies_h}
+Suppose $\Gamma$ is a $\delta$-vertex-hyperbolic $X$-graph with base point $\vertex{e}$, that $\Gamma'$ is an $X$-graph and that $f : \Gamma \to \Gamma'$ is an $X$-map such that $f^{-1}(f(\vertex{e}))$ is $\epsilon$-quasiconvex. Then $\Gamma'$ is $14\delta+2\epsilon$-vertex-hyperbolic and geodesic triangles with corners on vertices in which all points are further than $5\delta + \epsilon$ from $f(\vertex{e})$ are $10\delta$-vertex-thin.
+\end{theorem}
+
+\begin{proof}
+Suppose we are given a geodesic triangle in $\Gamma'$ with corners $\vertex{A}$, $\vertex{B}$ and $\vertex{C}$. Suppose $f(\vertex{e}) \cdot w = \vertex{A}$, $\vertex{a} \cdot u = \vertex{B}$ and $\vertex{A} \cdot v = \vertex{B} \cdot x = \vertex{C}$, where $w$ labels a geodesic starting at $f(\vertex{e})$, and $u$, $v$ and $x$ label the sides of the triangle. The situation in $\Gamma'$ is illustrated in Figure \ref{figure:coset_thin_tri_in_ccay}.
+
 \begin{figure}
 \begin{center}
 \input coset_thin_tri_in_ccay.pstex_t
@@ -2020,13 +2175,17 @@
 \end{center}
 \end{figure}
 
-It remains to prove the claim. We aim to translate the construction into $\Gamma$ in order to use hyperbolicity of $\Gamma$ to do do just this (see Figure \ref{figure:coset_thin_tri_in_cay} for an illustration of this construction). Let $\vertex{a} := \vertex{e} \cdot w$, $\vertex{b} := \vertex{a} \cdot u$, $\vertex{c} := \vertex{b} \cdot x$, $\vertex{a'} := \vertex{c} \cdot v^{-1}$ and $\vertex{e'} := \vertex{a'} \cdot w^{-1}$. Let $h$ be a $\Gamma$-geodesic word connecting $\vertex{e}$ to $\vertex{e'}$. We know that $\vertex{A} \cdot uxv^{-1} = \vertex{A}$, so $f(\vertex{a'}) = \vertex{A}$ and then $f(\vertex{e'}) = f(\vertex{e})$. Because $f$ is $\epsilon$-quasiconvex, each vertex $f(\vertex{e} \cdot h(j))$ must be within within $\epsilon$ of $f(\vertex{e})$.
+We aim to translate the construction into $\Gamma$ in order to use hyperbolicity of $\Gamma$ to show that the triangle is nearly $\delta$-thin $\epsilon$-relative to $f(\vertex{e})$ in order to use Lemma \ref{lemma:qc_tri}.
 
-Including $\vertex{e}$, these six points then form a geodesic hexagon in $\Gamma$ with sides labelled in turn $w$, $u$, $x$, $v^{-1}$, $w^{-1}$ and $h^{-1}$. Let $g$ be a $\Gamma$-geodesic word connecting $\vertex{a}$ to $\vertex{a'}$, and let $w'$ and $u'$ be $\Gamma$-geodesic words connecting $\vertex{e'}$ to $\vertex{a}$ and $\vertex{a'}$ to $\vertex{b}$ respectively.
+Let $\vertex{a} := \vertex{e} \cdot w$, $\vertex{b} := \vertex{a} \cdot u$, $\vertex{c} := \vertex{b} \cdot x$, $\vertex{a'} := \vertex{c} \cdot v^{-1}$ and $\vertex{e'} := \vertex{a'} \cdot w^{-1}$. Let $h$ be a $\Gamma$-geodesic word connecting $\vertex{e}$ to $\vertex{e'}$. See Figure \ref{figure:coset_thin_tri_in_cay} for an illustration of this construction.
 
-Since $f(\vertex{e}) \cdot w = f(\vertex{e} \cdot hw') = f(\vertex{e}) \cdot w'$ and $w$ is a $\Gamma'$-geodesic at $f(\vertex{e})$, we must have \begin{equation} \label{eqn:w'_long}
+We know that $\vertex{A} \cdot uxv^{-1} = \vertex{A}$, so $f(\vertex{a'}) = \vertex{A}$ and then $f(\vertex{e'}) = f(\vertex{e})$. Because $f$ is $\epsilon$-quasiconvex, each vertex $f(\vertex{e} \cdot h(j))$ must be within within $\epsilon$ of $f(\vertex{e})$.
+
+Including $\vertex{e}$, these six points then form a geodesic hexagon in $\Gamma$ with sides labelled in turn $w$, $u$, $x$, $v^{-1}$, $w^{-1}$ and $h^{-1}$. Let $g$ be label a geodesic connecting $\vertex{a}$ to $\vertex{a'}$, and let $w'$ and $u'$ label geodesics connecting $\vertex{e'}$ to $\vertex{a}$ and $\vertex{a'}$ to $\vertex{b}$ respectively.
+
+Since $f(\vertex{e}) \cdot w = f(\vertex{e} \cdot hw') = f(\vertex{e}) \cdot w'$ and $w$ labels a geodesic starting at $f(\vertex{e})$, we must have \begin{equation} \label{eqn:w'_long}
 |w'| \ge |w|.
-\end{equation} Similarly $\vertex{A} \cdot u' = \vertex{A} \cdot u$ and $u$ is a $\Gamma'$-geodesic at $\vertex{A}$, so \begin{equation} \label{eqn:u'_long}
+\end{equation} Similarly $\vertex{A} \cdot u' = \vertex{A} \cdot u$ and $u$ labels a geodesic starting at $\vertex{A}$, so \begin{equation} \label{eqn:u'_long}
 |u'| \ge |u|.
 \end{equation}
 
@@ -2048,6 +2207,11 @@
 (\vertex{B}, \vertex{C})_{\vertex{A}} \le (\vertex{b}, \vertex{c})_{\vertex{a'}}.
 \end{equation}
 
+Similarly $\frac{|u| + |x| - |v|}{2} \le \frac{|u'| + |x| - |v|}{2}$ so that
+\begin{equation} \label{eqn:no_near_side}
+(\vertex{A}, \vertex{C})_{\vertex{B}} \le (\vertex{a'}, \vertex{c})_{\vertex{b}}.
+\end{equation}
+
 Suppose now that $\vertex{P} = \vertex{A} \cdot u(i)$ is a vertex on $\path{\vertex{A}}{\vertex{B}}$ which corresponds to a vertex $\vertex{Q} = \vertex{A} \cdot v(i)$ on $\path{\vertex{A}}{\vertex{C}}$. Let $\vertex{p} := \vertex{a} \cdot u(i)$ and let $\vertex{q} := \vertex{a'} \cdot v(i)$ so that $\vertex{P} = f(\vertex{p})$ and $\vertex{Q} = f(\vertex{q})$.
 
 We can now observe some cases which will be treated in order of increasing distance from $\vertex{p}$ to $\vertex{a}$.
@@ -2060,23 +2224,31 @@
 \end{center}
 \end{figure}
 
-\textbf{Case 1}: Suppose that $i \le \min\{(\vertex{a'}, \vertex{b})_{\vertex{a}}, (\vertex{e}, \vertex{e'})_{\vertex{a}}\}$. Notice that (\ref{eqn:no_corr}) implies that $(\vertex{a'}, \vertex{e'})_{\vertex{a}} \ge (\vertex{a'}, \vertex{b})_{\vertex{a}}$ so that $i \le (\vertex{a'}, \vertex{e'})_{\vertex{a}}$ as well. Then this case applies if and only if $\vertex{p}$ $3$-corresponds to a vertex $\vertex{r}$ on $\path{\vertex{e}}{\vertex{a}}$ as illustrated in Figure \ref{figure:coset_thin_swap_sides}.
+\textbf{Case 1}: Suppose that $i \le \min\{(\vertex{a'}, \vertex{b})_{\vertex{a}}, (\vertex{e}, \vertex{e'})_{\vertex{a}}\}$. Notice that (\ref{eqn:no_corr}) implies that $(\vertex{a'}, \vertex{e'})_{\vertex{a}} \ge (\vertex{a'}, \vertex{b})_{\vertex{a}}$ so that $i \le (\vertex{a'}, \vertex{e'})_{\vertex{a}}$ as well. Then this case applies if and only if $\vertex{p}$ $3$-corresponds to a vertex $\vertex{r} = \vertex{a} \cdot w^{-1}(i)$ on $\path{\vertex{e}}{\vertex{a}}$ as illustrated in Figure \ref{figure:coset_thin_swap_sides}.
 
-Now $\vertex{r} = \vertex{e} \cdot w (|w|-i)$ and $f(\vertex{e}) \cdot w(|w|-i))= f(\vertex{e}) \cdot hw(|w|-i)$, so let $\vertex{s} := \vertex{e'} \cdot w(|w|-i)$; that is the point ``opposite'' $\vertex{r}$. Using Propostion \ref{proposition:contraction}, observe that $d(\vertex{P}, f(\vertex{s})) = d(\vertex{P}, f(\vertex{r})) \le d(\vertex{p}, \vertex{r}) \le 3\delta$. There are a number of sub-cases, depending on which side of the $\vertex{s}$ chain-corresponds to. Again, we will treat them with smallest $i$ first.
+Now let $\vertex{s} := \vertex{a'} \cdot w^{-1}(i)$; that is, the point ``opposite'' $\vertex{r}$. Using Propostion \ref{proposition:contraction}, observe that \begin{equation}
+\label{eqn:s_P_close}
+d(\vertex{P}, f(\vertex{s})) = d(\vertex{P}, f(\vertex{r})) \le d(\vertex{p}, \vertex{r}) \le 3\delta.
+\end{equation} This case has a number of sub-cases, depending on which side of the $\vertex{s}$ chain-corresponds to. Again, we will treat them with smallest $i$ first.
 
-\textbf{Case 1a}: Suppose that $i \le (\vertex{e'}, \vertex{a})_{\vertex{a'}}$ so that $\vertex{s}$ corresponds to a vertex on $\path{\vertex{a'}}{\vertex{a}}$. By (\ref{eqn:no_corr}) we know that $(\vertex{e'}, \vertex{a})_{\vertex{a'}} \le (\vertex{a}, \vertex{b})_{\vertex{a'}}$ so that vertex in turn corresponds to a vertex on $\path{\vertex{a'}}{\vertex{b}}$. Finally, by (\ref{eqn:no_far_side}) we have $i \le (\vertex{b}, \vertex{c})_{\vertex{a'}}$, so $\vertex{s}$ $3$-corresponds to a vertex on $\path{\vertex{a'}}{\vertex{c}}$. Since $d(\vertex{a'}, \vertex{s}) = i = d(\vertex{a'}, \vertex{q})$, this vertex must be $\vertex{q}$, and $d(f(\vertex{s}), \vertex{Q}) \le d(\vertex{s}, \vertex{q}) \le 3\delta$ so we have $d(\vertex{P}, \vertex{Q}) \le 6\delta$ as required for the property \ref{item:corr} of the claim.
+\textbf{Case 1a}: Suppose that $i \le (\vertex{e'}, \vertex{a})_{\vertex{a'}}$ so that $\vertex{s}$ corresponds to a vertex on $\path{\vertex{a'}}{\vertex{a}}$. By (\ref{eqn:no_corr}) we know that $(\vertex{e'}, \vertex{a})_{\vertex{a'}} \le (\vertex{a}, \vertex{b})_{\vertex{a'}}$ so that vertex in turn corresponds to a vertex on $\path{\vertex{a'}}{\vertex{b}}$. Finally, by (\ref{eqn:no_far_side}) we have $i \le (\vertex{b}, \vertex{c})_{\vertex{a'}}$, so $\vertex{s}$ $3$-corresponds to a vertex on $\path{\vertex{a'}}{\vertex{c}}$. Since $d(\vertex{a'}, \vertex{s}) = i = d(\vertex{a'}, \vertex{q})$, this vertex must be $\vertex{q}$, and $d(f(\vertex{s}), \vertex{Q}) \le d(\vertex{s}, \vertex{q}) \le 3\delta$ so (\ref{eqn:s_P_close}) implies that $d(\vertex{P}, \vertex{Q}) \le 6\delta$ as required for property \ref{item:corr} of Definition \ref{defn:nearly_thin}.
 
 For Cases 1b and 1c, we may therefore assume that $i > (\vertex{e'}, \vertex{a})_{\vertex{a'}}$ so that $\vertex{s}$ corresponds to a vertex on $\path{\vertex{e'}}{\vertex{a'}}$.
 
-\textbf{Case 1b}: Suppose that $\vertex{s}$ $2$-corresponds to a vertex $\vertex{t}$ on $\path{\vertex{e}}{\vertex{a}}$ as in Figure \ref{figure:coset_thin_self_corr}. Since $w$ is a $\Gamma'$-geodesic at $f(\vertex{e})$, we must have \begin{eqnarray*}
+\textbf{Case 1b}: Suppose that $\vertex{s}$ $2$-corresponds to a vertex $\vertex{t}$ on $\path{\vertex{e}}{\vertex{a}}$ as in Figure \ref{figure:coset_thin_self_corr}. Notice that \begin{eqnarray*}
         d(\vertex{a}, \vertex{t})
 &  =  & d(f(\vertex{a}), f(\vertex{t})) \\
 &  =  & d(f(\vertex{a'}), f(\vertex{t})) \\
 & \le & d(f(\vertex{a'}), f(\vertex{s})) + d(f(\vertex{s}), f(\vertex{t}))\\
 & \le & d(\vertex{a'}, \vertex{s}) + d(\vertex{s}, \vertex{t}) \\
-& \le & d(\vertex{a}, \vertex{r}) + 2\delta\\
-& \le & (\vertex{a'},\vertex{e'})_{\vertex{a}}+2\delta.
-\end{eqnarray*} Now $d(\vertex{a'},\vertex{s})=d(\vertex{a},\vertex{t})-(\vertex{a'},\vertex{e'})_{\vertex{a}}+(\vertex{e'},\vertex{a})_{\vertex{a'}}\le(\vertex{e'},\vertex{a})_{\vertex{a'}}=2\delta$. Now let $\vertex{p'} := \vertex{a} \cdot u(j)$ where $j = \max\{i-2\delta, 0\}$, and $j\le(\vertex{e'},\vertex{a})_{\vertex{a'}}$ just as in Case 1a. Thus we have shown that $\vertex{P}$ satisfies the property \ref{item:feh} of the claim, as does any vertex within $\delta + 1$ of $\vertex{p}$ (which is relevant to Case 4).
+& \le & i + 2\delta.
+\end{eqnarray*}
+and $i \le (\vertex{e'}, \vertex{a'})_{\vertex{a}}$, so
+\begin{eqnarray*}
+        d(\vertex{a'},\vertex{s})
+&  =  & d(\vertex{a},\vertex{t}) - (\vertex{a'},\vertex{e'})_{\vertex{a}}+(\vertex{e'},\vertex{a})_{\vertex{a'}} \\
+& \le & (\vertex{e'},\vertex{a})_{\vertex{a'}} + 2\delta.
+\end{eqnarray*} Let $\vertex{p'} := \vertex{a} \cdot u(j)$ where $j = \max\{i-2\delta, 0\}$. Then $j \le (\vertex{e'},\vertex{a})_{\vertex{a'}}$, so $f(\vertex{p'})$ is in Case 1a. Since $j-i \le 2\delta$, we have shown that $\vertex{P}$ satisfies property \ref{item:feh} of Definition \ref{defn:nearly_thin}.
 
 \begin{figure}
 \begin{center}
@@ -2086,28 +2258,39 @@
 \end{center}
 \end{figure}
 
-\textbf{Case 1c}: Finally, suppose that $\vertex{s}$ $2$-corresponds to a vertex $\vertex{t}$ on $\path{\vertex{e}}{\vertex{e'}}$. Since $f$ is quasiconvex, $d(f(\vertex{t}), f(\vertex{e})) \le \epsilon$, so $d(\vertex{P}, f(\vertex{e})) \le d(\vertex{p}, \vertex{r}) + d(\vertex{r}, \vertex{t}) + \epsilon \le 5 \delta + \epsilon$ and $\vertex{P}$ satisfies property \ref{item:close} of the claim.
+\textbf{Case 1c}: The final subcase has $\vertex{s}$ $2$-corresponding to a vertex $\vertex{t}$ on $\path{\vertex{e}}{\vertex{e'}}$. Since $f$ is quasiconvex, $d(f(\vertex{t}), f(\vertex{e})) \le \epsilon$, so $d(\vertex{P}, f(\vertex{e})) \le d(\vertex{p}, \vertex{r}) + d(\vertex{r}, \vertex{t}) + \epsilon \le 5 \delta + \epsilon$ and $\vertex{P}$ satisfies property \ref{item:close} of Definition \ref{defn:nearly_thin}.
 
-All possibilities where $\vertex{p}$ $3$-corresponds to a vertex on $\path{\vertex{e}}{\vertex{a}}$ have now been covered.
+All possibilities where $i \le (\vertex{e}, \vertex{e'})_{\vertex{a}}$ have now been covered so we assume that $i > (\vertex{e}, \vertex{e'})_{\vertex{a}}$ for the remaining cases.
 
-\textbf{Case 2}: Suppose that $i \le (\vertex{a'}, \vertex{b})_{\vertex{a}}$ but $i > (\vertex{e}, \vertex{e'})_{\vertex{a}}$. Again by (\ref{eqn:no_corr}) we know that $i \le (\vertex{a'}, \vertex{e'})_{\vertex{a}}$, so $\vertex{p}$ must $3$-correspond to a vertex $\vertex{r}$ on $\path{\vertex{e}}{\vertex{e'}}$. Since $f$ is $\epsilon$-quasiconvex, $d(f(\vertex{r}), f(\vertex{e})) \le \epsilon$ and so $d(\vertex{P}, f(\vertex{e})) \le d(\vertex{p}, \vertex{r}) + \epsilon \le 3\delta + \epsilon$ and $\vertex{P}$ satisfies property \ref{item:close} of the claim.
+\textbf{Case 2}: Suppose that $i \le (\vertex{a'}, \vertex{b})_{\vertex{a}}$. Using (\ref{eqn:no_corr}) we see \begin{eqnarray*}
+        (\vertex{a'}, \vertex{b})_{\vertex{a}}
+&  =  & |g| - (\vertex{a}, \vertex{b})_{\vertex{a'}} \\
+& \le & |g| - (\vertex{a}, \vertex{e'})_{\vertex{a'}} \\
+&  =  & (\vertex{a'}, \vertex{e'})_{\vertex{a}}.
+\end{eqnarray*} But then $i \le (\vertex{a'}, \vertex{e'})_{\vertex{a}}$, so $\vertex{p}$ must $3$-correspond to a vertex $\vertex{r}$ on $\path{\vertex{e}}{\vertex{e'}}$. Notice that $d(f(\vertex{r}), f(\vertex{e})) \le \epsilon$ and so $d(\vertex{P}, f(\vertex{e})) \le d(\vertex{p}, \vertex{r}) + \epsilon \le 3\delta + \epsilon$ and $\vertex{P}$ satisfies property \ref{item:close} of the Lemma \ref{lemma:qc_tri}.
 
-We have now dealt with all possibilities where $i\le(\vertex{a'},\vertex{b})_{\vertex{a}}$ and may thus assume that $i > (\vertex{a'}, \vertex{b})_{\vertex{a}}$. The remainder all see $\vertex{p}$ chain-correspond to a vertex $\vertex{r}$ on $\path{\vertex{a'}}{\vertex{c}}$ or on $\path{\vertex{c}}{\vertex{b}}$ which maps through $f$ to a vertex on one of the original sides of the triangle. If we were proving the triangle were slim, we could stop now; here we still need to show that $\vertex{r}$ is close to $\vertex{q}$.
+We have now dealt with all possibilities where $i\le(\vertex{a'},\vertex{b})_{\vertex{a}}$ and may thus assume that $i > (\vertex{a'}, \vertex{b})_{\vertex{a}}$.
 
-\textbf{Case 3}: Suppose that $d(\vertex{p}, \vertex{b}) = |u| - i \ge (\vertex{a'}, \vertex{c})_{\vertex{b}}$ so that $\vertex{p}$ $2$-corresponds to a vertex $\vertex{r} = \vertex{a'} \cdot v(j)$ on $\path{\vertex{a'}}{\vertex{c}}$, as illustrated in Figure \ref{figure:coset_thin_near_corr}. We have \begin{eqnarray*}
+\textbf{Case 3}: This is the final case. Equation (\ref{eqn:no_near_side}) imples that \begin{eqnarray*}
+        d(\vertex{p}, \vertex{b})
+&  =  & |u| - i \\
+& \ge & |u| - (\vertex{B}, \vertex{C})_{\vertex{A}} \\
+&  =  & (\vertex{A}, \vertex{C})_{\vertex{B}} \\
+& \ge & (\vertex{a'}, \vertex{c})_{\vertex{b}}
+\end{eqnarray*} so that $\vertex{p}$ $2$-corresponds to a vertex $\vertex{r} = \vertex{a'} \cdot v(j)$ on $\path{\vertex{a'}}{\vertex{c}}$, as illustrated in Figure \ref{figure:coset_thin_near_corr}. Similar to Case 1b, we have \begin{eqnarray*}
         j
 &  =  & d(\vertex{a}, \vertex{r}) \\
 &  =  & d(\vertex{A}, f(\vertex{r})) \\
 & \le & d(\vertex{A}, \vertex{P}) + d(\vertex{P}, f(\vertex{r})) \\
 & \le & i + d(\vertex{p}, \vertex{r}) \\
 & \le & i + 2\delta,
-\end{eqnarray*} and reversing the roles of $i$ and $j$ we find that $i \le j + 2\delta$ and so $|j - i| \le 2\delta$. Now \begin{eqnarray*}
+\end{eqnarray*} and by reversing the roles of $i$ and $j$ we find that $i \le j + 2\delta$ and so $|j - i| \le 2\delta$. Now \begin{eqnarray*}
         d(\vertex{P}, \vertex{Q})
 & \le & d(\vertex{p}, \vertex{q}) \\
 & \le & d(\vertex{p}, \vertex{r}) + d(\vertex{r}, \vertex{q}) \\
 &  =  & d(\vertex{p}, \vertex{r}) + |i - j| \\
 & \le & 4\delta,
-\end{eqnarray*} and we have shown that $\vertex{P}$ satisfies property \ref{item:corr} of the claim.
+\end{eqnarray*} and we have shown that $\vertex{P}$ satisfies property \ref{item:corr} of Definition \ref{defn:nearly_thin}.
 
 \begin{figure}
 \begin{center}
@@ -2117,40 +2300,26 @@
 \end{center}
 \end{figure}
 
-\textbf{Case 4}: The remaining case has $i > |u| - (\vertex{a'}, \vertex{c})_{\vertex{b}}$ so that $\vertex{p}$ $2$-corresponds to some vertex $r$ on $\path{\vertex{b}}{\vertex{c}}$. Observe that \begin{eqnarray*}
-        |v|
-&  =  & d(\vertex{C}, \vertex{A}) \\
-& \le & d(\vertex{c}, \vertex{a}) \\
-& \le & d(\vertex{c}, \vertex{r}) + d(\vertex{r}, \vertex{p}) + d(\vertex{p}, \vertex{a}) \\
-& \le & |x| - d(\vertex{b}, \vertex{r}) + d(\vertex{r}, \vertex{p}) + d(\vertex{p}, \vertex{a}) \\
-& \le & |x| - (|u| - i) + 2\delta + i \\
-&  =  & |x| - |u| + 2i + 2\delta,
-\end{eqnarray*} but then by re-arranging, we see \begin{eqnarray*}
-        i
-& \le & (\vertex{B}, \vertex{C})_{\vertex{A}} \\
-&  =  & \frac{|u| + |v| - |x|}{2} \\
-& \le & i + \delta
-\end{eqnarray*} Now let $\vertex{p'} = \vertex{a} \cdot u(j)$ where $j = \max\{i - \delta - 1, 0\}$. Then $d(\vertex{P},f(\vertex{p'}))=d(\vertex{p'},\vertex{p})\le\delta+1$ and either $j=0$ so that $f(\vertex{p'})$ is in Case 1a or $j > 0$ and the above inequality is not satisfied if one sets $i = j$, so in either case $f(\vertex{p'})$ can be assumed to be in a case other than this one. Combining this with Case 1b we see that $\vertex{P}$ is within $3\delta+1$ of a vertex $\vertex{P'}$ which satisfies one of the first two properties in the claim.
-
-Since all possible vertices to which $\vertex{p}$ can chain-correspond to have been shown to imply the claim, the claim and therefore the theorem is now proved.
+Since all vertices $\vertex{P}$ have been shown to satisfy a property in Definition \ref{defn:nearly_thin}, the triangle is nearly $\delta$-thin $\epsilon$-relative to $f(\vertex{e})$. Lemma \ref{lemma:qc_tri} completes the proof.
 \end{proof}
 
-This is a first hint that there is some ball about the base point, outside of which the contraction behaves much like the original graph. It seems likely that the proof above should adapt quite well to general hyperbolic graphs and probably hyperbolic spaces, though restricting to $X$-graphs simplifies the situation as given a connected structure in the target, one need only read off the path labels to find a connected structure in the domain which maps onto it.
+It seems likely that the proof above should adapt to some classes of general (unlabelled) hyperbolic graphs and spaces, though restricting to $X$-graphs simplifies the situation as given a connected structure in the target, one need only read off the path labels to find a connected structure in the domain which maps onto it.
 
+The result is for example not true when mapping between general graphs: let $\Gamma$ be the Cayley graph of $\mathbb{Z}$ under a cyclic generator, and let $f$ identify $2^k+1$ to $2^{k+1}-1$ for $k \ge 2$. Then $\Gamma$ is $0$-vertex-hyperbolic and $f^{-1}(f(0))$ contains only one vertex (so is $0$-quasiconvex) but the resulting graph is not hyperbolic at all: for $k \ge 3$, $\vertex{x} = \vertex{y} = f(2^k+1)$ and $\vertex{z} = f(2^k+2^{k-1})$ are the corners of a geodesic triangle which is not $2^{k-1}-3$-thin.
+
 \begin{corollary}
-If $G = <\!X\!>$ is a $\delta$-hyperbolic group and $H$ is a $\epsilon$-quasiconvex subgroup then the coset Cayley graph of $H$ is $16\delta + 2\epsilon + 2$-vertex-hyperbolic, and geodesic triangles in the coset Cayley graph with corners on vertices in which all vertices on all sides are further than $5\delta + \epsilon$ from the vertex corresponding to $H$ are $12\delta+2$-vertex-thin.
+If $G = <\!X\!>$ is a $\delta$-hyperbolic group and $H$ is a $\epsilon$-quasiconvex subgroup then the coset Cayley graph of $H$ is $14\delta + 2\epsilon$-vertex-hyperbolic, and geodesic triangles in the coset Cayley graph with corners on vertices in which all vertices on all sides are further than $5\delta + \epsilon$ from the vertex corresponding to $H$ are $10\delta$-vertex-thin.
 \end{corollary}
 
 \begin{proof}
-If the Cayley and coset Cayley graphs are $\Gamma$ and $\Gamma'$ respectively, the map $f : \Gamma \to \Gamma' : 1 \cdot w \mapsto Hw$ is an $\epsilon$-quasiconvex $X$-map, so Theorem \ref{theorem:xg_h_qc_implies_h} finishes the proof.
+If the Cayley and coset Cayley graphs are $\Gamma$ and $\Gamma'$ respectively, the map $f : \Gamma \to \Gamma' : 1 \cdot w \mapsto Hw$ has $f^{-1}(f(\vertex{e})) = H$ when $\vertex{e}$ represents the identity element of $G$, so Theorem \ref{theorem:xg_h_qc_implies_h} finishes the proof.
 \end{proof}
 
-\section{A Linear Bound on the GIB($k$) Constant for Torsion Free Subgroups}
+Notice that the second part of the result above is a hint that there is some ball about the base point, outside of which the contraction behaves much like the original graph.
 
-For torsion free subgroups, Foord demonstrates the GIB($k$) property for any $k$ for a specific class of subgroups (those subgroups $H$ where $|H : H \cup C_G(h)|$ is finite for all elements $h$ in $H$), however he gives no bound on the value of the constant associated to it. It is the aim of this section to demonstrate that for torsion-free subgroups, said bound is in $O(k + \epsilon)$. The argument is similar to that of Foord relating the finiteness of the index $|H : H \cup C_G(h)|$ coupled with some observations made elsewhere in this thesis to bound said index.
+\section{Ball morphisms and loops}
 
-The following result is a generalisation of Lemma 4.1.1.3 %
-in \cite{foord2000thesis}.
+In this section, we provide some means to recognise when two balls are isomorphic, which we use later to prove some results about IB and GIB. The following result is a slightly more powerful generalisation of Lemma 4.1.1.3 from \cite{foord2000thesis}.
 
 \begin{proposition}
 \label{prop:loop_in_ball}
@@ -2160,7 +2329,7 @@
 
 If there is an $X$-ball morphism from $B_k(\vertex{x_1})$ to $B_k(\vertex{x_2})$ then $w$ labels a loop at $\vertex{x_2}$.
 
-Suppose additionally that $\Gamma$ is an $X$-graph with IB($2k+1$) and that the centre of $\canonicalball{2k+1}{\Gamma}$ is $\vertex{p}$. If for $i \in \{1, 2\}$ there is an $X$-ball morphism from $\canonicalball{2k+1}{\Gamma}$ to $B_{2k+1}^{\Gamma_i}(\vertex{x_i})$ then $w$ can be taken to be a $\Gamma$-geodesic at $\vertex{p}$.
+Suppose additionally that $\Gamma$ is an $X$-graph with IB($2k+1$) and that the centre of $\canonicalball{2k+1}{\Gamma}$ is $\vertex{p}$. If for $i \in \{1, 2\}$ there is an $X$-ball morphism from $\canonicalball{2k+1}{\Gamma}$ to $B_{2k+1}^{\Gamma_i}(\vertex{x_i})$ then $w$ can be taken to label a geodesic in $\Gamma$ which starts $\vertex{p}$.
 \end{proposition}
 
 \begin{proof}
@@ -2168,20 +2337,20 @@
 
 Proposition \ref{proposition:xmap_defined_by_point} implies that if an $X$-map $f:B_k(\vertex{x_1})\to B_k(\vertex{x_2})$ exists sending $\vertex{x_1}$ to $\vertex{x_2}$, it must map $\vertex{x_1} \cdot w$ to $\vertex{x_2} \cdot w$ for all $B_k(\vertex{x_1})$-words $w$, and if this describes a well-defined function then that function is an $X$-map. Let us aim for a contradiction and assume, then, that this map is not well defined, so there exist $X$-words $u$ and $v$ such that $u$ and $v$ are both $B_k(\vertex{x_1})$-words at $\vertex{x_1}$ and $B_k(\vertex{x_2})$-words at $\vertex{x_2}$, and that $\vertex{x_1} \cdot u = \vertex{x_1} \cdot v$ but $\vertex{x_2} \cdot u \ne \vertex{x_2} \cdot v$.
 
-For each $0 \le j \le |u|$, let $z_j$ be a $\Gamma_1$-geodesic word which connects $\vertex{x_1}$ to $\vertex{x_1} \cdot \nolinebreak u(j)$. Notice that $|z_j| \le k$ for all $j$. Suppose that for some $0 \le l < |u|$ we have $\vertex{x_2} \cdot z_l = \vertex{x_2} \cdot u(l)$, but $\vertex{x_2} \cdot z_{l+1} \ne \vertex{x_2} \cdot u(l+1)$. Let $w := z_lu[l+1]z_{l+1}^{-1}$. Then $|w| \le |z_l| + 1 + |z_{l+1}| \le 2k+1$, and $w$ labels a loop at $\vertex{x_1}$ but not $\vertex{x_2}$, a contradiction. If there is no such $l$, we may replace $u$ with $z_{|u|}$ which is a $\Gamma_1$-geodesic at $\vertex{x_1}$, and in particular satisfies $|u| \le k$.
+For each $0 \le j \le |u|$, let $z_j$ be the label of a geodesic which connects $\vertex{x_1}$ to $\vertex{x_1} \cdot \nolinebreak u(j)$. Notice that $|z_j| \le k$ for all $j$. Suppose that for some $0 \le l < |u|$ we have $\vertex{x_2} \cdot z_l = \vertex{x_2} \cdot u(l)$, but $\vertex{x_2} \cdot z_{l+1} \ne \vertex{x_2} \cdot u(l+1)$. Let $w := z_lu[l+1]z_{l+1}^{-1}$. Then $|w| \le |z_l| + 1 + |z_{l+1}| \le 2k+1$, and $w$ labels a loop at $\vertex{x_1}$ but not $\vertex{x_2}$, a contradiction. If there is no such $l$, we may replace $u$ with $z_{|u|}$, which labels a geodesic which starts at $\vertex{x_1}$, and in particular we then have $|u| \le k$.
 
-These arguments can also be applied to $v$, so we can assume $|v| \le k$. Now if $\vertex{x_1} \cdot u = \vertex{x_1} \cdot v$ but $\vertex{x_2} \cdot u \ne \vertex{x_2} \cdot v$ then let $w := uv^{-1}$. Since $|w| \le |u| + |v| \le 2k$ and $w$ labels a loop at $\vertex{x_1}$ but not $\vertex{x_2}$, we again have a contradiction.
+These arguments can also be applied to $v$, so we can also assume that $|v| \le k$. Now if $\vertex{x_1} \cdot u = \vertex{x_1} \cdot v$ but $\vertex{x_2} \cdot u \ne \vertex{x_2} \cdot v$ then let $w := uv^{-1}$. Since $|w| \le |u| + |v| \le 2k$ and $w$ labels a loop at $\vertex{x_1}$ but not $\vertex{x_2}$, we again have a contradiction.
 
 Thus $\vertex{x_1} \cdot u = \vertex{x_1} \cdot v$ implies that $\vertex{x_2} \cdot u = \vertex{x_2} \cdot v$ and there is an $X$-map from $B_k(\vertex{x_1})$ to $B_k(\vertex{x_2})$ which sends $\vertex{x_1}$ to $\vertex{x_2}$, ie.\ a ball morphism. Swapping $\Gamma_1$ and $\Gamma_2$ shows a ball morphism exists in the other direction. Since ball morphisms are surjective, this implies these balls contain the same number of vertices and so the morphism must also be injective, ie. an isomorphism.
 
-To derive the second statement, let $f$ be the $X$-ball morphism. Note that if $w$ labels a loop at $\vertex{x_1}$ then \begin{eqnarray*}
+To prove the second statement, let $f$ be the $X$-ball morphism. Note that if $w$ labels a loop at $\vertex{x_1}$ then \begin{eqnarray*}
       \vertex{x_2} \cdot w
 & = & f(\vertex{x_1}) \cdot w \\
 & = & f(\vertex{x_1} \cdot w) \\
 & = & f(\vertex{x_1}) = \vertex{x_2},
 \end{eqnarray*} so $w$ must also label a loop at $\vertex{x_2}$. Thus any loop present at the centre of only one ball must be a loop at $\vertex{x_2}$ and not at $\vertex{x_1}$.
 
-For the final statement, let $f_i$ be the $X$-ball morphisms. Notice that if $w'$ is a $\canonicalball{2k+1}{\Gamma}$-geodesic connecting $\vertex{p}$ to $\vertex{x} \cdot w$, then for each $i$ we have \begin{eqnarray*}
+For the final statement, let $f_i$ ($i = 1, 2$) be the given $X$-ball morphisms. Notice that if $w'$ is a $\canonicalball{2k+1}{\Gamma}$-geodesic connecting $\vertex{p}$ to $\vertex{x} \cdot w$, then for each $i$ we have \begin{eqnarray*}
       \vertex{x_i} \cdot w'
 & = & f_i(\vertex{p}) \cdot w' \\
 & = & f_i(\vertex{p} \cdot w') \\
@@ -2191,15 +2360,17 @@
 \end{eqnarray*} so $w'$ labels a loop at $\vertex{x_i}$ if and only if $w$ does. We may therefore replace $w$ with $w'$ and the result is proved.
 \end{proof}
 
-The simple identifying property given above allows us to much more easily determine whether balls are isomorphic or not. We now give a simple characterisation of loops in certain $X$-graphs.
+The simple identifying property given above allows us to much more easily determine whether or not two balls are isomorphic. We now give a characterisation of loops in certain $X$-graphs.
 
 \begin{lemma}
 \label{lemma:conj_quadrilateral}
-Suppose that $\Gamma$ and $\Gamma'$ are $X$-graphs, that $\Gamma$ is $\delta$-vertex-hyperbolic and has base point $\vertex{a}$ and that $f : \Gamma \to \Gamma'$ is an $\epsilon$-quasiconvex $X$-map. Suppose further that $w$ is a $\Gamma'$-geodesic word at $f(\vertex{a})$ and that $u$ is a $\Gamma$-geodesic word at $\vertex{a} \cdot w$ with $f(\vertex{a} \cdot w) = f(\vertex{a} \cdot wu)$. Then there exists a $\Gamma$-geodesic word $v$ at $\vertex{a}$ such that $\vertex{a} \cdot v = \vertex{a} \cdot wuw^{-1}$ and either
+Suppose that $\Gamma$ and $\Gamma'$ are $X$-graphs, that $\Gamma$ is $\delta$-vertex-hyperbolic and has base point $\vertex{a}$ and that $f : \Gamma \to \Gamma'$ is an $X$-map where $f^{-1}(f(\vertex{a}))$ is $\epsilon$-quasiconvex.
 
+Suppose further that $w$ labels geodesic in $\Gamma'$ which starts at $f(\vertex{a})$, that $u$ labels a geodesic in $\Gamma$ which starts at $\vertex{a} \cdot w$ and that $f(\vertex{a} \cdot w) = f(\vertex{a} \cdot wu)$. Then for any $X$-word which labels a geodesic in $\Gamma$ which starts at $\vertex{a}$ with $\vertex{a} \cdot v = \vertex{a} \cdot wuw^{-1}$, we have either
+
 \begin{enumerate}
-\item $|v| \le |u| - 2|w| + 6\delta + 4\epsilon + 2$ and $|v| \le |u| + 3\delta + 2\epsilon + 2$, and $2|w| \le |u| + 3\delta + 2\epsilon + 1$, or
-\item $|v| \le 3\delta + 2\epsilon + 1$ and $\frac{|u|}{2} \ge (w^{-1}, u)_{\vertex{a} \cdot w} \ge \frac{|u|}{2} - \delta$.
+\item $|v| \le |u| - 2|w| + 6\delta + 4\epsilon + 2$, $|v| \le |u| + 3\delta + 2\epsilon + 2$, and $2|w| \le |u| + 3\delta + 2\epsilon + 1$, or
+\item $|v| \le 3\delta + 2\epsilon + 1$ and $\frac{|u|}{2} \ge (\vertex{a}, \vertex{a} \cdot wu)_{\vertex{a} \cdot w} \ge \frac{|u|}{2} - \delta$.
 \end{enumerate}
 
 In the second case, if $|u| > 2\delta$, let $i := \floor{\frac{|u|}{2}} - \delta$ and there is a word $u'$ with $|u'| \le 5\delta + 1$ such that $\vertex{a} \cdot wu = \vertex{a} \cdot w(|w|-i)u'w(|w|-i:|w|)$.
@@ -2223,19 +2394,19 @@
 \end{figure}
 
 \begin{proof}
-Let $v$ be any $\Gamma$-geodesic connecting $\vertex{a}$ to $\vertex{a} \cdot wuw^{-1}$. Then $f(\vertex{a} \cdot v) = f(\vertex{a})$, so $f(\vertex{a} \cdot v(i))$ is within $\epsilon$ of $f(\vertex{e})$ for all integers $i$. Form a geodesic quadrilateral in $\Gamma$ with corners $\vertex{a}$, $\vertex{b} := \vertex{a} \cdot v$, $\vertex{c} := \vertex{b} \cdot w$ and $\vertex{d} := \vertex{c} \cdot u^{-1} = \vertex{a} \cdot w$, picking $\path{\vertex{b}}{\vertex{c}}$ and $\path{\vertex{a}}{\vertex{d}}$ such that they are both labelled $w$. Split the quadrilateral into two triangles using some $\Gamma$-geodesic $\path{\vertex{a}}{\vertex{c}}$.
+Let $v$ be such an $X$-word. Then $f(\vertex{a} \cdot v) = f(\vertex{a})$, so $f(\vertex{a} \cdot v(i))$ is within $\epsilon$ of $f(\vertex{e})$ for all integers $i$. Form a geodesic quadrilateral in $\Gamma$ with corners $\vertex{a}$, $\vertex{b} := \vertex{a} \cdot v$, $\vertex{c} := \vertex{b} \cdot w$ and $\vertex{d} := \vertex{c} \cdot u^{-1} = \vertex{a} \cdot w$, picking $\path{\vertex{b}}{\vertex{c}}$ and $\path{\vertex{a}}{\vertex{d}}$ so that they are both labelled $w$. Split the quadrilateral into two triangles using some $\Gamma$-geodesic $\path{\vertex{a}}{\vertex{c}}$.
 
 Let $m$ be the number of vertices on $\path{\vertex{b}}{\vertex{c}}$, excluding $\vertex{b}$ itself, which correspond to vertices on $\path{\vertex{a}}{\vertex{b}}$, in other words $\floor{(\vertex{a}, \vertex{c})_{\vertex{b}}}$. Let $\vertex{x}$ be the vertex on $\path{\vertex{b}}{\vertex{c}}$ with $d(\vertex{x}, \vertex{b}) = m$, so that $\vertex{x}$ corresponds to a vertex $\vertex{y}$ on $\path{\vertex{a}}{\vertex{b}}$. Since $\path{\vertex{a}}{\vertex{b}}$ is a $\Gamma$-geodesic at $\vertex{a}$ and $f$ is $\epsilon$-quasiconvex, there exists some $\vertex{g} \in \Gamma$ such that $f(\vertex{g}) = f(\vertex{a})$ and $d(\vertex{g}, \vertex{y}) \le \epsilon$. Then $d(f(\vertex{x}), f(\vertex{b})) = d(f(\vertex{x}), f(\vertex{g})) \le d(\vertex{x}, \vertex{g}) \le \delta + \epsilon$. Since $w$ is a $\Gamma'$-geodesic at $f(\vertex{a}) = f(\vertex{b})$, we therefore have $m = d(\vertex{x}, \vertex{b}) = d(f(\vertex{x}), f(\vertex{b})) \le \delta + \epsilon$.
 
 Let $n$ be the number of vertices on $\path{\vertex{a}}{\vertex{d}}$, excluding $\vertex{a}$ itself, which $2$-correspond to a vertex on $\path{\vertex{a}}{\vertex{b}}$. Then a similar construction to that in the previous paragraph shows that $n \le 2\delta + \epsilon$.
 
-We will now show that $(\vertex{d}, \vertex{c})_{\vertex{a}} < (\vertex{c}, \vertex{b})_{\vertex{a}}$ implies the first case in the hypothesis. If this inequality is satisfied, no vertices on $\path{\vertex{b}}{\vertex{c}}$ can $2$-correspond to vertices on $\path{\vertex{a}}{\vertex{d}}$ as the situation is as illustrated in Figure \ref{figure:conj_quad_close}. Let $l$ be the number of vertices on $\path{\vertex{a}}{\vertex{b}}$ which $2$-correspond only to vertices on $\path{\vertex{d}}{\vertex{c}}$, so that by counting vertices we find that \begin{equation} \label{eqn:v_length}
+We will now show that $(\vertex{d}, \vertex{c})_{\vertex{a}} < (\vertex{c}, \vertex{b})_{\vertex{a}}$ implies the first case in the hypothesis. If this inequality is satisfied, no vertices on $\path{\vertex{b}}{\vertex{c}}$ can $2$-correspond to vertices on $\path{\vertex{a}}{\vertex{d}}$ as the situation is as illustrated in Figure \ref{figure:conj_quad_close}. Let $l$ be the number of vertices on $\path{\vertex{a}}{\vertex{b}}$ which $2$-correspond only to vertices on $\path{\vertex{d}}{\vertex{c}}$. By counting vertices we find that \begin{equation} \label{eqn:v_length}
 |v| + 1 = l + (m+1) + (n+1).
 \end{equation}
 
-Note that the remaining $|w|-m$ vertices on $\path{\vertex{b}}{\vertex{c}}$ and the remaining $|w|-n$ vertices on $\path{\vertex{a}}{\vertex{d}}$ which don't chain-correspond to vertices on $\path{\vertex{a}}{\vertex{b}}$ must instead correspond to vertices on $\path{\vertex{d}}{\vertex{c}}$ and vice versa, so again counting vertices we see that $|u|$ is within $1$ of $l + (|w|-m) + (|w|-n)$. Notice that it is possible for some of these correspondances to overlap,which is why this statement is not an equality. Combining this with (\ref{eqn:v_length}), we find that $|v| - m - n - 1 =^1 |u| - 2|w| + m + n$, so $|v| =^1 |u| + 2(m + n - |w|) + 1$.
+Note that there are $|w|-m$ or $|w|-m+1$ vertices on $\path{\vertex{b}}{\vertex{c}}$ which $2$-correspond to vertices on $\path{\vertex{c}}{\vertex{d}}$. Similarly, there are $|w|-n$ or $|w|-n+1$ vertices on $\path{\vertex{a}}{\vertex{d}}$ which correspond to vertices on $\path{\vertex{c}}{\vertex{d}}$. Counting vertices, we see that $|u|$ is within $1$ of $l + (|w|-m) + (|w|-n)$. Combining this with (\ref{eqn:v_length}), we find that $|v| - m - n - 1 =^1 |u| - 2|w| + m + n$, so $|v| =^1 |u| + 2(m + n - |w|) + 1$.
 
-We know that $2|w| \ge m + n$ and $m + n \le 3\delta + 2\epsilon$, so we can derive $|v| \le |u| - 2|w| + 6\delta + 4\epsilon + 2$ and $|v| \le |u| + m + n + 2 \le |u| + 3\delta + 2\epsilon + 2$. Similarly, $|v| \ge n + m + 1$ so we obtain \begin{eqnarray*}
+We know that $m + n \le 3\delta + 2\epsilon$, so we can derive $|v| \le |u| - 2|w| + 6\delta + 4\epsilon + 2$. Also, $2|w| \ge m + n$ so $|v| \le |u| + m + n + 2 \le |u| + 3\delta + 2\epsilon + 2$. Finally, $|v| \ge n + m + 1$ so we obtain \begin{eqnarray*}
         2|w|
 & \le & |u| - |v| + 2n + 2m + 2 + 2 \\
 & \le & |u| + 3\delta + 2\epsilon + 1.
@@ -2262,47 +2433,52 @@
 &  =  & d(\vertex{a}, \vertex{q}) + d(\vertex{c}, \vertex{b}) - d(\vertex{b}, \vertex{p}) \\
 &  =  & j + |w| - i \\
 & \le & |w| + 2\delta.
-\end{eqnarray*} Also, since $w$ is a $\Gamma'$-geodesic at $f(\vertex{b})$ we have \begin{eqnarray*}
+\end{eqnarray*} Also, since $w$ labels a geodesic which starts at $f(\vertex{b})$ we have \begin{eqnarray*}
         |w|
 &  =  & d(f(\vertex{b}), f(\vertex{c})) \\
 &  =  & d(f(\vertex{a}), f(\vertex{c})) \\
 & \le & d(\vertex{a}, \vertex{c}),
 \end{eqnarray*} so \begin{eqnarray*}
-        \frac{|u|}{2}
-&  =  & \frac{|u| + |w| - d(\vertex{a}, \vertex{c})}{2}
+&     & \frac{|u|}{2} \\
+& \ge & \frac{|u| + |w| - d(\vertex{a}, \vertex{c})}{2}
    =    (\vertex{c}, \vertex{a})_{\vertex{d}} \\
-& \ge & \frac{|u|}{2} - \delta
-\end{eqnarray*} and similarly $(\vertex{c},\vertex{a})_{\vertex{d}} \le \frac{|u|}{2}$. Since $(w^{-1}, u)_{\vertex{a} \cdot w} = (\vertex{c},\vertex{a})_{\vertex{d}}$, we have now shown that the second case applies.
+& \ge & \frac{|u|}{2} - \delta.
+\end{eqnarray*} Since $(\vertex{a}, \vertex{a} \cdot wu)_{\vertex{a} \cdot w} = (\vertex{c},\vertex{a})_{\vertex{d}}$, we have now shown that the second case applies.
 
 For the last part, let $\vertex{s}$ on $\path{\vertex{b}}{\vertex{c}}$ and $\vertex{t}$ on $\path{\vertex{a}}{\vertex{d}}$ be the vertices at distance $i = \floor{\frac{|u|}{2}} - \delta$ from $\vertex{c}$ and $\vertex{d}$ respectively, so that they chain-correspond to points $\vertex{s'}$ and $\vertex{t'}$ on $\path{\vertex{d}}{\vertex{c}}$ at most $2\delta + 1$ apart. We can see now that $d(\vertex{s}, \vertex{t}) \le d(\vertex{s}, \vertex{s'}) + d(\vertex{s'}, \vertex{t'}) + d(\vertex{t'}, \vertex{t}) \le 5\delta + 1$ and letting $u'$ be a word labelling a path between $\vertex{s}$ and $\vertex{t}$, we have $\vertex{a} \cdot wu = \vertex{a} \cdot w(|w|-i)u'w(|w|-i:|w|)$ as required.
 \end{proof}
 
-In particular, we can show that long loops which are far from the base point in the target graph of a quasiconvex $X$-map can be ``pulled'' to shorter loops which are closer to the base point, which in particular means that we can show that if for we have IB($k$) in $\Gamma'$ for large enough $k$ then we have IB($k$) in $\Gamma'$ for any $k$. The following proposition is similar to part of the proof of 4.3.1.1 % TODO what sort of result
-in \cite{foord2000thesis}.
+In particular, we can show that long loops which are far from the base point in the target graph of a quasiconvex $X$-map can be ``pulled'' to shorter loops which are closer to the base point.
 
+\section{IB($\frac{5}{2}\delta$) implies IB($\infty$)}
+
+For torsion free subgroups, Foord demonstrates the GIB($k$) property for any $k$ for a specific class of subgroups (those subgroups $H$ where $|H : H \cup C_G(h)|$ is finite for all elements $h$ in $H$) by finding a bound on the distance of large loops from the base point of the coset Cayley graph.
+
+The following proposition is similar to the first part of the proof of 4.3.1.1 % TODO what sort of result
+from \cite{foord2000thesis}.
+
 \begin{proposition}
 \label{prop:small_ib_implies_ib}
-Suppose that $\Gamma$ and $\Gamma'$ are $X$-graphs, that $\Gamma$ has IB($2k+3\delta+2$) with constant $M$ for some $k \ge \frac{5}{2}\delta$, is $\delta$-vertex-hyperbolic and has base point $\vertex{a}$ and that $f : \Gamma \to \Gamma'$ is an $\epsilon$-quasiconvex $X$-map.
+Suppose that $\Gamma$ and $\Gamma'$ are $X$-graphs, that $\Gamma$ has IB($2k+5\delta+2$) with constant $M$ for some $k \ge \frac{5}{2}\delta$, is $\delta$-vertex-hyperbolic, has base point $\vertex{a}$, that $f : \Gamma \to \Gamma'$ is an $X$-map and that $f^{-1}(f(\vertex{a}))$ is $\epsilon$-quasiconvex.
 
-If $\Gamma'$ has IB($\frac{5}{2}\delta$) with constant $K$ then it has IB($k$) with constant $\max\{M + k - \delta, K + k - \delta, \epsilon + \frac{3\delta + 2k + 1}{2}\}$.
+If $\Gamma'$ has IB($\frac{5}{2}\delta$) with constant $K$ then it has IB($k$) with constant $\max\{M + k - \delta, K + k - \delta, \epsilon + \frac{3\delta + 2}{2} + 1\}$.
 
 If additionally $\{\Gamma, \Gamma'\}$ has IB($\frac{5}{2}\delta$), then it has IB($k$).
 \end{proposition}
 
 \begin{proof}
-Let $K' = \max\{M + k - \delta, K + k - \delta, \epsilon + \frac{3\delta + 2k + 1}{2}\}$ and suppose that $\Gamma'$ has IB($\frac{5}{2}\delta$) with constant $K$, has base point $\vertex{a}$, and that $f(\vertex{a}) = \vertex{z}$. Now suppose that $\vertex{x}, \vertex{y} \in \Gamma'$ have $d(\vertex{z}, \vertex{x}) > K'$ and $d(\vertex{z}, \vertex{y}) > K'$. Then we must prove that $B_k(\vertex{x})$ and $B_k(\vertex{y})$ are $X$-ball isomorphic to show the first part, and we must prove that if $\{\Gamma, \Gamma'\}$ has IB($\frac{5}{2}\delta$) then $B_k(\vertex{x})$ is $X$-ball isomorphic to $\canonicalball{k}{\Gamma}$ to prove the second part.
+Let $K' = \max\{M + k - \delta, K + k - \delta, \epsilon + \frac{3\delta + 2k}{2} + 1\}$ and suppose that $\Gamma'$ has IB($\frac{5}{2}\delta$) with constant $K$, has base point $\vertex{a}$, and that $f(\vertex{a}) = \vertex{z}$. Now suppose that $\vertex{x}, \vertex{y} \in \Gamma'$ have $d(\vertex{z}, \vertex{x}) > K'$ and $d(\vertex{z}, \vertex{y}) > K'$. Then we must prove that $B_k(\vertex{x})$ and $B_k(\vertex{y})$ are $X$-ball isomorphic to show the first part, and we must prove that if $\{\Gamma, \Gamma'\}$ has IB($\frac{5}{2}\delta$) then $B_k(\vertex{x})$ is $X$-ball isomorphic to $\canonicalball{k}{\Gamma}$ to prove the second part.
 
 Let us suppose that this is not the case. Since $f$ is an $X$-map, it is surjective, so pick vertices $\vertex{b}$ and $\vertex{c}$ such that $f(\vertex{b}) = \vertex{x}$ and $f(\vertex{c}) = \vertex{y}$. Then $d(\vertex{a}, \vertex{b}) \ge d(\vertex{z}, \vertex{x}) > M$ and similarly $d(\vertex{a}, \vertex{c}) > M$, so $B_{2k+1}(\vertex{b})$ and $B_{2k+1}(\vertex{c})$ are $X$-ball isomorphic to $\canonicalball{2k+1}{\Gamma}$. Notice that $f$ restricts to ball morphisms from $B_{2k+1}(\vertex{b})$ and $B_{2k+1}(\vertex{c})$ to $B_{2k+1}(\vertex{x})$ and $B_{2k+1}(\vertex{y})$ respectively.
 
-We may now apply the last part of Proposition \ref{prop:loop_in_ball} to see that there is a $\canonicalball{2k+1}{\Gamma}$-geodesic at the centre of $\canonicalball{2k+1}{\Gamma}$, say $u$, which labels a loop at the centre one ball and not the other. For the first statement, we may suppose that this loop is present at $\vertex{x}$ and not $\vertex{y}$. For the second statement we may assume the loop is present at $\vertex{x}$ and not at $\vertex{b}$.
+We may now apply the last part of Proposition \ref{prop:loop_in_ball} to see that there is an $X$-word $u$ of length at most $2k+1$ which labels a geodesic in $\Gamma$ starting at the centre of $\canonicalball{2k+1}{\Gamma}$ such that $u$ labels a loop at one of our $k$-balls and not the other. For the first statement, we may suppose that $u$ labels a loop at $\vertex{x}$ and not $\vertex{y}$. For the second statement we know that $u$ labels a loop at $\vertex{x}$ and not at $\vertex{b}$.
 
-In either case, let $w$ be a $\Gamma'$-geodesic connecting $\vertex{z}$ to $\vertex{x}$. Observe that Lemma \ref{lemma:conj_quadrilateral} applies. Since $d(\vertex{z}, \vertex{x})$ and $d(\vertex{z}, \vertex{y})$ are both strictly greater than $K' \ge \epsilon + \frac{3\delta + 2k + 1}{2}$ we must have $2|w| > 2\epsilon + 3\delta + 2k + 1 \ge |u| + 3\delta + 2\epsilon + 1$ so that only the second case of Lemma \ref{lemma:conj_quadrilateral} can apply.
+In either case, let $w$ label a geodesic in $\Gamma$ connecting $\vertex{z}$ to $\vertex{x}$. Observe that Lemma \ref{lemma:conj_quadrilateral} applies. Since $d(\vertex{z}, \vertex{x})$ is strictly greater than $K' \ge \epsilon + \frac{3\delta + 2k}{2} + 1$ we must have $2|w| > 2\epsilon + 3\delta + 2k + 2 \ge |u| + 3\delta + 2\epsilon + 1$ so that only the second case of Lemma \ref{lemma:conj_quadrilateral} can apply.
 
-Since $\Gamma'$ has IB($\frac{5}{2}\delta$) with constant $K$ and $K' \ge K + k - \delta + 1 > K$, the balls $B_{\frac{5}{2}\delta}(\vertex{x})$ and $B_{\frac{5}{2}\delta}(\vertex{y})$ (or $\canonicalball{\frac{5}{2}\delta}{\Gamma}$ for the second statement) must be $X$-ball isomorphic. Since $u$ labels a loop at the centre of one ball and not the other, it must stray further than $\frac{5}{2}\delta$ from $\vertex{x}$ and then return, so in particular $|u| > 2\frac{5}{2}\delta + 1 > 2\delta$.
+Since $\Gamma'$ has IB($\frac{5}{2}\delta$) with constant $K$ and $K' \ge K + k - \delta + 1 > K$, the balls $B_{\frac{5}{2}\delta}(\vertex{x})$ and $B_{\frac{5}{2}\delta}(\vertex{y})$ (and $\canonicalball{\frac{5}{2}\delta}{\Gamma}$ for the second statement) must be $X$-ball isomorphic. Since $u$ labels a loop at the centre of one ball and not the other, it must stray further than $\frac{5}{2}\delta$ from $\vertex{x}$ and then return, so in particular $|u| > 2\frac{5}{2}\delta + 1 > 2\delta$.
 
 We can now use the final part of Lemma \ref{lemma:conj_quadrilateral}. Let $i := \floor{\frac{|u|}{2}} - \delta$, and let $u'$ be a word with $|u'| \le 5\delta + 1$ and $\vertex{a} \cdot wu = \vertex{a} \cdot w(|w|-i)u'w(|w|-i:|w|)$. Let $\vertex{x'} = f(\vertex{a} \cdot w(|w|-i))$ so that \begin{eqnarray*}
-& = & \vertex{x'} \cdot u' \\
-& = & f(\vertex{a} \cdot w(|w|-i)u') \\
+&   & \vertex{x'} \cdot u' \\
 & = & f(\vertex{a} \cdot w(|w|-i)u'w(|w|-i:|w|)w(|w|-i:|w|)^{-1}) \\
 & = & f(\vertex{a} \cdot wuw(|w|-i:|w|)^{-1}) \\
 & = & f(\vertex{a} \cdot ww(|w|-i:|w|)^{-1}) \\
@@ -2310,7 +2486,7 @@
 & = & \vertex{x'},
 \end{eqnarray*} so $u'$ labels a loop at $\vertex{x'}$. Since $|u'| \le 5\delta+1$ and $d(\vertex{z}, \vertex{x'}) = |w| - i \ge K' - k + \delta > K$, we therefore find that $u'$ labels a loop at the centre of $\canonicalball{\frac{5}{2}\delta}{\Gamma'}$.
 
-If $\{\Gamma, \Gamma'\}$ has IB($\frac{5}{2}\delta$) as in the second statement, we find that since there is a ball isomorphism from $\canonicalball{\frac{5}{2}\delta}{\Gamma}$ to $\canonicalball{\frac{5}{2}\delta}{\Gamma'}$, the $X$-word $u'$ also labels a loop at the centre of $\canonicalball{\frac{5}{2}\delta}{\Gamma}$. Let $\vertex{b'} = \vertex{a} \cdot w(|w| - i)$. Then $d(\vertex{a}, \vertex{b'}) = |w| - i \ge K' - k + \delta > M$ so $B_{2k+3\delta+2}(\vertex{b'})$ is ball isomorphic to $\canonicalball{2k+3\delta+2}{\Gamma}$, and in particular $B_{\frac{5}{2}\delta}(\vertex{b'})$ is isomorphic to $\canonicalball{\frac{5}{2}\delta}{\Gamma}$. This implies that $u'$ labels a loop at $\vertex{b'}$ and, being a $B_{\frac{5}{2}\delta}(\vertex{b})$-geodesic, we have \begin{eqnarray*}
+We can now complete the proof of the second statement. Suppose that $\{\Gamma, \Gamma'\}$ has IB($\frac{5}{2}\delta$). We find that since there is a ball isomorphism from $\canonicalball{\frac{5}{2}\delta}{\Gamma}$ to $\canonicalball{\frac{5}{2}\delta}{\Gamma'}$, there is a loop labelled $u'$ at the centre of $\canonicalball{\frac{5}{2}\delta}{\Gamma}$. Let $\vertex{b'} = \vertex{a} \cdot w(|w| - i)$. Then $d(\vertex{a}, \vertex{b'}) = |w| - i \ge K' - k + \delta > M$ so $B_{2k+5\delta+2}(\vertex{b'})$ is ball isomorphic to $\canonicalball{2k+5\delta+2}{\Gamma}$, and in particular $B_{\frac{5}{2}\delta}(\vertex{b'})$ is isomorphic to $\canonicalball{\frac{5}{2}\delta}{\Gamma}$. This implies that $u'$ labels a loop at $\vertex{b'}$ and we have \begin{eqnarray*}
       \vertex{b} \cdot u
 & = & \vertex{a} \cdot wu \\
 & = & \vertex{a} \cdot w(|w| - i)u'w(|w|-i:|w|) \\
@@ -2326,7 +2502,7 @@
 & = & \vertex{y},
 \end{eqnarray*} so $v = w(|w|-i:|w|)u'w(|w|-i:|w|)^{-1}$ labels a loop at $\vertex{y}$.
 
-Notice that $|v| \le 2i + 5\delta + 1 \le |u| + 3\delta + 1 \le 2k + 3\delta + 2$ so $\wordpath{\vertex{b}}{v}$ is contained inside the $2k+3\delta+2$-ball around $\vertex{b}$ and $\wordpath{\vertex{c}}{v}$ is contained inside the $2k+3\delta+2$-ball around $\vertex{c}$. As $\Gamma$ has IB($2k+3\delta+2$) and $\vertex{b}$ and $\vertex{c}$ were chosen to be sufficiently far from $\vertex{a}$, these balls are ball isomorphic. Since $\vertex{b} \cdot u = \vertex{b} \cdot v$, this implies that $\vertex{c} \cdot u = \vertex{c} \cdot v$ and so \begin{eqnarray*}
+Notice that $|v| \le 2i + 5\delta + 1 \le |u| + 5\delta + 1 \le 2k + 5\delta + 2$ so $\wordpath{\vertex{b}}{v}$ is contained inside the $2k+5\delta+2$-ball around $\vertex{b}$ and $\wordpath{\vertex{c}}{v}$ is contained inside the $2k+5\delta+2$-ball around $\vertex{c}$. As $\Gamma$ has IB($2k+5\delta+2$) and $\vertex{b}$ and $\vertex{c}$ were chosen to be sufficiently far from $\vertex{a}$, these balls are ball isomorphic. Since $\vertex{b} \cdot u = \vertex{b} \cdot v$, this implies that $\vertex{c} \cdot u = \vertex{c} \cdot v$ and so \begin{eqnarray*}
       \vertex{y} \cdot u
 & = & f(\vertex{c} \cdot u) \\
 & = & f(\vertex{c} \cdot v) \\
@@ -2335,54 +2511,24 @@
 \end{eqnarray*} which contradicts our assumption that $u$ did not label a loop at $\vertex{y}$. In other words, $B_k(\vertex{x})$ is isomorphic to $B_k(\vertex{y})$ and $\Gamma'$ has IB($k$) with constant $K'$, as required.
 \end{proof}
 
-In order to find a bound on GIB($k$), we now only need to exhibit a constant for GIB($\frac{5}{2}\delta$). We do this below, after stating some results which help us get to that goal; some notation and constants are introduced in the statements which will be used from this point on. First, the following is a reasonably well known general result; a similar result appears, for instance, in Proposition 2.3 of \cite{bridson2005conjugacy}. Note that the usual statement of this result gives a length of $|u| + |v|$ plus a constant, rather than $\frac{|u| + |v|}{2}$ plus a constant.
+\section{Torsion-free subgroups have GIB($\infty$)}
 
+Foord proved that torsion free subgroups of hyperbolic groups have GIB($k$) for any $k > 0$ but gave no bound on the constant. It is the aim of this section to demonstrate that said bound is in $O(k + \epsilon)$ using some of the work in Chapter \ref{chapter:conjugacy}.
+
+In order to find a bound on the constant for GIB($k$), we now only need to exhibit a constant for GIB($\frac{5}{2}\delta$). We do this below, after stating a result which help us get to that goal; some notation and constants are introduced in the statements which will be used from this point on. The reader should recap the constants from Section \ref{section:conj_const}.
+
+The following is a reasonably well known general result; the particular statement here is a restatement of Proposition 2.3 of \cite{bridson2005conjugacy}.
+
 \begin{proposition}
 \label{prop:bound_on_conjugator}
-Let $G = <\!X\!>$ be a group with $\delta$-vertex-hyperbolic Cayley graph $\Gamma$. Suppose $u$ and $v$ are words which are conjugate in $G$. Let $Q$ be the number of vertices in $B_{4\delta}(\Gamma)$. Then there exists a word $x$ such that $x^{-1}ux =_G v$, and \[ |x| \le \frac{|u| + |v|}{2} + Q + 1 \]
+Let $G = <\!X\!>$ be a $\delta$-hyperbolic group. If $u$ and $v$ are words which are conjugate in $G$ then there exists a word $x$ such that $x^{-1}ux =_G v$, and \[ |x| \le |u| + |v| + Q^2 + 4\delta. \]
 \end{proposition}
 
-\begin{proof}
-Suppose not. Let $w$ be a shortest $X$-word satisfying $w^{-1}uw =_G v$. Let $\vertex{a}$ be a vertex in $\Gamma$, and let $\vertex{b} = \vertex{a} \cdot w$, $\vertex{c} = \vertex{b} \cdot v$ and $\vertex{d} = \vertex{a} \cdot u$ to form a geodesic quadrilateral. Pick some $\Gamma$-geodesic $t$ between $\vertex{a}$ and $\vertex{c}$ to split this quadrilateral into two geodesic triangles. Let $k := |w| - d(a, c)$. Notice that if some vertex $\vertex{x}$ on $\path{\vertex{d}}{\vertex{c}}$ chain-corresponds to a vertex $\vertex{y}$ on $\path{\vertex{a}}{\vertex{b}}$ then \begin{eqnarray*}
-      d(\vertex{d}, \vertex{x})
-& = & d(\vertex{d}, \vertex{c}) - d(\vertex{c}, \vertex{x}) \\
-& = & d(\vertex{d}, \vertex{c}) - d(\vertex{c}, \vertex{x'}) \\
-& = & d(\vertex{d}, \vertex{c}) - d(\vertex{a}, \vertex{c}) + d(\vertex{a}, \vertex{x'}) \\
-& = & d(\vertex{d}, \vertex{c}) - d(\vertex{a}, \vertex{c}) + d(\vertex{a}, \vertex{y}) \\
-& = & d(\vertex{d}, \vertex{c}) - d(\vertex{a}, \vertex{c}) + d(\vertex{a}, \vertex{y}) \\
-& = & k + d(\vertex{a}, \vertex{y}).
-\end{eqnarray*}
-
-If $k > 0$ then $d(\vertex{a}, \vertex{c}) < |w|$. But then $t^{-1}ut =_G (uw)^{-1}u(uw) =_G w^{-1}uw =_G$ and $|t| < |w|$ which contradicts minimality of $|w|$.
-
-Similarly, suppose that $k < -2\delta - 1$. Notice that $(\vertex{c}, \vertex{d})_{\vertex{a}} = \frac{|u| - k}{2}$, so letting $i = \floor{\frac{|u| - k}{2}}$ and $\vertex{e} = \vertex{a} \cdot u(i)$, we find $\vertex{e}$ $2$-corresponds to some vertex $\vertex{e'}$ on $\path{\vertex{a}}{\vertex{b}}$ and \begin{eqnarray*}
-        |a^{-1}w|_G
-&  =  & d(\vertex{d}, \vertex{b}) \\
-& \le & d(\vertex{d}. \vertex{e}) + d(\vertex{e}, \vertex{e'}) + d(\vertex{e'}, \vertex{b}) \\
-& \le & |u| - i + 2\delta + |w| - i \\
-&  =  & |w| + |u| - 2i + 2\delta \\
-& \le & |w| + k + 1 + 2\delta \\
-&  <  & |w|,
-\end{eqnarray*} and since $(u^{-1}w)^{-1}u(u^{-1}w) = w^{-1}uw = v$, any $\Gamma$-geodesic word equal in $G$ to $u^{-1}w$ contradicts $w$ being a shortest conjugating word. Thus $k \ge -2\delta - 1$.
-
-Let $j := d(\vertex{d}, \vertex{x})$. Then $d(\vertex{x}, \vertex{a} \cdot w(j)) = d(\vertex{x}, \vertex{y}) + d(\vertex{y}, \vertex{a} \cdot w(j)) \le 2\delta + |k| \le 4\delta$. Thus if there are more than $Q$ such vertices $\vertex{x}$ then there is an $X$-word $s$ and integers $k < l$ such that $\vertex{d} \cdot w(k)s = \vertex{a} \cdot w(k)$ and $\vertex{d} \cdot w(l)s = \vertex{a} \cdot w(l)$ so that $uw(k)s =_G w(k)$ and $uw(l)s =_G w(l)$. But then let $w' := w(k)w(l:|w|)$ and we find that $|w'| < |w|$ and \begin{eqnarray*}
-      w'^{-1}uw
-& =_G & (w(k)w(l:|w|))^{-1}uw(k)w(l:|w|) \\
-& =_G & w^{-1}w(l)w(k)^{-1}w(k)s^{-1}w(l)^{-1}w \\
-& =_G & w^{-1}w(l)s^{-1}w(l)^{-1}w \\
-& =_G & w^{-1}uw(l)w(l)^{-1}w \\
-& =_G & w^{-1}uw \\
-& =_G & v,
-\end{eqnarray*} again contradicting minimality of $|w|$.
-
-Now, vertices on $\path{\vertex{a}}{\vertex{b}}$ must chain-correspond to vertices on one of the other 3 sides. Since $(\vertex{c}, \vertex{d})_{\vertex{a}} = \frac{|u| - k}{2}$, at most $\frac{|u| - k}{2} + 1$ vertices on $\path{\vertex{a}}{\vertex{b}}$ chain-correspond to vertices on $\path{\vertex{a}}{\vertex{d}}$, and similarly $(\vertex{a}, \vertex{c})_{\vertex{b}} = \frac{|v| + k}{2}$ so at most $\frac{|v| + k}{2} + 1$ vertices on $\path{\vertex{a}}{\vertex{b}}$ chain-corespond to vertices on $\path{\vertex{b}}{\vertex{c}}$. By the previous paragraph, at most $Q$ vertices remain. Adding this all together, we find that $|w| + 1 \le \frac{|u| + |v|}{2} + Q + 2$, so $|w| \le \frac{|u| + |v|}{2} + Q + 1$ as required.
-\end{proof}
-
 Now we can move onto our result.
 
 \begin{proposition}
 \label{prop:torsion_free_gib}
-Suppose that $G = <\!X\!>$ is has $\delta$-vertex-hyperbolic Cayley graph and that $H$ is any $\epsilon$-quasiconvex torsion-free subgroup of $G$. Then $H$ has GIB($\frac{5}{2}\delta$) with constant $K = Q + 15P\delta + 3P + 12\delta + 2\epsilon + 1$.
+Suppose that $G$ is $\delta$-hyperbolic with respect to a generating set $X$, and that $H$ is any $\epsilon$-quasiconvex torsion-free subgroup of $G$. Then $H$ has GIB($\frac{5}{2}\delta$) with constant $K = 32MQ^2\delta + 2\epsilon$.
 \end{proposition}
 
 \begin{proof}
@@ -2391,108 +2537,70 @@
 Proposition \ref{prop:loop_in_ball} gives us a $\Gamma$-geodesic word $u$ of length at most $5\delta + 1$ which labels a loop at $\vertex{x}$ but not at the centre of $\canonicalball{\frac{5}{2}\delta}{\Gamma}$, so $u \ne_G 1$. Applying Lemma \ref{lemma:conj_quadrilateral} we see that either $d(\vertex{a}, \vertex{x}) \le \frac{|u| + 3\delta + 2\epsilon}{2} \le K$, in which case we are done, or $|wuw^{-1}|_G \le 3\delta + 2\epsilon$.
 
 By Proposition \ref{prop:bound_on_conjugator}, there is a word $w'$ such that $w'uw'^{-1} =_G wuw^{-1}$ and \begin{eqnarray*}
-|w'| & \le & \frac{|u| + |wuw^{-1}|_G}{2} + Q + 1 \\
-     & \le & Q + 4\delta + \epsilon + \frac{3}{2},
-\end{eqnarray*} so noting that $|w'|$ is an integer, $|w'| \le Q + 4\delta + \epsilon + 1$. Let $z =_G w'^{-1}w$ be some $\Gamma$-geodesic word, and note that $z \in C_G(u)$.
-
-% TODO
-
-By Proposition \ref{prop:find_centraliser_sls} we have some set $S$ of at most $V$ elements each of length at most $P|u|$, a short-lex straight element $c$ of length at most $P|u|$ and an word $p$ of length at most $P|u|$ such that $z = pc^js$ for $s \in S$, and $n \in \mathbb{Z}$. Note that using the specific values and $n$ from Proposition \ref{prop:find_centraliser_sls} we have $z =_G u^kp^{-1}c^ls$ where $k = \floor{\frac{Mij}{n}}$ and $0 \le l \le n = \frac{|(u^p)^{Mi}|_G}{|c|}$. That is, $z =_G u^ka$ for some word $a$ of length at most $P|u| + MQ|u| + P|u| \le 3P|u|$.
-
-Since the leading word of this form is $u$ and we know $Hw'u = Hw'$, we have \begin{eqnarray*}
-        d(Hw', Hw'z)
-&  =  & d(Hw', Hw'u^ka) \\
-&  =  & d(Hw', Hw'a) \\
-& \le & |a| \\
-& \le & 3P|u| \\
-& \le & 3P(5\delta + 1).
+|w'| & \le & \frac{|u| + |wuw^{-1}|_G}{2} + c_0 \\
+     & \le & 8\delta + 2\epsilon + Q^2 + 1.
 \end{eqnarray*}
+Let $z =_G w'^{-1}w$ be the label of a geodesic in $\Gamma$, and note that $z \in C_G(u)$.
 
-Now since $w =_G w'z$, it is just a case of applying the triangle equality to show that \begin{eqnarray*}
-d(H, Hw) &  =  & d(H, Hw'z) \\
-         & \le & d(H, Hw') + d(Hw', Hw'z) \\
-         & \le & Q + 12\delta + 2\epsilon + 1 + 3P(5\delta + 1) \\
-         & \le & Q + 15P\delta + 3P + 12\delta + 2\epsilon + 1 \\
-         &  =  & K_{GIB}.
-\end{eqnarray*}\end{proof}
+By Corollary \ref{cor:find_sls_and_conj_form} (with $v = u$), we know that $z =_G u^it$ for some $i$ and some $X$-word $t$ of length at most $6MQ^2|u| \le 31MQ^2\delta$. Then \begin{eqnarray*}
+      Hw
+& = & Hw'z \\
+& = & Hw'u^it \\
+& = & Hw't,
+\end{eqnarray*} so \begin{eqnarray*}
+        d(H, Hw)
+& \le & |w'| + |t| \\
+& \le & 8\delta + 2\epsilon + Q + 1 + 31MQ^2\delta \\
+& \le & 32MQ^2\delta + 2\epsilon,
+\end{eqnarray*} as required.
+\end{proof}
 
 It is interesting to note that the factor of $\epsilon$ above does not depend on $\delta$ (although the leading constant does rather heavily).
 
-\section{A Stronger Sense of Local Homogeneity}
+\section{Geodesic path labels under IB}
 
-In this section, we will give some results which show that not just balls but geodesics in $\Gamma'$ behave in a homogeneous way when they are relatively distant from $H$, assuming IB($\frac{5}{2}\delta$).
+In this section, we will give some results which show that not just balls but geodesics in an $X$-graph behave in a homogeneous way when they are relatively distant from the base point, assuming IB($\frac{5}{2}\delta$).
 
 \begin{proposition}
-Suppose $\Gamma$ is an $X$-graph with base point $b$ such that all geodesic triangles in $\Gamma$ are $\Delta$-thin. Suppose that $\Gamma$ has IB($\Delta+1$) with constant $K$, that $w$ labels a geodesic that lies entirely outside of $B_K(b)$, and that $\gamma$ is any other path labelled by $w$ and lying entirely outside of $B_K(b)$. Then $\gamma$ is a geodesic.
+Suppose $\Gamma$ is an $X$-graph with base point $\vertex{b}$ such that all geodesic triangles in $\Gamma$ are $\Delta$-vertex-thin. Suppose that $\Gamma$ has IB($\Delta+1$) with constant $K$, that $w$ labels a geodesic that lies entirely outside of $B_K(\vertex{b})$, and that $\gamma$ is any other path labelled by $w$ and lying entirely outside of $B_K(\vertex{b})$. Then $\gamma$ is a geodesic.
 \end{proposition}
 
 \begin{proof}
-Suppose the conclusion is false, and suppose the geodesic that $w$ labels starts from $p$ and $\gamma$ starts from $q$. Let $w = w_1aw_2$, where $w_1$ is the longest subword which does label a geodesic starting at $q$, and $a$ is a word of length 1. Let $w_1'$ be a the label of a geodesic such that $qw_1' = qw_1a$, so that we must have $|w_1'| \le |w_1|$.
+Suppose the conclusion is false, and suppose the geodesic that $w$ labels starts from $\vertex{p}$ and $\gamma$ starts from $\vertex{q}$. Let $w = w_1aw_2$, where $w_1$ is the longest subword which does label a geodesic starting at $\vertex{q}$, and $a$ is a word of length 1. Let $w_1'$ be a the label of a geodesic such that $\vertex{q} \cdot w_1' = \vertex{q} \cdot w_1a$, so that we must have $|w_1'| \le |w_1|$.
 
-Then we have a geodesic triangle with corners $q$, $qw_1$ and $qw_1'$ and the obvious sides connecting them. Let $n := |w_1|$, and for $0 \le i < n$, let $p_i := qw(i)$ and $q_i := qw_1'(i)$. Let $p_n := qw_1$ and $q_n := qw_1'$. This is illustrated in Figure \ref{figure:geodesic_outside_GIB}.
+Then we have a geodesic triangle with corners $\vertex{q}$, $\vertex{q} \cdot w_1$ and $\vertex{q} \cdot w_1'$ and the obvious sides connecting them. Let $n := |w_1|$, and for $0 \le i < n$, let $\vertex{p_i} := \vertex{q} \cdot w(i)$ and $\vertex{q_i} := \vertex{q} \cdot w_1'(i)$. Let $\vertex{p_n} := \vertex{q} \cdot w_1$ and $\vertex{q_n} := \vertex{q} \cdot w_1'$. This is illustrated in Figure \ref{figure:geodesic_outside_GIB}.
 
 \begin{figure}
 \begin{center}
 \input geodesic_outside_GIB.pstex_t
-\caption{Geodesic triangle constructed outside of $B_{K-1}(b)$}
+\caption{Geodesic triangle constructed outside of $B_{K-1}(\vertex{b})$}
 \label{figure:geodesic_outside_GIB}
 \end{center}
 \end{figure}
 
-Now, since the triangle above is $\Delta$-thin, we can pick, for each $i$, a word $h_i$ joining $p_i$ and $q_i$ so that $|h_i| \le \Delta$. Now we find that for $0 \le i < n$, each quadrilateral with corners $p_i$, $p_{i+1}$, $q_i$, $q_{i+1}$ lies within $\Delta+1$ of $p_i$, hence it is contained inside the $\Delta+1$-ball around $qw(i)$, which is isomorphic to the $\Delta+1$-ball around $pw(i)$ (since this point is at a distance of at least $K$ from $H$).
+Now, since the triangle above is $\Delta$-thin, we can pick, for each $i$, a word $h_i$ labelling a path from $\vertex{p_i}$ and $\vertex{q_i}$ with $|h_i| \le \Delta$. Now we find that for $0 \le i < n$, each quadrilateral with corners $\vertex{p_i}$, $\vertex{p_{i+1}}$, $\vertex{q_i}$, $\vertex{q_{i+1}}$ lies within $\Delta+1$ of $\vertex{p_i}$, hence it is contained inside the $\Delta+1$-ball around $\vertex{q} \cdot w(i)$, which is isomorphic to the $\Delta+1$-ball around $\vertex{p} \cdot w(i)$ (since this vertex is at a distance of at least $K$ from $H$).
 
-Using a simple induction, we have $pw_1a = pw_1'$. But this is a clear contradiction, since $|w_1a| > |w_1'|$, and $w_1a$ labels a geodesic path starting at $p$. Hence no such $w_1'$ existed, and $w$ labels a geodesic starting at $q$.
+Using a simple induction, we have $\vertex{p} \cdot w_1a = \vertex{p} \cdot w_1'$. But this is a clear contradiction, since $|w_1a| > |w_1'|$, and $w_1a$ labels a geodesic path starting at $\vertex{p}$. Hence no such $w_1'$ existed, and $w$ labels a geodesic starting at $\vertex{q}$.
 \end{proof}
 
 By substituting the point $1$ in the group Cayley graph for $q$ in the above argument, we derive the following similar result:
 
 \begin{proposition}
 \label{prop:geodesic_outside}
-Suppose all triangles in $\Gamma'$ are $\Delta$-thin, and $H$ has GIB($\Delta+1$) with constant $K$ and that $w$ is a shortest word representing some group element. Then any path in $\Gamma'$ labelled by $w$ which lies outside of $B_{K-1}(H)$ is a geodesic.
+Suppose all triangles in $\Gamma'$ are $\Delta$-thin, and $H$ has GIB($\Delta+1$) with constant $K$ and that $w$ is a shortest word representing some group element. Then any path in $\Gamma'$ labelled by $w$ which lies outside of $B_K(H)$ is a geodesic.
 \end{proposition}
 
-We see the emergence of one ``bad'' ball, centred at $H$ in the coset Cayley graph. By the previous two sections, note that for torsion-free subgroups, $K \le K'\epsilon$, where $K'$ depends only on the group.
+It's a well-known result that in hyperbolic spaces, quasigeodesic paths lie close to geodesic paths, so that if geodesic-labelling words in $\Gamma$ label geodesics in $\Gamma'$ when they lie outside a certain radius, the same must be true of quasigeodesics.
 
-It's an established result that in hyperbolic spaces, quasigeodesic paths lie close to geodesic paths, so that if $\Gamma$-geodesic words label $\Gamma'$-geodesics whenever they lie outside a certain radius, the same must be true of quasigeodesics. We show this explicitly for $L$-local $(1, k)$-quasigeodesics, using Proposition 2.3 in \cite{epstein2006linearity}:
+We see the emergence of one ``bad'' ball, centred at $H$ in the coset Cayley graph.
 
-\begin{proposition}
-\label{prop:happy_local_qgeo}
-Let $w$ be an $L$-local $(1, 2\delta)$-quasigeodesic in $\Gamma$. Let $u$ be a geodesic connecting the endpoints of $w$. Then each point on $w$ is within $4\delta$ of some vertex on $u$ and each point on $u$ is within $4\delta$ of some vertex on $w$. Furthermore, if $|w| > L$, then $|u| \ge \frac{7}{17}|w|$.
-\end{proposition}
+\chapter{Hyperbolic Groups are $14$-hyperbolic}
 
-\begin{lemma}
-\label{lemma:qgeodesic_outside}
-Suppose $H$ has GIB($\Delta+1$) with constant $K$. If $u$ is a word which labels a $(1, k)$-quasigeodesic path in $\Gamma$ and labels a path $\gamma$ in $\Gamma'$ which lies outside of $B_{K+\frac{k}{2}+\delta-1}(H)$, then $\gamma$ is a $(1, k)$-quasigeodesic.
-\end{lemma}
-
-\begin{proof}
-Let $\alpha$ be a $(1, k)$-quasigeodesic in $\Gamma$ labelled by $w$. By Lemma \ref{lemma:qgeo} we know $\alpha$ lies within $\frac{k}{2} + \delta$ of a geodesic $\alpha'$ with label $u'$ say.
-
-Suppose $\gamma$ starts at $Hw$, and let $\gamma'$ be the path in $\Gamma'$ starting from $Hw$ and labelled by $u'$. Since any loop in $\Gamma$ is present at all points in $\Gamma'$, we find that $\gamma$ lies within $\frac{k}{2} + \delta$ of $\gamma'$. But then since $\gamma$ lies outside of $B_{K+\frac{k}{2}+\delta-1}(H)$, the path $\gamma'$ must lie outside of $B_{K-1}(H)$, so is a geodesic by Propositon \ref{prop:geodesic_outside}. But then $d_\gamma(Hg, Hgw) = |w| \le |w'| + k = d(Hg, Hgw') + k$, so $\gamma$ is a $(1, k)$-quasigeodesic as required.
-\end{proof}
-
-\begin{lemma}
-\label{lemma:local_qgeodesic_outside}
-If $u$ is a word with $|u| \ge L$ which labels an $L$-local $(1, 2\delta)$-quasigeodesic path in $\Gamma$ and labels a path $\gamma$ in $\Gamma'$ which lies outside of $B_{K+4\delta-1}(H)$, then $\gamma$ is an $L$-local $(1, 2\delta)$-quasigeodesic and a $(\frac{17}{7}, 0)$-quasigeodesic.
-\end{lemma}
-
-\begin{proof}
-Firstly, each subpath of $\gamma$ of length at most $L$ is clearly a $(1, 2\delta)$-quasigeodesic, by Lemma \ref{lemma:qgeodesic_outside}, so it's clear that $\gamma$ is an $L$-local $(1, 2\delta)$-quasigeodesic.
-
-Let $\alpha$ be an $L$-local $(1, 2\delta)$-quasigeodesic in $\Gamma$ labelled by $u$. By Proposition \ref{prop:happy_local_qgeo}, $\alpha$ is a $(\frac{17}{7}, 0)$-quasigeodesic, and if we pick $\alpha'$ (with label $u'$) to be any geodesic connecting its endpoints, all points on $\alpha$ lie within $4\delta$ of $\alpha$ and vice versa.
-
-Suppose $\gamma$ starts at $Hw$, and let $\gamma'$ be the path with label $u'$ starting from $Hw$. Just as in Lemma \ref{lemma:qgeodesic_outside}, the above distance properties remain true between $\gamma$ and $\gamma'$.
-
-This implies that $\gamma'$ lies entirely outside of $B_{K-1}(H)$, so is a geodesic, and thus $\gamma$ must be a $(\frac{17}{7}, 0)$-quasigeodesic.
-\end{proof}
-
-\chapter{Hyperbolic Groups are $13$-hyperbolic}
-
 \label{chapter:minimal}
 
 The constant of hyperbolicity of a hyperbolic group is dependent on its generating set. For example, a free group, say $F = <a>$ on a free generating set has a vertex hyperbolicity constant of $0$. However introducing a redundant generator will increase this constant, for example $F=<a,b|a^2=b>$ has vertex hyperbolicity constant of $1$. The purpose of this chapter is to investigate the lower bound $\min_\delta(G)$ of this constant for a given group $G$. 
 
-In fact, it turns out that there is a single small such bound that applies to all hyperbolic groups. Thus, the value of $\min_\delta(G)$ partitions hyperbolic groups into a small number of sets. The bounds given here are likely not to be the smallest due to the naive way in which they are derived, however it is the existence of such a bound that is interesting.
+In fact, it turns out that there is a single small such bound that applies to all hyperbolic groups. Thus, the value of $\min_\delta(G)$ partitions hyperbolic groups into a small number of classes. The bounds given here are likely not to be the smallest due to the naive way in which they are derived, however it is the existence of such a bound that is interesting.
 
 \section{Thinness of Quasigeodesic Triangles}
 
